<html><head><!-- This document was created for SOLEX at Wed Jun 22 18:36:47 2005 from
../average/solex.txt by MAN2HTML version 050114/2.0.6 -->
<title>Uppsala Software Factory - SOLEX Manual</title>
<meta name="DESCRIPTION" content="Manual for Gerard 
Kleywegt's program SOLEX">
<meta name="KEYWORDS" content="manual software Gerard 
Kleywegt program SOLEX structural biology 
protein X-ray crystallography macromolecular molecular
Uppsala Software Factory bioinformatics">
</head><body bgcolor="#fefefe" background="back.gif">

<A HREF="http://xray.bmc.uu.se/usf/" target="_top">
<IMG ALIGN="right" BORDER="0" SRC="usf_logo.gif"
ALT="Uppsala Software Factory"></A>

<H2>  Uppsala Software Factory - SOLEX Manual</H2> <P>   
<UL>  
<LI><H3>  <A HREF="#H1">1  </A>SOLEX - GENERAL INFORMATION</H3> 
<LI><H3>  <A HREF="#H2">2  </A>REFERENCES</H3> 
<LI><H3>  <A HREF="#H3">3  </A>VERSION HISTORY</H3> 
<LI><H3>  <A HREF="#H4">4  </A>NOTES</H3> 
<LI><H3>  <A HREF="#H5">5  </A>MAP AND MASK SIZE</H3> 
<LI><H3>  <A HREF="#H6">6  </A>DESCRIPTION</H3> 
<LI><H3>  <A HREF="#H7">7  </A>STARTUP</H3> 
<LI><H3>  <A HREF="#H8">8  </A>INPUT</H3> 
<H5><A HREF="#S1">8.1  </A>ESSENS score map</H5>
<H5><A HREF="#S2">8.2  </A>ESSENS rotation file</H5>
<H5><A HREF="#S3">8.3  </A>template PDB file</H5>
<H5><A HREF="#S4">8.4  </A>extraction mode</H5>
<H5><A HREF="#S5">8.5  </A>output PDB file(s)</H5>
<H5><A HREF="#S6">8.6  </A>output DEJAVU SSE file</H5>
<H5><A HREF="#S7">8.7  </A>cut-off score</H5>
<H5><A HREF="#S8">8.8  </A>maximum number of solutions</H5>
<LI><H3>  <A HREF="#H9">9  </A>OUTPUT</H3> 
<LI><H3>  <A HREF="#H10">10  </A>WHAT NEXT ?</H3> 
<LI><H3>  <A HREF="#H11">11  </A>USING DEJAVU</H3> 
<LI><H3>  <A HREF="#H12">12  </A>KNOWN BUGS</H3> 
</UL> 
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H1">1 </A>SOLEX - GENERAL INFORMATION</H2> </CENTER>
<P>   
Program : SOLEX
 <BR> Version : 050622
 <BR> Author : Gerard J. Kleywegt &amp; T. Alwyn Jones,
Dept. of Cell and Molecular Biology,
Uppsala University, Biomedical Centre, Box 596,
SE-751 24 Uppsala, SWEDEN
 <BR> E-mail : gerard@xray.bmc.uu.se
 <BR> Purpose : extraction of top solutions from ESSENS runs
 <BR> Package : RAVE
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H2">2 </A>REFERENCES</H2> </CENTER>
<P>   
Reference(s) for this program:
<P>   
* 1 * T.A. Jones (1992). A, yaap, asap, @#*? A set of averaging
programs. In &quot;Molecular Replacement&quot;, edited by E.J. Dodson,
S. Gover and W. Wolf. SERC Daresbury Laboratory, Warrington,
pp. 91-105.
<P>   
* 2 * G.J. Kleywegt &amp; T.A. Jones (1994). Halloween ... Masks and
Bones. In &quot;From First Map to Final Model&quot;, edited by
S. Bailey, R. Hubbard and D. Waller. SERC Daresbury
Laboratory, Warrington, pp. 59-66.
[http://xray.bmc.uu.se/gerard/papers/halloween.html]
<P>   
* 3 * G.J. Kleywegt &amp; T.A. Jones (1997). Taking the fun out of map
interpretation. CCP4/ESF-EACBM Newsletter on Protein
Crystallography 33, January 1997, pp. 19-21.
[http://xray.bmc.uu.se/usf/factory_7.html]
<P>   
* 4 * G.J. Kleywegt &amp; T.A. Jones (1997). Template convolution to
enhance or detect structural features in macromolecular
electron-density maps. Acta Cryst D53, 179-185.
[http://scripts.iucr.org/cgi-bin/paper?gr0647]
<P>   
* 5 * G.J. Kleywegt &amp; R.J. Read (1997). Not your average density.
Structure 5, 1557-1569.
[http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&amp;cmd=Retrieve&amp;list_uids=9438862&amp;dopt=Citation]
<P>   
* 6 * R.J. Read &amp; G.J. Kleywegt (2001). Density modification:
theory and practice. In: &quot;Methods in Macromolecular
Crystallography&quot; (D Turk &amp; L Johnson, Eds.), IOS Press,
Amsterdam, pp. 123-135.
<P>   
* 7 * Kleywegt, G.J., Zou, J.Y., Kjeldgaard, M. &amp; Jones, T.A. (2001).
Around O. In: &quot;International Tables for Crystallography, Vol. F.
Crystallography of Biological Macromolecules&quot; (Rossmann, M.G.
&amp; Arnold, E., Editors). Chapter 17.1, pp. 353-356, 366-367.
Dordrecht: Kluwer Academic Publishers, The Netherlands.
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H3">3 </A>VERSION HISTORY</H2> </CENTER>
<P>   
961120 - 0.1 - first version
 <BR> 961228 - 1.0 - first production version
 <BR> 990126 - 1.0.1- if rotation file too big, tell the user how much
memory should be allocated to it (MASKSIZE)
 <BR> 010122 - 2.0 - use C routines to do dynamic memory allocation
and port to Linux
 <BR> 040701 -2.0.1- changed checks of dynamic memory allocation to allow
for pointers with negative values as returned by
some recent Linux versions
 <BR> 050622 -2.0.2- increased dimensioning of major arrays in TRACER routine
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H4">4 </A>NOTES</H2> </CENTER>
<P>   
NOTE: This program is sensitive to the environment variable
CCP4_OPEN. If this variable has *not* been set, you will
not be able to create any CCP4 maps. If this happens, the
program will abort execution on startup. To fix this,
put the following line in your .login or .cshrc file:
setenv CCP4_OPEN UNKNOWN
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H5">5 </A>MAP AND MASK SIZE</H2> </CENTER>
<P>   
SOLEX allocates memory for maps and masks dynamically. This means that
you can increase the size of maps and masks that the program can handle
on the fly:
<P>   
1 - through the environment variables MAPSIZE and MASKSIZE (must be
in capital letters !), for example put the following in your
.cshrc file:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 setenv MAPSIZE 8000000
 setenv MASKSIZE 3000000
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
2 - by using command-line arguments MAPSIZE and MASKSIZE (need not
be in capitals), for example:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 run solex mapsize 10000000 masksize 5000000 |&amp; tee solex.out
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
Note that command-line arguments take precedence over environment
variables. So you can set the environment variables in your .cshrc
file to &quot;typical&quot; values, and if you have to deal with a map and/or
mask which is bigger than that, you can use the command-line argument(s).
<P>   
If sufficient memory cannot be allocated, the program will print
a message and quit. In that case, increase the amount of virtual
memory (this will not help, of course, if you try to allocate more
memory than can be addressed by your machine (for 32-bit machines,
something 2**32-1 bytes, I think), or reduce the size requirements.
<P>   
SOLEX needs space for 1 map and 1 mask.
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H6">6 </A>DESCRIPTION</H2> </CENTER>
<P>   
In the original version of ESSENS, the program could save the best-
fitting orientation of a search fragment or molecule to a PDB
file, but extracting the second-best solution etc. was tedious
to say the least. In addition, in feature extraction mode, all
you got was a map showing where helices or strands might fit,
but the information regarding the best orientation was lost.
<P>   
From version 2.0 onwards, ESSENS saves two maps (a &quot;score map&quot; and a
&quot;display map&quot;), as well as a &quot;rotation file&quot; which contains the
Euler or polar angles which gave the best fit of the template
to your electron density.
<P>   
This new program SOLEX (SOLution EXtractor) uses these files to
extract the best solution(s). For alpha-helices and beta-strands
it can even attempt to auto-trace (but this is still an experimental
piece of code !!!).
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H7">7 </A>STARTUP</H2> </CENTER>
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX ***
<P>   
 Version  - 990126/1.0.1
 (C) 1992-1999 Gerard J. Kleywegt &amp; T. Alwyn Jones, BMC, Uppsala (S)
 User I/O - routines courtesy of Rolf Boelens, Univ. of Utrecht (NL)
 Others   - T.A. Jones, G. Bricogne, Rams, W.A. Hendrickson
 Others   - W. Kabsch, CCP4, PROTEIN, E. Dodson, etc. etc.
<P>   
 Started  - Mon Oct 11 19:16:53 1999
 User     - gerard
 Mode     - interactive
 Host     - sarek
 ProcID   - 12924
 Tty      - /dev/ttyq12
<P>   
 *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX ***
<P>   
 Reference(s) for this program:
<P>   
 *  1 * T.A. Jones (1992). A, yaap, asap, @#*?  A set of averaging
        programs. In &quot;Molecular Replacement&quot;, edited by E.J. Dodson,
        S. Gover and W. Wolf. SERC Daresbury Laboratory, Warrington,
        pp. 91-105.
<P>   
 *  2 * G.J. Kleywegt &amp; T.A. Jones (1994).  Halloween ... Masks and
        Bones. In &quot;From First Map to Final Model&quot;, edited by
        S. Bailey, R. Hubbard and D. Waller.  SERC Daresbury
        Laboratory, Warrington, pp. 59-66.
        [http://xray.bmc.uu.se/gerard/papers/halloween.html]
<P>   
 *  3 * G.J. Kleywegt &amp; T.A. Jones (1997). Taking the fun out of map
        interpretation. CCP4/ESF-EACBM Newsletter on Protein
        Crystallography 33, January 1997, pp. 19-21.
        [http://xray.bmc.uu.se/usf/factory_7.html]
<P>   
 *  4 * G.J. Kleywegt &amp; T.A. Jones (1997).  Template convolution to
        enhance or detect structural features in macromolecular
        electron-density maps. Acta Cryst D53, 179-185.
        [http://www.iucr.ac.uk/journals/acta/tocs/actad/1997/actad5302.html]
<P>   
 *  5 * G.J. Kleywegt &amp; R.J. Read (1997). Not your average density.
        Structure 5, 1557-1569.
        [http://www4.ncbi.nlm.nih.gov/htbin-post/Entrez/query?uid=9438862&amp;form=6&amp;db=m&amp;Dopt=r]
<P>   
 *  6 * G.J. Kleywegt &amp; T.A. Jones (2037 ?). Convenient single and
        multiple crystal real-space averaging. To be published ???
<P>   
 *  7 * G.J. Kleywegt, J.Y. Zou, M. Kjeldgaard &amp; T.A. Jones (1999 ?).
        Chapter 25.2.6.  Around O. Int. Tables for
        Crystallography, Volume F. Submitted.
<P>   
 ==&gt; For manuals and up-to-date references, visit:
 ==&gt; http://xray.bmc.uu.se/usf
<P>   
 *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX ***
<P>   
 Allocate maps of size  : (    5000000)
 Allocate masks of size : (    3000000)
 Max nr of atoms : (      10000)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H8">8 </A>INPUT</H2> </CENTER>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S1">8.1 </A>ESSENS score map</H3> 
<P>   
Give the name of your &quot;score map&quot; (*not* the &quot;display map&quot; !) from a
previous ESSENS run.
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Input ESSENS score map file ? ( ) score_b20.E
 Input ESSENS score map file : (score_b20.E)
 Read header
 Input map : (score_b20.E)
 FORMATTED      OLD     file opened on unit  11
 Logical name: score_b20.E, Full name: score_b20.E
<P>   
  (Q)QOPEN allocated #  1
 User:   gerard               Logical Name: score_b20.E
 Status: READONLY   Filename: score_b20.E
<P>   
  File name for input map file on unit  11 : score_b20.E
                               file size = 3276224  ;  logical name score_b20.E
<P>   
           Number of columns, rows, sections ...............  100   89   92
           Map mode ........................................    2
           Start and stop points on columns, rows, sections   -12   87   11   99   23  114
<P>   
           Grid sampling on x, y, z ........................  100  110   64
           Cell dimensions .................................  91.80000  99.50000  56.50000
  90.00000  90.00000  90.00000
           Fast, medium, slow axes .........................    Z    X    Y
           Minimum density .................................    -5.83801
           Maximum density .................................    23.92435
           Mean density ....................................    -5.58603
           Rms deviation from mean density .................     1.53606
           Space-group .....................................   19
           Number of titles ................................    4
<P>   
 Titles :
           new 2Fo-Fc map
           Created by AVE V. 931216/3.0 at Wed Dec 22 18:45:45 1993 for user gerard
           Created by AVE V. 950118/3.1 at Mon Jul 17 19:04:35 1995 for user gerard
           Created by ESSENS V. 961120/2.0 at Thu Nov 21 23:04:40 1996 for user gerard
<P>   
 Parameters as read from the map file
 Origin ......................         11        23       -12
 Extent ......................         89        92       100
 Grid ........................        100       110        64
 Cell axes ...................      91.80     99.50     56.50
 Cell angles .................      90.00     90.00     90.00
 UVW (fast, medium, slow) ....          Z         X         Y
<P>   
 Header done
 Map read OK
 Closing BINARY CCP4 map on unit : (      11)
 Cell axes   (A) : (  91.800   99.500   56.500)
 Cell angles (d) : (  90.000   90.000   90.000)
 Grid axes (pts) : (     100      110       64)
 Origin    (pts) : (      11       23      -12)
 Extent    (pts) : (      89       92      100)
 Grid spacing (A): (   0.918    0.905    0.883)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S2">8.2 </A>ESSENS rotation file</H3> 
<P>   
Supply the name of the rotation file (produced in a previous run of
ESSENS).
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Input ESSENS rotation file ? ( ) b20.rot
 Input ESSENS rotation file : (b20.rot)
 Reading rotation file ...
 Cell axes   (A) : (  91.800   99.500   56.500)
 Cell angles (d) : (  90.000   90.000   90.000)
 Grid axes (pts) : (     100      110       64)
 Origin    (pts) : (      11       23      -12)
 Extent    (pts) : (      89       92      100)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S3">8.3 </A>template PDB file</H3> 
<P>   
Provide the name of the PDB file containing your template or
(partial) search model. This must be *exactly* the same PDB file
as the one you used in the ESSENS calculations !
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Name of template PDB file ? (alpha.pdb) /home/gerard/progs/average/essens_beta.pdb
 Name of template PDB file : (/home/gerard/progs/average/essens_beta.pdb)
 Number of atoms  : (         25)
 Nr of H stripped : (          0)
 Centre of gravity of atoms : (   0.000    0.000    0.000)
 Using central CA atom as pivot point
 Atom : (ATOM 12 CA ALA 3 -0.650 -0.185 -0.410 1.00 20.00)
 Pivot point : (  -0.650   -0.185   -0.410)
 Furthest atom (A): (   7.883)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S4">8.4 </A>extraction mode</H3> 
<P>   
Select one of the four possible solution extraction modes. Note that
the auto-trace facility is very experimental !
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 SOLEX can extract top solutions in one of 3 modes:
 1 = each to a separate file (e.g., domain)
 2 = all to one file (e.g., ligand)
 3 = try to trace alpha-helices
 4 = try to trace beta-strands
 Solution extraction mode ? (       1) 4
 Solution extraction mode : (       4)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S5">8.5 </A>output PDB file(s)</H3> 
<P>   
For extraction mode 1, provide the basename of the output PDB files
(e.g., a basename &quot;essens&quot; will give you PDB files which are called
&quot;essens1.pdb&quot;, &quot;essens2.pdb&quot;, etc.).
<P>   
For the other extraction modes, provide the name of the new PDB file.
<P>   
NOTE - For mode 2, you will get multiple copies of the template
residues with the same residue numbers. A simple way to renumber
the residues is in O (sam_rename) or MOLEMAN2 (PDb NUmber command) !
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Name for output PDB file ? (solex.pdb) btrace.pdb
 Name for output PDB file : (btrace.pdb)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S6">8.6 </A>output DEJAVU SSE file</H3> 
<P>   
For extraction modes 3 and 4 only, a DEJAVU SSE file will be created.
This can be used as input to DEJAVU (operating in &quot;Bones search&quot;
mode) to look for any other proteins in the PDB which have a
similar set of strands/helices. If you have run ESSENS/SOLEX
for both helices and strands, merge the two SSE files before
running DEJAVU. See the DEJAVU manual for more details.
<P>   
For extraction modes 3 and 4, you may have renamed all but one of
your CA atoms (e.g., to &quot; CAX&quot;) in order to force ESSENS to use
a particular CA atoms as the pivot point. SOLEX will rename such
atoms to &quot; CA &quot;.
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Name for output DEJAVU SSE file ? (beta.sse) beta.sse
 Name for output DEJAVU SSE file : (beta.sse)
<P>   
 Renaming &quot; CA?&quot; atoms to &quot; CA &quot; ...
 Removing all but &quot; CA &quot; atoms ...
 Nr of remaining atoms : (       5)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S7">8.7 </A>cut-off score</H3> 
<P>   
Provide the lowest value for acceptable/interesting solutions. You
obtain this number for helices/strands by contouring the ESSENS
&quot;display map&quot; at a level where you can see the strands/helices
clearly, and not too much (connected) noise.
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Cut-off score for top solutions ? (  8.908E+00) 13.0
 Cut-off score for top solutions : (  1.300E+01)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <H3>  <A NAME="S8">8.8 </A>maximum number of solutions</H3> 
<P>   
Provide the maximum number of solutions you want SOLEX to generate.
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Max nr of top solutions ? (      25) 50
 Max nr of top solutions : (      50)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H9">9 </A>OUTPUT</H2> </CENTER>
<P>   
The output below is for a run in which beta-strands are extracted,
and where SOLEX tries to trace them.
<P>   
First, the top solutions are located:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Extracting solutions ...
 Sol #      1 Value   2.3924E+01 @     32    49    49 Rot    340   100   140
 Sol #      2 Value   1.8874E+01 @     44    40    58 Rot    100    60    20
 Sol #      3 Value   1.8343E+01 @     44    41    52 Rot    260    60   100
 ...
 Sol #     50 Value   1.3056E+01 @     37    51    65 Rot    200    60   120
 Max number of solutions done ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
Subsequently, the auto-tracing routine kicks in:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Nr of CA atoms generated : (        250)
 Trying to connect them ...
<P>   
 Starting TRACER ...
 Nr of solutions : (      50)
 Max allowed     : (     500)
<P>   
 Calculate vectors, angles and distances ...
 Try to extend bits ...
 Prepend            4 at N-terminus of            1
<P>   
 Calculate vectors, angles and distances ...
 Try to extend bits ...
 Invert            5 for use with            1
 Append            5 at C-terminus of            1
<P>   
 Calculate vectors, angles and distances ...
 Try to extend bits ...
 Invert           10 for use with            1
 Prepend           10 at N-terminus of            1
<P>   
 ...
<P>   
 Calculate vectors, angles and distances ...
 Try to extend bits ...
<P>   
 Could not extend any further
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
This part of the program tries to merge bits of strand/helix that
are parallel and lie close in space. Only the CA atoms are retained !
<P>   
When it is finished, all stretches which have been extended by at least
one CA atom are written to the PDB file (with residues renumbered to
1, 2, 3, ...). The occupancy of each CA atom is replaced by the
number of the solution (1, 2, ...), and the B-factor by the score
of the solution in the &quot;score map&quot; (i.e., higher values, better fits).
Simultaneously, an SSE file for DEJAVU is created.
<P>   
For PDB files created by extraction mode 1 and 2, the occupancy is again
the number of the solution (but divided by 100), and the B-factor is
set to: score - average_score / standard_deviation_score (i.e., higher
numbers mean better fits).
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Nr of stretches left : (      19)
 Stretch            1 has           12 atoms (solution            2 )
 Stretch            2 has            9 atoms (solution            1 )
 Stretch            3 has            8 atoms (solution            7 )
 Stretch            4 has            8 atoms (solution            9 )
 Stretch            5 has            8 atoms (solution           23 )
 Stretch            6 has            7 atoms (solution            3 )
 Stretch            7 has            7 atoms (solution           12 )
 Stretch            8 has            6 atoms (solution           13 )
 Written PDB file
 Written DEJAVU SSE file
<P>   
 CPU total/user/sys :       6.6       6.3       0.3
<P>   
 *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX ***
<P>   
 Version - 961228/1.0
 Started - Sat Dec 28 23:15:34 1996
 Stopped - Sat Dec 28 23:15:56 1996
<P>   
 CPU-time taken :
 User    -      6.3 Sys    -      0.3 Total   -      6.6
<P>   
 *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX *** SOLEX ***
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
Note that this operation hardly takes any CPU time ! Of course, the
results are not necessarily fantastic. We have tested it only with
20-degree rotation angles so far and what happens is (in the case
of P2 myelin) is that SOLEX finds large bits of many strands, but
not all of them run in the correct direction. So: beware !
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H10">10 </A>WHAT NEXT ?</H2> </CENTER>
<P>   
For extraction mode 1, read each of the top solutions into O, and judge
which one (if any) fits your map best.
<P>   
For extraction mode 2 (e.g., for ligands, Trp sidechains, etc.), read
the PDB file into O, draw the solutions and decide which ones to keep.
<P>   
For extraction mode 3 and 4, read the PDB file into O, e.g.:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 s_a_i btrace.pdb btra
 mol btra
 paint_ramp atom_b ; red blue
 ca ; end
 bell
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
If you use this way to paint_ramp the molecule, then: the more green/blue
the CA atoms, the better the fit.
<P>   
Of course, you can use the SSE file to do a DEJAVU search (use the
&quot;Bones search&quot; option).
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H11">11 </A>USING DEJAVU</H2> </CENTER>
<P>   
You may want to look up the following two references in which the use
of DEJAVU to work at the level of rough Bones-derived secondary-
structure elements was first described:
<P>   
(1) Kleywegt, G.J. and Jones, T.A. (1994). Halloween ... masks and bones.
In &quot;From First Map to Final Model&quot;, edited by S. Bailey, R. Hubbard
and D. Waller. SERC Daresbury Laboratory, Warrington, pp. 59-66.
<P>   
(2) Kleywegt, G.J. and Jones, T.A. (1997 ?). Detecting folding motifs and
similarities in protein structures. Meth Enzymol ?, ?-?.
<P>   
An SSE file created by SOLEX may look as follows (if you have run ESSENS
with both strands and helices, you can merge their SSE files of course):
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by SOLEX V. 961228/1.0 at Sat Dec 28 23:36:51 1996 for user gerard
!
MOL   bone
NOTE  auto-generated by SOLEX
PDB   btrace.pdb
!
BETA  'B1' ' 1' ' 12' 12 61.43 60.73 47.76 33.97 55.75 27.06
BETA  'B2' ' 13' ' 21' 9 44.24 63.08 16.44 37.40 64.56 41.58
BETA  'B3' ' 22' ' 29' 8 56.31 63.65 17.51 44.11 72.87 32.13
BETA  'B4' ' 30' ' 37' 8 49.36 51.47 27.01 61.21 66.47 37.90
BETA  'B5' ' 38' ' 45' 8 57.25 53.27 22.42 59.65 74.87 31.87
BETA  'B6' ' 46' ' 52' 7 45.76 52.50 31.42 59.24 63.58 40.97
BETA  'B7' ' 53' ' 59' 7 62.51 73.28 34.79 52.24 58.42 26.17
BETA  'B8' ' 60' ' 65' 6 47.19 65.18 19.62 39.41 67.92 33.35
ENDMOL
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
These 8 beta-strands were extracted from the averaged P2 myelin map.
Running them through DEJAVU with the suggested &quot;Bones search&quot; settings
gives one hit if we require that at least 7 strands must match:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Entry    380 = 1ftp = fatty-acid-binding protein - desert locust (sch
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
This is of course a perfect hit, since FABP and P2 myelin have the same
fold ! If we relax the search and require only 6 strands to match,
we get:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ===&gt; Option ? (INCR) incr
<P>   
 ********** NEW QUERY **********
<P>   
 Elements : ( B1 B2 B3 B4 B5 B6 B7 B8)
 Min nr of residues for SSEs             ? (       5)
 ................... ( B1 B2 B3 B4 B5 B6 B7 B8)
 Min nr of elements to match (0 = abort) ? (       7) 6
<P>   
 Is this a BONES search ? (Y)
 BONES search mode
<P>   
 BONES search; will do lsq_centroid
 BONES suggested values: 1 5 10.0 5.0 0.2
 Define how much the nr of residues in SSEs may differ
 by defining how many residues shorter or longer SSEs in
 the database may be compared to those in your protein.
 Max nr of residues &quot;too short&quot; ? (          1)
 Max nr of residues &quot;too long&quot;  ? (          5)
 Mismatch element length        ? (  10.000)
 Mismatch distances             ? (   5.000)
 Mismatch cosines               ? (   0.200)
 Weights for nr res, length, dist, cos, rmsd
 BONES suggested values: 0 0 10 10 10
 Weights for scoring     ? (   0.010    0.010    0.327    0.327    0.327)
 Normalised weights      : (   0.010    0.010    0.327    0.327    0.327)
<P>   
 Possible distance criteria:
  C  =&gt; centre-to-centre
  H  =&gt; MIN head-tail and tail-head (anti-parallel)
  T  =&gt; MIN head-head and tail-tail (parallel)
  I  =&gt; MIN of all these distances
  A  =&gt; MAX of all these distances
 BONES suggested value: C !!!
 Which distances (C/H/T/I/A) ? (C)
 Extensive output        ? (N)
 BONES suggested value: NO !!!
 Conserve directionality ? (N)
 BONES suggested value: Y
 Conserve absolute motif ? (Y)
 BONES suggested value: NO !!!
 Conserve neighbours     ? (N)
 Attempt to avoid multi-chain hits ? (Y)
 Attempt to avoid identical proteins ? (Y)
 Create O macro file      ? (Y)
 O macro file             ? (beta_lsq.omac)
 BONES search; cannot use LSQMAN
<P>   
 Nr of elements recognised in query : (       8)
 Indices : (       1        2        3        4        5        6        7
         8)
 Nr of elements of each type : (       0        8)
<P>   
 ********** 1cbs       **********    152 **********
 [cellular retinoic-acid-binding protein type ii co - human (homo sapie ]
 [/nfs/scr_uu5/gerard/dejavu/1cbs.pdb                                   ]
<P>   
 ...
<P>   
 Nr of database entries : (       1381)
 Nr of selected entries : (       1381)
 Nr of matching entries : (          4)
 Nr of hits (total)     : (         12)
<P>   
 Entry    152 = 1cbs = cellular retinoic-acid-binding protein type ii co - human (homo sapie
 Entry    219 = 1crb = cellular retinol binding protein (crbp) complexed - rat (rattus rattu
 Entry    380 = 1ftp = fatty-acid-binding protein - desert locust (sch
 Entry    825 = 1pmp = p2 myelin protein (p2) - bovine (bos taurus
<P>   
  2 CPU total/user/sys :       1.6       1.6       0.0
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
All four hits are correct ! So now all we have to do is to execute the
O macro produced by DEJAVU, select one of the four PDB entries as our
starting model, use Mutate_replace a bit, rebuild the model a bit, and
throw it into X-PLOR !
 <BR> (Actually, the orientation of 1CRB is not the correct one, which would
probably have been avoided if the helices had been used as well. Also,
the alignment is very rough, so some rigid-body refinement would be
necessary in a real-life case !)
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H12">12 </A>KNOWN BUGS</H2> </CENTER>
<P>   
None, at present.
<HR NOSHADE>    <A HREF="http://xray.bmc.uu.se/usf/" target="_top">
<IMG ALIGN="right" BORDER="0" SRC="usf_logo.gif"
ALT="Uppsala Software Factory"></A>
<FONT SIZE=-1>
<B> <I> Created at Wed Jun 22 18:36:47 2005
by MAN2HTML version 050114/2.0.6 . This manual
describes SOLEX, a program of the <A HREF="http://xray.bmc.uu.se/usf/" target="_top">Uppsala
Software Factory</A> (USF), written and maintained by <A HREF="http://xray.bmc.uu.se/gerard"
target="_blank">Gerard Kleywegt</A>. &copy; 1992-2005.
</I> </B> </FONT><P>
<IMG SRC="http://xray.bmc.uu.se/cgi-bin/nph-count?width=6&link=http://alpha2.bmc.uu.se/~gerard/www/manuals/solex_man.html">
</body></html>
