<html><head><!-- This document was created for MASKIT at Thu Jun 26 11:57:42 2008 from
../average/maskit.txt by MAN2HTML version 070111/2.0.8 -->
<title>Uppsala Software Factory - MASKIT Manual</title>
<meta name="DESCRIPTION" content="Manual for Gerard 
Kleywegt's program MASKIT">
<meta name="KEYWORDS" content="manual software Gerard 
Kleywegt program MASKIT structural biology 
protein X-ray crystallography macromolecular molecular
Uppsala Software Factory bioinformatics">
</head><body bgcolor="#fefefe" background="back.gif">

<A HREF="http://xray.bmc.uu.se/usf/" target="_top">
<IMG ALIGN="right" BORDER="0" SRC="usf_logo.gif"
ALT="Uppsala Software Factory"></A>

<H2>  Uppsala Software Factory - MASKIT Manual</H2> <P>   
<UL>  
<LI><H3>  <A HREF="#H1">1  </A>MASKIT - GENERAL INFORMATION</H3> 
<LI><H3>  <A HREF="#H2">2  </A>REFERENCES</H3> 
<LI><H3>  <A HREF="#H3">3  </A>VERSION HISTORY</H3> 
<LI><H3>  <A HREF="#H4">4  </A>DESCRIPTION</H3> 
<LI><H3>  <A HREF="#H5">5  </A>EXAMPLE</H3> 
<LI><H3>  <A HREF="#H6">6  </A>MAP AND MASK SIZE</H3> 
<LI><H3>  <A HREF="#H7">7  </A>KNOWN BUGS</H3> 
</UL> 
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H1">1 </A>MASKIT - GENERAL INFORMATION</H2> </CENTER>
<P>   
Program : MASKIT
 <BR> Version : 080625
 <BR> Author : Gerard J. Kleywegt &amp; T. Alwyn Jones,
Dept. of Cell and Molecular Biology,
Uppsala University, Biomedical Centre, Box 596,
SE-751 24 Uppsala, SWEDEN
 <BR> E-mail : gerard@xray.bmc.uu.se
 <BR> Purpose : calculate cross-crystal correlation map to define a mask
 <BR> Package : RAVE
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H2">2 </A>REFERENCES</H2> </CENTER>
<P>   
Reference(s) for this program:
<P>   
* 1 * T.A. Jones (1992). A, yaap, asap, @#*? A set of averaging
programs. In &quot;Molecular Replacement&quot;, edited by E.J. Dodson,
S. Gover and W. Wolf. SERC Daresbury Laboratory, Warrington,
pp. 91-105.
<P>   
* 2 * G.J. Kleywegt &amp; T.A. Jones (1994). Halloween ... Masks and
Bones. In &quot;From First Map to Final Model&quot;, edited by
S. Bailey, R. Hubbard and D. Waller. SERC Daresbury
Laboratory, Warrington, pp. 59-66.
[http://xray.bmc.uu.se/gerard/papers/halloween.html]
<P>   
* 3 * G.J. Kleywegt &amp; R.J. Read (1997). Not your average density.
Structure 5, 1557-1569.
[http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&amp;cmd=Retrieve&amp;list_uids=9438862&amp;dopt=Citation]
<P>   
* 4 * G.J. Kleywegt &amp; T.A. Jones (1999). Software for handling
macromolecular envelopes. Acta Cryst D55, 941-944.
[http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&amp;cmd=Retrieve&amp;list_uids=10089342&amp;dopt=Citation]
[http://scripts.iucr.org/cgi-bin/paper?se0256]
<P>   
* 5 * G.J. Kleywegt (1999). Experimental assessment of
differences between related protein crystal structures.
Acta Cryst. D55, 1878-1857.
[http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&amp;cmd=Retrieve&amp;list_uids=10531486&amp;dopt=Citation]
[http://scripts.iucr.org/cgi-bin/paper?se0283]
<P>   
* 6 * R.J. Read &amp; G.J. Kleywegt (2001). Density modification:
theory and practice. In: &quot;Methods in Macromolecular
Crystallography&quot; (D Turk &amp; L Johnson, Eds.), IOS Press,
Amsterdam, pp. 123-135.
<P>   
* 7 * Kleywegt, G.J., Zou, J.Y., Kjeldgaard, M. &amp; Jones, T.A. (2001).
Around O. In: &quot;International Tables for Crystallography, Vol. F.
Crystallography of Biological Macromolecules&quot; (Rossmann, M.G.
&amp; Arnold, E., Editors). Chapter 17.1, pp. 353-356, 366-367.
Dordrecht: Kluwer Academic Publishers, The Netherlands.
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H3">3 </A>VERSION HISTORY</H2> </CENTER>
<P>   
971222 - 0.1 - first version
 <BR> 980710 - 0.3 - first working version
 <BR> 990126 - 0.4 - FRCSYM and interpolation errors are no longer listed
(only their total number if any occured)
 <BR> 010122 - 1.0 - use C routines to do dynamic memory allocation
and port to Linux
 <BR> 040701 -1.0.1- changed checks of dynamic memory allocation to allow
for pointers with negative values as returned by
some recent Linux versions
 <BR> 080625 -1.0.2- suppress error messages if more than 10 of them
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H4">4 </A>DESCRIPTION</H2> </CENTER>
<P>   
MASKIT is a program that calculates a correlation map between
the densities of a molecule as found in two different
crystal forms. It can be used if you want to define a
mask for cross-crystal averaging.
<P>   
MASKIT is *very* similar to COMA (which calculates correlation
maps for NCS-related molecules), and for details of the
algorithm and application of you are referred to the COMA
manual.
<P>   
You will need MASKIT (in addition to COMA) if you want to do
electron-density averaging between different crystal forms,
and one or more of these crystal forms does not contain
NCS. In all other cases, COMA will do all you need (in
combination with O, MAPMAN, and MAMA).
<P>   
For example: if you have one crystal form with two molecules
and one with only one molecule, then:
 <BR> - use COMA to define an NCS-based mask for the first crystal
form
 <BR> - use MASKIT to define a mask based on the density of one
molecule in each crystal form
 <BR> - use MAMA to combine the two masks into one that is valid
both for NCS (in the first crystal form) and for cross-crystal
averaging (between the two crystal forms).
<P>   
If *all* your crystal forms contain NCS, you do not need MASKIT
(although it doesn't hurt and doesn't cost more than some
CPU time). For instance: if crystal form one has two-fold
NCS, and crystal form 2 has three-fold NCS, then:
 <BR> - use COMA to define an NCS mask for crystal form 1
 <BR> - use COMA to define an NCS mask for crystal form 2
 <BR> - use the RT-operator between the two crystal forms to
transform one mask on top of the other (using the
NEw UNit_cell command in MAMA)
 <BR> - use the tools in MAMA to combine the two masks into one
<P>   
MASKIT is a quick-and-dirty program, in that it ignores
any NCS that may be present in any of the crystal
forms. Also, it will only work for two crystal forms
at a time. If you have three or more, you will have
to run MASKIT once for every additional crystal form.
<P>   
In order to run MASKIT, you will need:
 <BR> - CCP4 map of the unit cell (or asymmetric unit) of each
crystal form
 <BR> - O-style symmetry operators for each crystal form
 <BR> - the Cartesian operator that transforms the molecule
in crystal form 1 (your &quot;reference molecule&quot; for cross-crystal
averaging) on to the molecule in crystal form 2
 <BR> - values for a few input parameters (see COMA manual)
<P>   
The cross-crystal RT-operator can be obtained, e.g. from
molecular replacement (e.g. using density from one of
the crystal forms), or by superimposing partial models
in the two crystal forms. Such operators can be improved
with the program MAVE, if you like.
<P>   
The output will be a local cross-crystal density correlation
map that can be contoured in O (hint: correlation coefficients
lie between -1.0 and +1.0; if you mappage the map, multiply
it by 100 first), to find a good cut-off value. The map
can then be converted into a mask with MAPMAN, and touched
up (and combined with other masks) with MAMA.
<P>   
Like COMA, MASKIT uses the algorithm of Randy Read as described in:
<P>   
FMDAP Vellieux, JF Hunt, S, Roy &amp; RJ Read, &quot;DEMON/ANGEL: a
suite of programs to carry out density modification&quot;,
J. Appl. Cryst. 28, 347-351 (1995).
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H5">5 </A>EXAMPLE</H2> </CENTER>
<P>   
The following example uses data from two crystal forms of Candida
antarctica lipase B (Uppenberg et al.), one monoclinic (P21)
with two molecules per asymmetric unit, and one orthorhombic
(P212121) with one molecule per asymmetric unit.
<P>   
For details concerning the input, see the COMA manual !
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
<P>   
 ...
<P>   
 *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT ***
<P>   
 Allocate maps of size  : (    5000000)
 Allocate masks of size : (    5000000)
 Allocate mini maps/masks of size : (     500000)
<P>   
 Crystal form 1 - CCP4 map file ? ( ) ../p21_start.E
 Crystal form 1 - CCP4 map file : (../p21_start.E)
 Read header
<P>   
 ...
<P>   
 Grid spacing (A): (   0.957    1.052    0.985)
<P>   
 Crystal form 1 - Spacegroup symm-ops ? (symop.o) p21
 Crystal form 1 - Spacegroup symm-ops : (p21)
 Try to open as : (p21)
<P>   
 ...
<P>   
 SYMOP  2 =       -1.0000       0.0000       0.0000                  0.000
                   0.0000       1.0000       0.0000                  0.500
                   0.0000       0.0000      -1.0000                  0.000
 Determinant of rotation matrix =   1.000000
 Rotation angle                 = 180.000000
<P>   
 Crystal form 2 - CCP4 map file ? ( ) ../p212121_start.E
 Crystal form 2 - CCP4 map file : (../p212121_start.E)
 Read header
<P>   
 ...
<P>   
 Origin    (pts) : (       0        0        0)
 Extent    (pts) : (      60       48       90)
<P>   
 Crystal form 2 - Spacegroup symm-ops ? (symop.o) p212121
 Crystal form 2 - Spacegroup symm-ops : (p212121)
 Try to open as : (p212121)
<P>   
 ...
<P>   
 SYMOP  4 =        1.0000       0.0000       0.0000                  0.500
                   0.0000      -1.0000       0.0000                  0.500
                   0.0000       0.0000      -1.0000                  0.000
 Determinant of rotation matrix =   1.000000
 Rotation angle                 = 180.000000
<P>   
 Define the area where you expect your &quot;reference&quot;
 molecule to be in terms of fractional coordinates
 (applies to crystal form 1 !).
 Fractional search range A ? (   0.000    0.500) -0.2 0.6
 Fractional search range B ? (   0.000    0.500) -0.4 0.9
 Fractional search range C ? (   0.000    0.500) 0 0.8
 Fractional search range A : (  -0.200    0.600)
 Fractional search range B : (  -0.400    0.900)
 Fractional search range C : (   0.000    0.800)
<P>   
 File with RT-operator FROM xtal 1 TO xtal 2 ? (or2or.rt) ../p21_to_p212121.o
 File with RT-operator FROM xtal 1 TO xtal 2 : (../p21_to_p212121.o)
 Opening O datablock : (../p21_to_p212121.o)
 Datablock : (.SPACE_GROUP_OPERATORS)
 Data type : (R)
 Number    : (12)
 Format    : ((3F15.6))
 Operator : (  -0.113    0.677    0.727   -0.420    0.631   -0.652   -
  0.900   -0.380    0.213   26.850   18.667    8.592)
<P>   
 Sphere radius ~ 1.5 * resolution of trusted phases
 Sphere radius (A) ? (   4.300) 4.5
 Sphere radius (A) : (   4.500)
<P>   
 Output CCP4 correlation map file ? (maskit.E)
 Output CCP4 correlation map file : (maskit.E)
<P>   
 Output map grid : (      45       34       58)
 Spacing (A)     : (   1.489    1.485    1.495)
<P>   
 Origin : (        -10         -14          -1)
 Extent : (         39          46          49)
 Calculated output map size : (      87906)
 Nr of mask points in sphere : (     113)
 Progress (%) : (   5.000)
 Progress (%) : (   9.999)
 Progress (%) : (  14.999)
 ERROR --- Serious FRCSYM error
 Mask point in reference  : (      11        8        9)
 ERROR --- Serious FRCSYM error
 Mask point in reference  : (      11        8        8)
 Progress (%) : (  19.999)
<P>   
 ...
<P>   
 Progress (%) : (  94.994)
 Progress (%) : (  99.993)
 Nr of points : (      87906)
<P>   
 CRYSTAL FORM #1
 ---------------
 Cell volume (A**3)  : (  2.888E+05)
 Voxel volume (A**3) : (  3.254E+00)
 Bin 37 ... CC &gt;=  0.85 Nr       54 Cum       54 Cum Vol   1.7574E+02 Solv Cont (%)   100
 Bin 36 ... CC &gt;=  0.80 Nr      370 Cum      424 Cum Vol   1.3799E+03 Solv Cont (%)    99
 Bin 35 ... CC &gt;=  0.75 Nr     1136 Cum     1560 Cum Vol   5.0770E+03 Solv Cont (%)    96
 Bin 34 ... CC &gt;=  0.70 Nr     1869 Cum     3429 Cum Vol   1.1160E+04 Solv Cont (%)    92
 Bin 33 ... CC &gt;=  0.65 Nr     2213 Cum     5642 Cum Vol   1.8362E+04 Solv Cont (%)    87
 Bin 32 ... CC &gt;=  0.60 Nr     2190 Cum     7832 Cum Vol   2.5489E+04 Solv Cont (%)    82
 Bin 31 ... CC &gt;=  0.55 Nr     1882 Cum     9714 Cum Vol   3.1614E+04 Solv Cont (%)    78
 Bin 30 ... CC &gt;=  0.50 Nr     1513 Cum    11227 Cum Vol   3.6538E+04 Solv Cont (%)    75
 Bin 29 ... CC &gt;=  0.45 Nr     1401 Cum    12628 Cum Vol   4.1098E+04 Solv Cont (%)    72
 Bin 28 ... CC &gt;=  0.40 Nr     1481 Cum    14109 Cum Vol   4.5918E+04 Solv Cont (%)    68
 Bin 27 ... CC &gt;=  0.35 Nr     1805 Cum    15914 Cum Vol   5.1792E+04 Solv Cont (%)    64
 Bin 26 ... CC &gt;=  0.30 Nr     2726 Cum    18640 Cum Vol   6.0664E+04 Solv Cont (%)    58
 Bin 25 ... CC &gt;=  0.25 Nr     3908 Cum    22548 Cum Vol   7.3382E+04 Solv Cont (%)    49
 Bin 24 ... CC &gt;=  0.20 Nr     5751 Cum    28299 Cum Vol   9.2099E+04 Solv Cont (%)    36
<P>   
 ...
<P>   
 Bin 10 ... CC &gt;= -0.50 Nr       11 Cum    87906 Cum Vol   2.8609E+05 Solv Cont (%)   -98
<P>   
 CRYSTAL FORM #2
 ---------------
 Cell volume (A**3)  : (  2.671E+05)
 Bin 37 ... CC &gt;=  0.85 Nr       54 Cum       54 Cum Vol   1.7574E+02 Solv Cont (%)   100
 Bin 36 ... CC &gt;=  0.80 Nr      370 Cum      424 Cum Vol   1.3799E+03 Solv Cont (%)    98
 Bin 35 ... CC &gt;=  0.75 Nr     1136 Cum     1560 Cum Vol   5.0770E+03 Solv Cont (%)    92
 Bin 34 ... CC &gt;=  0.70 Nr     1869 Cum     3429 Cum Vol   1.1160E+04 Solv Cont (%)    83
 Bin 33 ... CC &gt;=  0.65 Nr     2213 Cum     5642 Cum Vol   1.8362E+04 Solv Cont (%)    73
 Bin 32 ... CC &gt;=  0.60 Nr     2190 Cum     7832 Cum Vol   2.5489E+04 Solv Cont (%)    62
 Bin 31 ... CC &gt;=  0.55 Nr     1882 Cum     9714 Cum Vol   3.1614E+04 Solv Cont (%)    53
 Bin 30 ... CC &gt;=  0.50 Nr     1513 Cum    11227 Cum Vol   3.6538E+04 Solv Cont (%)    45
 Bin 29 ... CC &gt;=  0.45 Nr     1401 Cum    12628 Cum Vol   4.1098E+04 Solv Cont (%)    38
 Bin 28 ... CC &gt;=  0.40 Nr     1481 Cum    14109 Cum Vol   4.5918E+04 Solv Cont (%)    31
 Bin 27 ... CC &gt;=  0.35 Nr     1805 Cum    15914 Cum Vol   5.1792E+04 Solv Cont (%)    22
 Bin 26 ... CC &gt;=  0.30 Nr     2726 Cum    18640 Cum Vol   6.0664E+04 Solv Cont (%)     9
 Bin 25 ... CC &gt;=  0.25 Nr     3908 Cum    22548 Cum Vol   7.3382E+04 Solv Cont (%)   -10
 Bin 24 ... CC &gt;=  0.20 Nr     5751 Cum    28299 Cum Vol   9.2099E+04 Solv Cont (%)   -38
<P>   
 ...
<P>   
 Bin 11 ... CC &gt;= -0.45 Nr       21 Cum    87895 Cum Vol   2.8605E+05 Solv Cont (%)  -328
 Bin 10 ... CC &gt;= -0.50 Nr       11 Cum    87906 Cum Vol   2.8609E+05 Solv Cont (%)  -328
<P>   
 &quot;Cumul Vol&quot; ignores any mask overlap !
 &quot;Solv Cont&quot; ignores overlap, assumes one domain,
   no NCS, and all SymmOps used here !
<P>   
 Stamp : (Created by MASKIT V. 980710/0.3 at Fri Jul 10 18:47:15 1998 for
  user gerard)
STOP ... Toodle pip ... statement executed
  (Q)QOPEN allocated #  1
 User:   gerard               Logical Name: maskit.E
 Status: UNKNOWN    Filename: maskit.E
<P>   
  File name for output map file on unit  10 : maskit.E
     logical name maskit.E
<P>   
   Minimum density in map  =       -0.54059   Maximum density         =        0.84817
   Mean density            =        0.10594
   Rms deviation from mean =        0.24391
<P>   
 Map written out
<P>   
 *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT ***
<P>   
 Version - 980710/0.3
 Started - Fri Jul 10 18:32:33 1998
 Stopped - Fri Jul 10 18:47:15 1998
<P>   
 CPU-time taken :
 User    -    659.6 Sys    -      0.8 Total   -    660.4
<P>   
 *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT ***
<P>   
 &gt;&gt;&gt;&gt;&gt;&gt; This program: (C) 1992-98, GJ Kleywegt &amp; TA Jones &lt;&lt;&lt;&lt;&lt;&lt;
 &gt;&gt;&gt;&gt; E-mail: gerard@xray.bmc.uu.se or alwyn@xray.bmc.uu.se &lt;&lt;&lt;&lt;
 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://xray.bmc.uu.se/usf &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
<P>   
 *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT *** MASKIT ***
<P>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
In this particular case, a cut-off of the correlation map somewhere
in the range of ~0.30 to ~0.50 produces a mask that (after some
fiddling with MAMA) compares very well to that generated from the
PDB file of the final model !
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H6">6 </A>MAP AND MASK SIZE</H2> </CENTER>
<P>   
MASKIT allocates memory for maps and masks dynamically. This means that
you can increase the size of maps and masks that the program can handle
on the fly:
<P>   
1 - through the environment variables MAPSIZE and MASKSIZE (must be
in capital letters !), for example put the following in your
.cshrc file:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 setenv MAPSIZE 8000000
 setenv MASKSIZE 3000000
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
2 - by using command-line arguments MAPSIZE and MASKSIZE (need not
be in capitals), for example:
<P>   
<PRE> <TT>  <B>   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 run coma -b mapsize 10000000 masksize 5000000
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
</B>  </TT> </PRE>
<P>   
Note that command-line arguments take precedence over environment
variables. So you can set the environment variables in your .cshrc
file to &quot;typical&quot; values, and if you have to deal with a map and/or
mask which is bigger than that, you can use the command-line argument(s).
<P>   
If sufficient memory cannot be allocated, the program will print
a message and quit. In that case, increase the amount of virtual
memory (this will not help, of course, if you try to allocate more
memory than can be addressed by your machine (for 32-bit machines,
something 2**32-1 bytes, I think), or reduce the size requirements.
<P>   
MASKIT needs space for 3 maps and 0.3 masks (actually, 2 maps and
one mask, each with 1/10-th the size of a &quot;normal&quot; mask).
<P>   
<HR NOSHADE>   <CENTER><H2>  <A NAME="H7">7 </A>KNOWN BUGS</H2> </CENTER>
<P>   
None, at present.
<HR NOSHADE>    <A HREF="http://xray.bmc.uu.se/usf/" target="_top">
<IMG ALIGN="right" BORDER="0" SRC="usf_logo.gif"
ALT="Uppsala Software Factory"></A>
<FONT SIZE=-1>
<B> <I> Created at Thu Jun 26 11:57:42 2008
by MAN2HTML version 070111/2.0.8 . This manual
describes MASKIT, a program of the <A HREF="http://xray.bmc.uu.se/usf/" target="_top">Uppsala
Software Factory</A> (USF), written and maintained by <A HREF="http://xray.bmc.uu.se/gerard"
target="_blank">Gerard Kleywegt</A>. &copy; 1992-2007.
</I> </B> </FONT><P>
<IMG SRC="http://xray.bmc.uu.se/cgi-bin/nph-count?width=6&link=http://alpha2.bmc.uu.se/~gerard/www/manuals/maskit_man.html">
</body></html>
