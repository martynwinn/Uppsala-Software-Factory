
 ** MOLEMAN2 - GENERAL INFORMATION

 Program : MOLEMAN2
 Version : 070913
 Author  : Gerard J. Kleywegt, Dept. of Cell and Molecular Biology,
           Uppsala University, Biomedical Centre, Box 596,
           SE-751 24 Uppsala, SWEDEN
 E-mail  : gerard@xray.bmc.uu.se
 Purpose : manipulation and analysis of PDB files
 Package : X-UTIL

 ** REFERENCES

 Reference(s) for this program:

 *  1 * G.J. Kleywegt (1995). Dictionaries for Heteros.
        CCP4/ESF-EACBM Newsletter on Protein Crystallography 31,
        June 1995, pp. 45-50.
        [http://xray.bmc.uu.se/usf/factory_5.html]

 *  2 * G.J. Kleywegt (1996). Making the most of your search model.
        CCP4/ESF-EACBM Newsletter on Protein Crystallography 32,
        June 1996, pp. 32-36.
        [http://xray.bmc.uu.se/usf/factory_6.html]

 *  3 * G.J. Kleywegt & T.A. Jones (1996). Phi/Psi-chology:
        Ramachandran revisited. Structure 4, 1395-1400.
        [http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Retrieve&list_uids=8994966&dopt=Citation]

 *  4 * G.J. Kleywegt & T.A. Jones (1997). Model-building and
        refinement practice. Methods in Enzymology 277, 208-230.
        [http://xray.bmc.uu.se/gerard/gmrp/gmrp.html]

 *  5 * G.J. Kleywegt (1997). Validation of protein models from CA
        coordinates alone. J Mol Biol 273, 371-376.
        [http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Retrieve&list_uids=9344745&dopt=Citation]

 *  6 * G.J. Kleywegt (1999). Experimental assessment of
        differences between related protein crystal structures.
        Acta Cryst. D55, 1878-1857.
        [http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Retrieve&list_uids=10531486&dopt=Citation]
        [http://scripts.iucr.org/cgi-bin/paper?se0283]

 *  7 * G.J. Kleywegt (2000). Validation of protein crystal
        structures. Acta Cryst. D56, 249-265 (Topical Review).
        [http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Retrieve&list_uids=10713511&dopt=Citation]
        [http://scripts.iucr.org/cgi-bin/paper?gr0949]

 *  8 * G.J. Kleywegt (2001). Validation of protein crystal structures.
        In: "International Tables for Crystallography, Volume F.
        Crystallography of Biological Macromolecules" (Rossmann, M.G.
        & Arnold, E., Editors). Chapter 21.1, pp. 497-506, 526-528.
        Dordrecht: Kluwer Academic Publishers, The Netherlands.

 *  9 * G.J. Kleywegt & T.A. Jones (2002). Homo Crystallographicus -
        Quo Vadis ? Structure 10, 465-472.
        [http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Retrieve&list_uids=11937051&dopt=Citation]

 * 10 * G.J. Kleywegt, M.R. Harris, J.Y. Zou, T.C. Taylor,
        A. Wahlby & T.A. Jones (2004). The Uppsala Electron
        Density Server. Submitted.

 * 11 * G.J. Kleywegt (2004). Quality control and validation.
        In "Crystallographic Methods", S. Doublie, Ed.
        Submitted.

 * 12 * Kleywegt, G.J., Zou, J.Y., Kjeldgaard, M. & Jones, T.A. (2001).
        Around O. In: "International Tables for Crystallography, Vol. F.
        Crystallography of Biological Macromolecules" (Rossmann, M.G.
        & Arnold, E., Editors). Chapter 17.1, pp. 353-356, 366-367.
        Dordrecht: Kluwer Academic Publishers, The Netherlands.

 ** VERSION HISTORY

 951107 - 0.1  - initial programming
 951108 - 0.2  - more (REad and APpend commands)
 960216 - 0.3  - more (some BF and OC commands; implemented main/side;
                 SElections; first documentation)
 960217 - 0.4  - WRite command; PDb CRystal/HEtero; PRotein MC_analysis
 960222 - 0.5  - PRotein SC_analysis
 960223 - 0.6  - PRotein CA_analysis; COnstant; BF BOnded; BF SMooth;
                 STatistics; more SElect ANd/OR options; some XYz commands
 960226 - 0.7  - more XYz commands; BF/OC PRod_plus; first CHain commands
 960227 - 0.8  - SPlit command; more CHain commands; more PDb commands
 960301 - 0.9  - SElect NUmeric; LIst_selected; ONo RSr/FIt/COnnect/TOrsion
 960303 - 0.10 - implemented macro facility; split PDb REmark command
                 into three separate ones (LIst, DElete, REmark); changed
                 some parameters from optional to required to make them
                 useful for macros (e.g., XYz ROtate/TRanslate); ONo
                 DIsulfide and ONo WAter_fit
 960304 - 0.11 - ONo OOps; DIstance PLot, DIstribution, SHort, SElect;
                 GEometry_selected; first useful version for Uppsala
 960311 - 0.12 - PDb NAme/NUmber; ONo XPlor_hydrogens; SQuence LIst/PIr;
                 SQuence GLyco_sites/MOtif
 960405 - 0.13 - minor bug fixes; MUlti_geom
 960408 - 0.14 - XYz CEntre_origin and XYz ALign_inertia_axes; first
                 general release
 960410 - 0.15 - add END card at end of PDB file (oops ...)
 960411 - 0.16 - debug generate.inp file for X-PLOR with SPlit command;
                 debug write CCP4 format (include cryst1 etc. cards)
 960412 - 0.17 - implemented LS_plane and ONo LS_plane_odl; SQuence
                 COunt, EXtinction_280; added optional parameter to
                 the "?" command which may be the name of any command
                 that has sub-commands; DELETE_molecule command;
                 AUto SPink, BOnes
 960414 - 0.18 - AUto SSe; lot of debugging in the core AUto subroutine
                 to fix instabilities -> the new algorithm appears to
                 be stable (and no longer has a random component ;-)
 960415 - 0.19 - minor bug fixes
 960416 - 0.20 - minor bug fixes
 960513 - 0.21 - correct naming of OT1/OT2 with SPlit command; includes
                 automatic generation of OT2 if necessary !
 960517 - 0.22 - implemented simple SYMBOL mechanism (& command)
 960520 - 0.23 - check for atoms which have X~Y~Z when reading a PDB
                 file (and in the BOok_keep command); new PDb command
                 CHemical+charge to add the symbol of the chemical
                 element and the charge to columns 77-80 of the ATOM and
                 HETATM records
 960521 - 1.0  - added optional "use_masses" parameter to the XYz
                 CEntre_origin command; this version stable and useful
                 enough for goverment work
 960629 - 1.0.1 - several small bug fixes made while at Yale
 960801 - 1.0.2 - added code to PRotein CA_analysis command to look
                  for sequential stretches of poor residues; this
                  also seems to detect some register errors !
 960802 - 1.0.3 - vastly improved ONo LS_plane command
 960804 - 1.0.4 - make border around atoms a parameter for ONo LS_plane
 960805 - 1.1   - MUlti_geometry now correctly averages dihedrals,
                  i.e., using RTODEG*ATAN2(AVESIN,AVECOS)
 961101 - 1.1.1 - change X-PLOR "generate" input files from SPlit command
                  so as to delete hydrogens and atoms with unknown coordinates
 970124 - 1.1.2 - minor bug fix (SE ? would crash on Alphas)
 970211 - 1.1.3 - the SQ PIr command to create a PIR file now only writes
                  one-letter code for residues for which at least one atom
                  has been selected (so you can easily avoid getting
                  hundreds of '?' residues for your waters etc.)
 970626 - 1.2   - support initialisation macro (setenv GKMOLEMAN2 macrofile)
 970701 - 1.2.1 - check for weird B-factors and occupancies while reading
                  a new PDB file
 970714 - 1.2.2 - implemented X-PLOR polars and X-PLOR/Lattmann Euler
                  angles in XYz ROtate
 970723 - 2.0   - implemented VRML commands
 970724 - 2.1   - added VRml CEll command; SElect NUmeric can now also
                  select on atomic Mass, Covalent bond radius and
                  chemical Element number; added SElect BUtnot,
                  SElect BY_residue and SElect Dist_to_sel; SElect
                  NUmeric can now have AND, OR or BUTNOT; VRml FAt_trace
 970729 - 2.1.1 - fixed bug in calculation of radius-of-gyration
 970807 - 2.1.2 - allow "?" wildcards in atom names in library file
                  (e.g., some people call their water oxygen " O  ",
                  others " O1 ", " OHH", etc.; use " O??" in the library
                  to capture all of these; similarly for metal ions)
 970924 - 2.1.3 - new PDb NO_atom_numbers command to remove O-style
                  atom numbers (indicating chemical element type)
 980420 - 2.1.4 - fixed bug in SElect DIst command (wrong parameters
                  were passed to the subroutine)
 981009 - 2.1.5 - improved macro generated by ONo OOps_macro command
 981014 - 2.1.6 - correct ONo COnnect and TOrsion datablocks even if
                  hydrogen atoms are present
 981021 - 2.1.7 - new ECho command to echo command-line input (useful
                  in scripts)
 981022 - 2.2   - implemented command history (# command)
 981216 - 2.2.1 - added some comments to output PostScript files
 990223 - 2.2.2 - doubled max nr of atoms and residues; removed
                  "on_off" commands from O macros generated by MOLEMAN2
 990301 - 2.2.3 - echo some PDB header lines when reading a PDB file
 990504 - 2.3   - ANISOU cards are now read and written
                - the SElect ANd, OR and BUtnot commands can now also
                  be used with the attributes ALtloc (alternative
                  location identifier, e.g. A, B, X, " ", etc.) and
                  ANisou (can be either T(rue) or F(alse))
                - new BFactor NO_anisou command to delete all ANISOUs
                - up to 20 least-squares planes (ONo LS_plane command)
                  can be stored, and their mutual angles calculated
                  with the new ONo ANgle_ls_planes command
 990823 - 2.3.1 - the STats, BFactor STats and OCcupancy STats commands
                  now also list the RMS values and the harmonic
                  averages of the B-factors and occupancies
 990924 - 2.4   - new VRml CRamp_selection, SPhere, CYlinder, and LIquorice
                  commands; debugged some of the VRML-generating routines
 990930 - 2.4.1 - in Ramachandran plots (PRot MC), D-amino acids are
                  now treated explicitly (their -phi and -psi are used
                  to assess if they're outliers or not; in the PostScript
                  plot they will be shown as red diamonds)
 991029 - 2.4.2 - fixed bug in XYZ PErturb command (shift for B and Q
                  used to be equal to the shift for Z, no matter what ...)
 991130 - 2.4.3 - increased max. number of atoms to 500,000 and max. number
                  of residues to 50,000
 991213 - 2.5   - implemented YASSPA routine (invoked during book-keeping),
                  the results can be used in SElect NUmeric, SElect ANd,
                  SElect OR, and SElect BUtnot (e.g., to colour helices
                  and strands differently in a VRML world)
 991221 - 2.6   - several bug fixes to get it to work properly with Linux/g77
 000310 - 2.6.1 - minor bug fix for CHain AUto command (used to coredump on Alphas)
 000313 - 2.6.2 - minor bug fix in REad command (Linux version choked on some CRYST1 cards)
 000526 - 2.7   - new ONo RIngs command (requires new version of moleman2.lib
                  library file !) to generate ODL files to draw the rings
                  as semi-transparent solid planes (e.g., Tyr, Trp, etc.)
 000529 - 2.7.1 - minor change
 001113 - 2.7.2 - PDb FArout command to generate quick-n-dirty HELIX
                  and SHEET records for use with FarOut
 001117 - 2.8   - new NUcleic DUarte_pyle command to make "Ramachandran-like"
                  plots to help analyse the conformation of RNA and DNA
 001130 - 2.8.1 - new VRml CLose_file command
 001229 - 2.8.2 - minor changes
 010725 - 2.8.3 - new ONo CEll command
 010727 - 2.8.4 - minor changes
 010803 -   X   - added a number of pictures to this manual to illustrate the
                  results of some commands
 010816 - 2.8.5 - minor changes
 010905 - 2.8.6 - DIstance LIst command (e.g., to find atoms that are
                  too close to one another)
 011023 - 2.8.7 - minor changes
 011114 - 2.9   - PRot MC, PRot CA and Nucleic DUarte commands now delete
                  the PostScript file they normally produce if it contains
                  no residues; all these three commands now also have an
                  extra (optional) argument to decide whether the analysis
                  should be carried out for all chains in one go, for
                  one chain in particular, or for each chain in turn
                  (in the latter case, you will get one PostScript file
                  for each chain, so this makes it easy to inspect
                  Ramachandran plots on a chain-by-chain basis)
 011115 - 2.9.1 - PRot MC, PRot CA and Nucleic DUarte option with "_"
                  as a chain argument now also work if a chain
                  has a blank chain ID
 011123 - 2.9.2 - minor bug fix
 011220 - 2.9.3 - minor change
 020129 - 2.9.4 - minor changes
 020221 - 2.9.5 - the STatistics command now also prints the range of
                  X, Y, and Z coordinates (together with the XYz ALign
                  command, this enables you to determine the dimensions
                  of your molecule)
 020514 - 2.9.6 - new ONo MOlray command to generate a trace pseudo-molecule
                  if you want to "fly" along a protein chain in a MolRay movie
 020516 - 2.9.7 - more options for ONo MOlray command
 020611 - 2.9.8 - new OCcupancy PLot command
 020628 - 3.0   - new DIstance CHains command to quickly find contacts
                  between two different chains (e.g., two monomers in
                  a dimer, or protein vs. DNA, or protein vs. ligand)
 020718 - 3.0.1 - new XYz AXis_rotate command to rotate around the
                  X, Y or Z axis by a user-specified angle
 020729 - 3.0.2 - optional 'how' parameter for the ONo DIsulfide
                  command (default = S, draw as sticks; alternative
                  L, draw as lines, i.e. like normal bonds) - suggested
                  by Marko Hyvonen. Also optional ODL object name
                  (in case you want more than one SS-bond object)
 020819 - 3.0.3 - renamed the VRml LIst_colours command to VRml
                  NAmed_colours (to avoid a clash with the VRml
                  LIquorice command ... thanks to Kevin Battaile
                  for pointing this out)
 020827 - 3.0.4 - ODL objects produced by same of the ONo commands
                  now have default names that begin with an underscore
                  to prevent any clashes with POV-Ray terms (such as
                  "plane")
 020927 - 3.0.5 - new ONo INertia_axes_odl command to generate an ODL
                  file to draw the axes of inertia for the selected
                  set of atoms (following a question from Michael Merckel)
 021023 - 3.0.6 - improved macro produced by ONo OOps command
 021030 - 3.0.7 - (while in Toronto) further improved macro produced by ONo OOps command
 021111 - 3.1   - minor bug fixes; new PDb SAnity_check command
 021114 - 3.1.1 - fix: now uses insert code to delineate different residues
                  (in addition to residue number, type, chain name, and
                  seqment ID)
 021121 - 3.1.2 - further improved macro produced by ONo OOps command
 030221 - 3.2   - new BFactor PSeudo, BF SAve, BF REstore, BF SCale, and
                  BF ODb commands to replace B-values by other properties, e.g.
                  for colour-ramping in O or Rasmol. With BF PSeudo you can
                  also calculate B-values predicted using Halle's method
 031204 - 3.2.1 - TER records are now written out in between ATOM records
                  in the same order as they were read
 031209 - 3.2.2 - PRot MC command will list possible left-handed helices
 031211 -       - corrected documentation of XYz MAtrix and XYz RT
                  commands w.r.t. the order in which the RT-operator
                  is read (thanks to Lluís Bellsolell for pointing out
                  the inconsistencies)
 041001 - 3.3   - replaced Kabsch' routine U3BEST by quaternion-based
                  routine (U3QION) to do least-squares superpositioning
 041018 - 3.3.1 - added "mode" parameter to DIstance SElected command (q.v.)
 041203 - 3.3.2 - implemented RContact_order command to calculate the
                  relative contact order (see Plaxco et al., J Mol Biol
                  277, 985-994, 1998)
 041206 - 3.3.3 - minor changes
 050317 - 3.3.4 - minor bug fix (in the COnstants LIst command; thanks to
                  Bryan Lepore for finding this)
 050909 - 3.3.5 - PDb FArout command renamed to PDb INdonesia (although
                  the old command name is still recognised); also
                  added a brief description of this command to this manual
 050916 - 3.3.6 - implemented PDb SEqres command
 060329 - 3.3.7 - implemented XYz DIstort command
 061122 - 3.3.8 - implemented SElect POint command
 070913 - 3.3.9 - updated NUcleic DUarte command to work with new-style
                  PDB files of DNA (DA, DC, etc.)


 ** START-UP MACRO

 From version 1.2 on, MOLEMAN2 can execute a macro at start-up (whether
   it is run interactively or in batch mode).  This can be used to
   execute commands which you (almost) always want to have executed.
   To use this feature, set the environment variable GKMOLEMAN2 to
   point to a MOLEMAN2 macro file, e.g.:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 setenv GKMOLEMAN2 /home/gerard/moleman2.init
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----


 ** INTRODUCTION

 MOLEMAN2 is a new version of the old MOLEMAN program.  It can be used
   for all sorts of manipulation and analysis of PDB files.  It is intended
   primarily for practicing crystallographers who need to do hundreds of
   little things to their PDB files when switching between different
   programs, etc.  Users of O, CCP4 and X-PLOR will benefit most from
   the functionality of this program.

 The user-interface is different from that of the old MOLEMAN, and more similar
   to that of MAPMAN, DATAMAN, etc.  I.e., instead of question-and-answer
   game you can supply any or all parameters for a command on one line.
   For example, to read a PDB file, "re file.pdb" is enough.  The other
   two parameters of the REad command (format and option to read hydrogens)
   will be set to their default values.  For all commands, the first
   two characters are unique, so "re" is the same as "read", etc.  Optional
   parameters are enclosed in [square brackets] in the list of commands.
 NOTE: the DELETE_molecule command is an exception and requires the
   first six characters to be typed (i.e., the word "delete"); this
   is to reduce the risk of accidental deletion of your molecule !

 An important difference with the old MOLEMAN is the fact that you can
   select subsets of atoms which will be used by many commands.  In this
   fashion, you can use the same command ("bfactor stats") to get
   statistics about all atoms, all protein atoms, all main-chain
   atoms in segment XYZ1, etc.  This makes the program much more flexible
   and easier to maintain (since no special-purpose options are
   necessary for different possible subsets of atoms).

 Another important difference is that a library file is used which
   contains information about residues, such as their constituent
   main-chain and side-chain atoms, their type (protein, metal,
   carbohydrate, etc.), aliases (e.g., waters may be called WAT, HOH,
   H2O, etc.), and so on.  You can use residue types in your selections
   so that it is very easy to get B-factor statistics for all
   non-hydrogen carbohydrate atoms with segment id CRB1, for instance.

 MOLEMAN2 also allows you to write and execute macros for series of
   commands that you execute often (e.g., when going from a new X-PLOR
   model to a PDB file suitable for O and CCP4).

 Many commands have a built-in mini-help facility which explains what
   the parameters to the command are or what values they may have.
   For instance, if you type "write ?" the program will explain what
   the parameters are:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Syntax: WRite file [format] [which]
 file   = PDB file name
 format = Pdb | Xplor | Ccp4
 which  = ALl | NO_hydro | SElected | PAla |
          PGly | PSer | CAlpha
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Parameters in [square brackets] are optional and will default to the
   first value listed (e.g., in this example, the default is to write
   ALl atoms to a Pdb-formatted file).

 For parameters which can have several values, the UPPERCASE characters
   show how many characters define a unique value.  In the example above,
   you can enter P, X or C for the format, but for the "which" parameter
   you must supply (at least) *two* characters.

 You will be prompted to supply values for all parameters that you do
   not type on the command line, except those for which default values
   exist.  Usually, the values suggested by the program make sense
   (if not, let me know).

 If you need to provide a text parameter which contains spaces (such
   as the spacegroup symbol for the PDB CRYST1 record), enclose the
   whole string in "double quotes".  Otherwise, one or more blanks
   and/or tabs are used to delimit parameter values.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pd cr 84 84 111.8 90 90 90 8 "P 21 21 2"
 Unit-cell axes (A)      : (  84.000   84.000  111.800) 
 Unit-cell angles (deg)  : (  90.000   90.000   90.000) 
 Unit-cell volume (A3)   : (  7.889E+05) 
 Nr of molecules in cell : (       8) 
 Spacegroup symbol       : (P 21 21 2) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The dimensioning of the program (e.g., the maximum number of atoms, etc.)
   is shown at startup.  If you need a bigger version. let me know.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Array dimensioning:

 1) Library:
    Max nr of residue types       : (        200) 
    Max nr of atom types          : (       2000) 
    Max nr of residue aliases     : (        100) 
    Nr of defined residue classes : (        100) 

 2) Molecule:
    Max nr of atoms               : (     100000) 
    Max nr of residues            : (      10000) 
    Max nr of REMARK records      : (       1000) 
    Max nr of other records       : (       1000) 

 3) Program:
    Max buffer size               : (     524288) 
    Max nr of atoms per residue   : (        100) 
    Max nr of residue torsions    : (        100) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** MACROS

 In MOLEMAN2 you can also use macros (as in MAMA).  A macro is a small
   text file containing MOLEMAN2 commands (but usually few parameters;
   these are left to the user to enter on demand) and comments.  A
   simple macro to convert an X-PLOR PDB file into one suitable for
   O and CCP4 may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! xplor_to_ccp4.momac - gj kleywegt @ 960303
!
! MOLEMAN2 macro to go from an X-PLOR PDB file with segment ids
! and hydrogen atoms, to a ccp4/o file with chain names and
! no hydrogens etc.
!
! Enter X-PLOR PDB file name:
read
!
! Some information about the molecule(s)
statistics
!
! Generate chain names from segment IDs
chain from_segid auto
!
! Enter cell constants etc.:
pdb crystal
!
! Enter * to delete all X-PLOR remarks:
pdb delete_remark
!
! Enter a descriptive remark about the file:
pdb remark
!
! Enter CCP4/O PDB file name:
write
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 When executed (with the @ command), this will give the following:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > @xplor_to_ccp4.momac
 ... Opened macro file : (xplor_to_ccp4.momac) 
 ... On unit : (      61) 
 > (!) 
 > (! xplor_to_ccp4.momac - gj kleywegt @ 960303) 
 > (!) 
 > (! MOLEMAN2 macro to go from an X-PLOR PDB file with segment ids) 
 > (! and hydrogen atoms, to a ccp4/o file with chain names and) 
 > (! no hydrogens etc.) 
 > (!) 
 > (! Enter X-PLOR PDB file name:) 
 > (read) 
 PDB file ? (m1.pdb) hydro.pdb
 Reading from file : (hydro.pdb) 
 ...
 > (! Some information about the molecule(s)) 
 > (statistics) 
 Nr of atoms    : (       5794) 
 Nr of residues : (        802) 
 ...
 > (! Generate chain names from segment IDs) 
 > (chain from_segid auto) 

 RESIDUE  ALA    86  AAAA
 New chain name : (A) 

 RESIDUE  NAG   501  BBBB
 New chain name : (B) 
 ...
 > (! Enter cell constants etc.:) 
 > (pdb crystal) 
 A axis (A) ? (    1.00) 49.1
 B axis (A) ? (    1.00) 75.8
 C axis (A) ? (    1.00) 92.9
 Alpha angle (deg) ? (   90.00) 
 Beta  angle (deg) ? (   90.00) 103.2
 Gamma angle (deg) ? (   90.00) 
 Nr of molecules in cell ? (       1) 4
 Spacegroup symbol ? (P 1) P 21
 ...
 > (! Enter * to delete all X-PLOR remarks:) 
 > (pdb delete_remark) 
 Which ? (-1) *
 Delete all REMARK records
 > (!) 
 > (! Enter a descriptive remark about the file:) 
 > (pdb remark) 
 Text ? (???) Model M3 @ 960303 R=0.231 Rfree=0.273
 Add REMARK record : (Model M3 @ 960303 R=0.231 Rfree=0.273) 
     1: REMARK Model M3 @ 960303 R=0.231 Rfree=0.273
 > (!) 
 > (! Enter CCP4/O PDB file name:) 
 > (write) 
 PDB file ? (hydro.pdb) m3.pdb
 Output PDB file : (m3.pdb) 
 Format : (Pdb) 
 Atoms  : (ALl) 
 ...
 ... End of macro file
 ... Control returned to terminal
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Generally useful macros will be made available via the public domain
   OMAC directory (/nfs/public/omac in Uppsala; pub/gerard/omac for
   downloading from other sites).

 Note that macros may be nested (the level depends on how many files
   may be open at the same time on your paticular type of machine).
   For instance, a macro which converts a new X-PLOR model into a
   PDB for O/CCP4, and does some quality analysis, and lists B-factor
   statistics may look as simple as this (assuming your directory
   contains a soft link called "omac" to your local OMAC directory):

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
!
! new_model.momac - gj kleywegt @ 960303
!
! MOLEMAN2 macro to generate an O/CCP4 PDB file from an X-PLOR PDB
! file; analyse main-chain, side-chain and CA-geometry, and list
! B-factor statistics
!
@omac/xplor_to_ccp4.momac
@omac/prot_qual.momac
@omac/bfac_stats.momac
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** MOLEMAN2 VERSUS MOLEMAN

 A number of features and options from the old MOLEMAN have been dropped
   (but many more have been improved ;-).  If you need any of these, use the
   old MOLEMAN program.  Dropped features include:

 - Balasubramanian plots
 - HPGL and O2D files for Ramachadran plots
 - occupancy plots (if someone really needs them, let me know)
 - averaging temperature factors over different chains
 - BAD files (i.e., internal coordinates, Bond-distances, Angles,
   Dihedrals)
 - flag-colour datablocks (e.g., to colour your molecule according
   to the Dutch or Swedish flag)

 Note that MOLEMAN2 versions below 1.0 are still development versions, so
   not all the functionality may have been implemented yet !

 The following list shows the old MOLEMAN commands and their counterparts
   in the new MOLEMAN2 (up-to-date at 960304):

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 READ_pdb_file             = REad
 NO_H_read                 = REad
 ALWYn_format_read         = REad
 APPEnd_pdb_file           = APpend
 WRITe_pdb_file            = WRite
 DUMP_pdb_file             = WRite
 SPLIt_pdb_file            = SPlit
 EXPOrt_bad_file       = NOT SUPPORTED
 IMPOrt_bad_file       = NOT SUPPORTED
 SAME_export           = NOT SUPPORTED
 HELIx_generate            = AUto SPink/BOnes/SSe
 STRAnd_generate           = AUto SPink/BOnes/SSe
 QUIT                      = QUit

 REMArk_etc_cards          = PDb REmark/LIst_remark/DElete_remark
 CRYStal_PDB_card          = PDb CRystal
 SSBOnd_records            = PDb SSbond
 PIR_sequence_file         = SQuence PIr
 GLYCo_sites               = SQuence GLyco_sites
 EXTInction_280            = SQuence EXtinction_280
 TALLy_residues            = SQuence COunt
 COUNt_elements        = not implemented yet
 WATEr_sort            = not implemented yet

 RSR_datablock             = ONo RSr
 CONNect_file              = ONo COnnect
 TORSion_datablock         = ONo TOrs
 RSFIt_datablock           = ONo FIt
 DISUlfide_ODL_file        = ONo DIsulfide
 FIT_water_macro           = ONo WAter_fit
 FLAG_colours          = NOT SUPPORTED

 STATistics                = STatistics
 PLOT_Bs_or_Qs             = BFactor PLot
 RADIal_B_plot             = BFactor PLot
 RAMAchandran_plot         = PRotein MC_analysis
 PLANar_peptides           = PRotein MC_analysis
 BALAsubramanian_plot  = NOT SUPPORTED
 CHI_list                  = PRotein SC_analysis
 CA_Ramachandran_plot      = PRotein CA_analysis
 CACA_distances            = PRotein CA_analysis
 CA_Distance_plot          = DIstance PLot
 LIST_residue              = LIst_selected
 GEOMetry_list             = GEometry_selected
 SEQUence_list             = LIst_selected/SQuence LIst
 BURIed_charges       = not implemented yet
 DISTance_distribution     = DIstance DIstribution
 SHORt_contacts            = DIstance SHort

 LIMIt_B_and_Q             = BFactor/OCcupancy LImit
 AVERage_temp_factors      = BFactor GRoup
 TEMP_factors_set          = BFactor LImit/PRod_plus
 OCCUpancies_set           = OCcupancy LImit/PRod_plus
 SMOOth_Bs                 = BFactor SMooth
 B_Q_statistics            = BFactor/OCcupancy STats
 BONDed_Bs                 = BFactor BOnded
 NONBonded_Bs              = BFactor BOnded

 O2XHydrogens              = ONo XPlor_hydrogens
 SUGGest_OT2               = CHain OT2_suggest
 RENUmber_atoms        = NOT SUPPORTED
 ALTEr_residue_name        = PDb NAme
 RESIdu_renumber           = PDb NUmber
 ZONE_renumber             = PDb NUmber
 CHECk_nomenclature        = PRotein SC_analysis
 CORRect_nomenclature = not implemented yet
 CHAIn_name                = CHain NAme_selection/REname
 XPLOr_ids                 = CHain NAme_selection/SEgid_rename
 FROM_chain_to_XID         = CHain TO_segid
 XID_to_chain              = CHain FRom_segid
 AUTO_chain_segid          = CHain AUto
 ASK_auto_chain_segid      = CHain ASk

 FRACtional_to_cartesian   = XYz ORthogonalise
 CARTesian_to_fractional   = XYz FRactionalise
 ROTAte_molecule           = XYz ROtate
 TRANslate_molecule        = XYz TRanslate
 APPLy_random_rotation     = XYz RAndom_rotation
 RANDom_shifts             = XYz PErturb
 ORIGin_move               = XYz CEntre_origin
 MIRRor_zone               = XYz MIrror
 INVErt_zone               = XYz INvert
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 On the whole, MOLEMAN2 provides a superset of the functionality of the old
   MOLEMAN, with many additional benefits:
 - removed bugs
 - more use of (sensible) defaults to minimise typing (compare the new
   WRite command to the one in the old MOLEMAN)
 - use of atom selections to operate on only a subset of the atoms
 - combined commands (e.g., the PRotein MC_analysis combines several old
   MOLEMAN commands, plus new functionality)
 - extended functionality (e.g., the XYz commands are much more flexible
   than the combined set of old MOLEMAN commands they replace; also the
   SPlit command will now auto-generate a GENERATE input file for X-PLOR
   which usually requires little editing; the PDb HEtero command is new)
 - the program is now easier to extend since I have actually thought a bit
   about my data structures (not too much, of course, I'm still a Fortran
   relic).  The old MOLEMAN was initially written to do just two simple
   things: add X-PLOR segment IDs and write an END card at the end of
   PDB files ;-)  Since then it has outgrown itself rapidly, making it
   a major pain to implement or change functionality.

 ** MOLEMAN2 AND PDB FILES

 Not written yet.

 ** SECONDARY STRUCTURE

 As of version 2.5, MOLEMAN2 automatically determines the secondary
   structure of protein residues in its book-keeping stage (e.g., when
   a molecule is read in). This is done using the YASSPA algorithm
   and should give identical results to those you get in O (not
   necessarily for left-handed helices, though). There
   are five possible "states":

 - 0 = loop or turn
 - 1 = alpha helix (right-handed)
 - 2 = beta strand
 - 3 = left-handed alpha helix
 - -1 = non-protein residues

 The results can be used with the SElect commands, so you can list
   all left-handed helical residues, colour the helices blue in
   your VRML world, write out only the residues in beta strands,
   calculate the average temperature factor for all helical
   residues, etc.

 If you know what you are doing, you can change the cut-off values for
   the algorithm using the COnstants commands (they are YALCUT, YBECUT
   and YLHCUT).

 ** LIBRARY

 The default library file in Uppsala can be found in /nfs/public/lib,
   with name "moleman2.lib".  If you set the environment variable
   GKLIB in your .cshrc file to /nfs/public/lib, the program will always
   come up with the correct default name for this name.  Outside Uppsala,
   the library file can be found in directory pub/gerard/xutil in the
   compressed tar file xutil_etc.dirtar.gz

 The library file must be read on start-up.  The program will prompt you
   for the filename.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ...
    Max nr of residue torsions    : (        100) 

 Name of library file ? (/nfs/public/lib/moleman2.lib) 

 Reading library ...
 > ( = MOLEMAN2.LIB = VERSION 0.1 = 951106 = GJ KLEYWEGT = 118 ENTRIES =) 

 Lines read    : (        785) 
 Residue types : (        118) 
 Atom types    : (       1314) 
 Aliases       : (         60) 

 First and last residue types:

 Residue #     1 = GLY (PROT) = GLYCINE
 Atoms    | N  | (T)  | CA | (T)  | C  | (T)  | O  | (T)

 Residue #   118 = TRS (ORGA) = TRIS TRIS(HYDROXYMETHYL)-AMINOMETHANE
 Atoms    | O1 | (F)  | C2 | (F)  | C3 | (F)  | C4 | (F)  | O5 | (F)  | C6 | (F)
 Atoms    | O7 | (F)  | N8 | (F)

 Check integrity:
 WARNING - name or alias conflict:    55 = MAL and    95 = MAL
 WARNING - name or alias conflict:    60 = GLC and    61 = GLC
 WARNING - name or alias conflict:    61 = GLC and    60 = GLC
 WARNING - name or alias conflict:    63 = MAN and    64 = MAN
 WARNING - name or alias conflict:    64 = MAN and    63 = MAN
 WARNING - name or alias conflict:    95 = MAL and    55 = MAL
 ERROR --- Non-unique residue names/aliases

 Count types:
 Nr of amino acid residue types : (         22) 
 Nr of nucleic acid types       : (          4) 
 Nr of water types              : (          1) 
 Nr of metal types              : (         13) 
 Nr of inorganic types          : (         12) 
 Nr of carbohydrate types       : (         18) 
 Nr of organic compound types   : (         48) 
 Nr of other compound types     : (          0) 

 MOLEMAN2 commands :
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 As you can see, there are some duplicate names (not necessarily for
   identical compounds, e.g. alpha- and beta-glucose can both be called
   GLC).  The program will use the first occurrence.

 The format is as follows (in case you want to edit the file or add new
   residue type definitions):

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 For each residue type:

 RES XYZ description
   FORMAT: (A3,1x,A3,1x,A80)
   - XYZ = 3-letter residue type
   - description = free text
 TYP ABCDefghijkl
   FORMAT: (A3,1x,A4)
   - ABCD = one of the defined categories, e.g. protein
 AKA ABC DEF GHI
   FORMAT: (A3,n(1x,A3)) (multiple cards allowed)
   - 0 or more synonyms for the residue type
 MCH ...
   FORMAT: first card (A3,1X,*)
           subsequent cards (4X,*)
   - 0 or more atom names which constitute the main chain or backbone
 SCH ...
   FORMAT: first card (A3,1X,*)
           subsequent cards (4X,*)
   - 0 or more atom names which constitute the side chain
 END
   FORMAT: (A3)
   - signals end of residue definition

 in MCH and SCH lines, use a "-" at the end of a line to signal
   continuation on the next one; start the next line with 5 spaces !

 any line beginning with "!" is a comment which will not be printed

 any line beginning with REM is a comment which will be printed
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The pre-defined residue types are: PROTein, NUCLeic acid, WATEr, METAl ions,
   INORganic ions and clusters, CARBohydrates, and ORGAnic ligands, ions,
   substrates, co-factors etc.  Anything else will be classified as HETEro.
 
 An example:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
RES CYS cysteine
TYP protein
AKA CSS CSH CYH CYX
MCH ' N  ' ' CA ' ' C  ' ' O  '
SCH ' CB ' ' SG '
END
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 As of version 2.7, ring definitions can also be included (used by
   the ONo RIngs command).

 If you want your special residue/ligand to be included in the standard
   distribution version of the library, or if you find any errors,
   E-mail me (gerard@xray.bmc.uu.se).

 If you have compounds which are not in the library, it usually doesn't
   matter too much, as long as you realise that:
 - the compound will be assigned type HETEro; if it is in actual fact an
   unusual amino acid you should add it to the library
 - all atoms will be flagged as being side-chain atoms; again, if you
   have unusual amino acids or nucleotides, this may not be what you want
 - no check for missing/superfluous atoms can be carried out (BOok_keep
   command)

 ** PLOT FILES

 Some commands produce plot files for O2D.  On an SGI, you can view these
   plots interactively, and analyse them.  On other machines, you can
   convert them to PostScript (or CricketGraph) files.  Use the script
   OMAC/o2dps to do the conversion to PostScript automatically (and for
   lots of files at once, if you like).

 Other commands directly produce PostScript files.  Use your local viewer
   (e.g., ghostview or ghostscript) to look at these, and/or print them
   on a PostScript printer.

 ** PROGRAM PARAMETERS

 With the COnstants command a number of program parameters can be altered
   by the user.  These include:

 - BLIMLO/BLIMHI/QLIMLO/QLIMHI - used by the BFacor/OCcupancy LImit
   commands
 - MXCACA - maximum CA-CA distance for connected residues (used by
   several commands)
 - MXPP - maximum P-P distance for connected nucleic acid residues
 - TORTOL - tolerance for certain impropers/dihedrals (e.g., used by
   the PRotein SC_analysis and ONo TOrsion commands)
 - MXBOND - maximum distance for two atoms to be considered bonded
   (e.g., used by the BFactor SMooth command)
 - MXNONB - maximum distance for non-bonded interactions (two atoms
   are involved in a non-bonded interaction if their distance lies
   in the range <MXBOND,MXNONB]); used by BFactor BOnded
 - MXCYSS - maximum Cys-SG...SG-Cys distance for disulfide links
   (e.g., used by the SPlit command to generate DISUlfide patches
   for your X-PLOR GENERATE input file)
 - ISEED  - special (integer) number used to initialise the random
   number generator (positive number: initialise with that number,
   i.e. reproducibly; zero or negative number: initialise with the
   current value of MCLOCK(), the system clock); used by the XYz
   RAndom_rotation and PErturb commands
 - YALCUT, YBECUT and YLHCUT - parameters for the YASSPA algorithm
   that assigns the secondary structure of the protein residues

 For an up-to-date list, use the COnstants LIst command.  To revert to
   the "factory defaults", use the COnstants REset command.

 Note that the values you enter are NOT checked at all.  So if you want
   to set the maximum distance for connected CA atoms to -3.14 A, you
   may do so.

 ** GENERAL, I/O AND BOOK-KEEPING COMMANDS

 ## ? - list commands

 Syntax: ? [command]
 command = name of any command which has sub-commands (e.g., XYz, ONo, etc.)

 Typing a single question mark will provide you with a list of all available
   commands.  If you supply an argument "?", you will only see the general
   commands.  If the argument is the name of a command which has sub-commands
   (such as SElect, XYz, PRotein, etc.), you will only get the list of
   those commands.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ? ?

 MOLEMAN2 commands :

 ? [command] (list (sub-)commands)    ! (comment)
 QUit                                 $ shell_command
 @ macro_file                         BOok_keeping
 COnstants REset                      COnstants SEt name value
 COnstants LIst                       STatistics
 GEometry_selected                    LIst_selected [which]
 MUlti_geometry which                 LS_plane

 REad file [format] [hydro]           WRite file [format] [which]
 APpend file [format] [hydro]         SPlit file_prefix
 DElete_molecule                      

 Commands with sub-commands:
 SElect  BFactor  OCcupancy  CHain    PDb   PRotein
 XYz     ONo      DIstance   SQuence  AUto
 To see sub-commands, use for instance: ? xy
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ? sele

 SElect All                           SElect NOne
 SElect HYdrogen                      SElect EXhydrogen
 SElect OR what which                 SElect ANd what which
 SElect NEgate                        SElect NUmeric and_or what lo hi
 SElect ?                             
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## & - (re-)define a symbol or list current symbols

 This command can be used to manipulate symbols.  These are probably
   only useful for advanced users who want to write fancier macros.
   The command can be used in three ways:
 (1) & ? -> lists currently defined symbols
 (2) & symbol value -> sets "SYMBOL" to "value"
 (3) & symbol -> prompts the user to supply a value for "SYMBOL"
    (even if the program is executing a macro)

 A few symbols are predefined:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > & ?
 Nr of defined symbols : (       2) 
 Symbol START_TIME : (Fri May 17 19:55:43 1996) 
 Symbol USERNAME : (gerard) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The symbol mechanism is fairly simplistic and has some limitations:
 - max length of a symbol name is 20 characters
 - max length of a symbol value is 256 characters
 - max number of symbols is 100
 - symbols can not be deleted, but they can be redefined
 - symbol values are accessed by supplying $SYMBOL_NAME as an
   argument on the command line; the line that you type on the terminal
   (or in a macro) is parsed once; if there are additional parameters
   which the program prompts you for, you cannot use symbols for those
 - only one substitution per argument (e.g., "$file1 $file2" will
   lead to a substituion of the entire argument by the value of
   symbol FILE1 only !)
 - command names (first argument on any command line) cannot be
   replaced by a symbol (e.g.: "$command $arg1 $arg2" is not valid)
 - symbols may be equated to each other, e.g. "& file2 $file1" will
   give FILE2 the same value as FILE1
 - symbol substitution is not recursive (e.g., if you set the value
   of FILE2 to be "$file1", any reference to $FILE2 will be replaced
   by "$file1", not by the value of FILE1
 - symbols on comment lines (starting with "!") are not expanded
 - symbols on system command lines (starting with "$") are not expanded

 Example of the use of symbols:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Which rotation angle convention ?
! Enter CE for CCP4 Euler angles, or CP for CCP4 Polar angles:
& conv
!
! Rotation angle 1 ?
& alpha
!
! Rotation angle 2 ?
& beta
!
! Rotation angle 3 ?
& gamma
!
! Applying rotation function solution
xyz rotate $conv $alpha $beta $gamma
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ECho - toggle command-line echo on/off

 If you run the program with scripts, it is sometimes useful to see
   input commands echoed.  The parameter to the ECho command may be
   ON, OFf, or ? (to list the echo status).

 ## #
 Command history. Possible uses (blank spaces are optional):
 - # ? => list history of commands
 - # ! => ditto, but without numbers (handy for copying into macros)
 - # ON => switch command history on
 - # OFf => switch command history off
 - # # => repeat previous command
 - # 14 => repeat command number 14 from the list
 - # 0 => repeat previous command
 - # -1 => repeat penultimate command, etc.
 - # 7 more => repeat command number 7, but add "more" to it
        (e.g., if command 7 was "$ ls" you could type "#7 -FartCos"
        to get "$ ls -FartCos")

 ## STatistics - general statistics

 This command calculates and prints some statistics for the currently
   selected set of atoms.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > st
 Nr of atoms    : (       2813) 
 Nr of residues : (        396) 

 Nr of amino acid residues : (        370) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (         24) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          0) 
 Nr of other compounds     : (          2) 

 Nr of selected atoms : (       2813) 
      Ditto, hydrogen : (          0) 
      Ditto, ANISOU   : (          0) 

       Item    Average     St.Dev        Min        Max        RMS  Harm.ave.
       ----    -------     ------        ---        ---        ---  ---------
    X-coord      0.000     14.956    -30.527     36.812
    Y-coord      0.000     10.308    -24.280     25.566
    Z-coord      0.000      8.683    -20.405     21.471
   B-factor     28.669     28.761      2.000    218.470     40.610      8.843
 Warning - there are B-factors > 100 A**2 !
    Occpncy      1.000      0.000      1.000      1.000      1.000      1.000

 The radius of gyration is   20.1 A

 Range of X, Y, and Z coordinates:   67.3 A *   49.8 A *   41.9 A
 If you have used XYz ALign_inertia_axes, these numbers
 give you an indication of the dimensions of the selected
 molecule (or set of atoms).
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BOok_keeping - do some book-keeping checks

 This command will re-determine where residues start and end, if there
   are duplicate atoms or missing atoms or extra atoms in residues
   that occur in the library, or if there are residues not in the
   library, and if all residue names are unique.

 The program also checks if there are any atoms which have X ~ Y ~ Z;
   often, this is an indication of unset or unknown coordinates (e.g.,
   new atoms in O will be placed at (1500,1500,1500), sometimes waters
   end up at (0,0,0) etc.) which may lead to all sorts of trouble
   later on (e.g., in map extension around the molecule or the generation
   of NCSRel-cards by XPAND).  The tolerance used is 0.01 A.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bo

 Total nr of residues      : (        239) 
 Nr of amino acid residues : (        137) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (        101) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          1) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...
 ERROR --- Unknown atom in structure
 ATOM  1091  OXT GLU   137      26.188 -39.912  33.302  1.00 22.23      1CBS1313
 ERROR --- Unknown atom in structure
 ATOM  1115  O   HOH   300      15.524 -31.764  26.116  1.00 17.43      1CBS1337
 ERROR --- Missing atom in structure
 RESIDUE  HOH   300  1CBS
 Atom name : ( O1) 
 ...
 ERROR --- Missing atom in structure
 RESIDUE  HOH   399  1CBS
 Atom name : ( O1) 

 Checking uniqueness of residue names ...
 Non-unique residue names : #  224 = HOH   385  1CBS <-> #  230 = HOH   385  1CBS

 Checking "special" positions (X~Y~Z) ...
 ATOM  1200  O   HOH   385       0.000   0.000   0.000  1.00 32.12      1CBS1422
 ATOM  1200  O   HOH   385    1500.0001500.0001500.000  1.00 32.12      1CBS1422
 ATOM  1210  O   HOH   395     -36.656 -36.656 -36.656  1.00 35.59      1CBS1432
 WARNING - Nr of atoms with X~Y~Z : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## LIst_selected - list selected atoms or residues

 Syntax: LIst_selected [which]
 which  = Residues | Atoms

 You may either list all selected atoms, or the first selected atom
   (if any) of all residues.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se nu and bf 50 9999
 Select Numeric : ( AND B-factor 50.00000 9999.000) 
 Selection history : (NON-HYDROGEN | AND B-factor 50.00000 9999.000 |) 
 Nr of selected atoms : (          8) 
 MOLEMAN2 > li r
 List first selected atom of every residue
 ATOM   807  CE  LYS   101       4.479  34.527  19.248  1.00 51.31      1CBS1029
 ATOM   819  CD  GLU   103      -0.383  25.503  13.395  1.00 50.23      1CBS1041
 ATOM  1193  O   HOH   378       9.543  16.072  11.145  1.00 50.91      1CBS1415
 ATOM  1194  O   HOH   379       8.174  14.289  20.240  1.00 54.21      1CBS1416
 ATOM  1196  O   HOH   381       5.486  15.385  24.922  1.00 50.19      1CBS1418
 Nr of residues listed : (          5) 
 MOLEMAN2 > li a
 List all selected atoms
 ATOM   807  CE  LYS   101       4.479  34.527  19.248  1.00 51.31      1CBS1029
 ATOM   808  NZ  LYS   101       4.917  33.952  20.559  1.00 51.14      1CBS1030
 ATOM   819  CD  GLU   103      -0.383  25.503  13.395  1.00 50.23      1CBS1041
 ATOM   820  OE1 GLU   103      -0.130  26.346  12.499  1.00 53.12      1CBS1042
 ATOM   821  OE2 GLU   103      -1.464  25.500  14.036  1.00 52.16      1CBS1043
 ATOM  1193  O   HOH   378       9.543  16.072  11.145  1.00 50.91      1CBS1415
 ATOM  1194  O   HOH   379       8.174  14.289  20.240  1.00 54.21      1CBS1416
 ATOM  1196  O   HOH   381       5.486  15.385  24.922  1.00 50.19      1CBS1418
 Nr of atoms listed : (          8) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## LS_plane - calculate least-squares plane through selected atoms

 This command calculates the equation of the least-squares plane
   through the currently selected atoms (unit weights), and the
   RMSD of the atoms to the plane.
 If you want to display the plane in O, use the ONo LS_plane_odl
   command instead.  Also, if you want to see the distance of
   the individual atoms to the plane, use the ONo LS_plane command.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and res rea
 AND atom selection
 With atoms for which : (RES) 
 Equals : (REA) 
 Selection history : (ALL | AND REsidu = REA |) 
 Nr of selected atoms : (         22) 
 MOLEMAN2 > ls
 Nr of selected atoms : (         22) 
 Centre of Gravity : (  22.065   26.283   20.209) 
 Eigen value 1 =        515.0 Vector :   0.145303 -0.597192  0.788828
 Eigen value 2 =         31.0 Vector :   0.847841  0.486099  0.211834
 Eigen value 3 =          6.7 Vector :  -0.509954  0.638020  0.576955
 Determinant : (   1.000) 
 Eigenvector #3 defines the least-squares plane
 Equation:  -0.509954 X +   0.638020 Y +   0.576955 Z =  17.176491
 RMSD to plane : (   0.552) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Note that the three eigenvalues tell you something about the shape
   of the selected set of atoms: in the example above (an all-trans-
   retinoic acid molecule), it is clearly very long, not very
   wide, and fairly planar (eigenvalue 1 >> 2 > 3).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ...
 Selection history : (ALL | AND REsidu = TRP | AND CLass = Side | AND 
  Residue_nr 109 109 |) 
 Nr of selected atoms : (         10) 
 MOLEMAN2 > ls
 Nr of selected atoms : (         10) 
 Centre of Gravity : (  13.617   20.280   29.635) 
 Eigen value 1 =         28.3 Vector :   0.044093  0.093234  0.994667
 Eigen value 2 =         12.4 Vector :  -0.373900  0.924815 -0.070112
 Eigen value 3 =          0.0 Vector :   0.926420  0.368814 -0.075638
 Determinant : (  -1.000) 
 ERROR --- Negative determinant; change hand of inertia axes
 Eigen value 1 =         28.3 Vector :  -0.044093 -0.093234 -0.994667
 Eigen value 2 =         12.4 Vector :   0.373900 -0.924815  0.070112
 Eigen value 3 =          0.0 Vector :  -0.926420 -0.368814  0.075638
 Determinant : (   1.000) 
 Eigenvector #3 defines the least-squares plane
 Equation:  -0.926420 X +  -0.368814 Y +   0.075638 Z = -17.853298
 RMSD to plane : (   0.029) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## RContact_order - calculate relative contact order

 Syntax: RContact_order [cut_off]
 cut_off = distance cut-off to decide if two residues contact each other

 This option calculates the relative contact order of a protein chain
   as described by Plaxco et al., J Mol Biol 277, 985-994 (1998). The
   cut-off defaults to a value of 6.0 A (used by Plaxco et al.). Note
   that this calculation only makes sense for a single chain (or even
   domain) and that you should exclude hydrogen atoms from the contact
   calculations. Both conditions can be satisfied by clever use of
   the program's SElect commands (see the example below).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read pdb1fss.ent
 [...]
 MOLEMAN2 > sel ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       4742) 
 MOLEMAN2 > sel and chain a
 AND atom selection
 With atoms for which : (CHAIN) 
 Equals : (A) 
 Selection history : (NON-HYDROGEN | AND CHain = A |) 
 Nr of selected atoms : (       4242) 
 MOLEMAN2 > sel and type prot
 AND atom selection
 With atoms for which : (TYPE) 
 Equals : (PROT) 
 Selection history : (NON-HYDROGEN | AND CHain = A | AND TYpe = PROT |) 
 Nr of selected atoms : (       4226) 
 MOLEMAN2 > rco
 Calculate relative contact order
 Cut-off contact distance (A) : (   6.000) 
 Nr of selected residues : (        532) 
 Nr of contacting pairs  : (       3873) 
 Sum of separations      : (     166499) 
 Relative contact order  : (   0.081) 
 CPU total/user/sys :       1.7       1.7       0.0
 MOLEMAN2 > 
 MOLEMAN2 > sel ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       4742) 
 MOLEMAN2 > sel and chain b
 AND atom selection
 With atoms for which : (CHAIN) 
 Equals : (B) 
 Selection history : (NON-HYDROGEN | AND CHain = B |) 
 Nr of selected atoms : (        464) 
 MOLEMAN2 > sel and typ prot
 AND atom selection
 With atoms for which : (TYP) 
 Equals : (PROT) 
 Selection history : (NON-HYDROGEN | AND CHain = B | AND TYpe = PROT |) 
 Nr of selected atoms : (        464) 
 MOLEMAN2 > rco
 Calculate relative contact order
 Cut-off contact distance (A) : (   6.000) 
 Nr of selected residues : (         61) 
 Nr of contacting pairs  : (        344) 
 Sum of separations      : (       4858) 
 Relative contact order  : (   0.232) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## MUlti_geometry - residue geometry statistics for multiple copies

 Syntax: MUlti_geometry which
 which  = residue_type (must be defined in the library)

 This command will list statistics (number of observations, average, standard
   deviation, minimum and maximum value) for the following for all currently
   selected copies of a user-specified residue type:
 - bonded distances
 - bond angles and 1-3 distances
 - torsion angles and 1-4 distances

 Note that the (torsion) angles used to be averaged in degrees, and that
   periodicity is not taken into account !   This means that
   dihedrals which are around +/-180 degrees may give seemingly
   large ranges !!!  This has been changed in version 1.1, so that
   the average of -178 and +178 is now (+ or -) 180, rather than zero.

 This option may be useful when creating "ideal geometry" dictionaries
   for a refinement program when you have several examples of the
   residue.  In addition it can be used to look for large outliers.

 The program constants LARGEB and LARGEA are used to flag bond
   distances and angles if they show a large range (i.e., maximum
   minus minimum value exceeds LARGEB for bonds or LARGEA for
   angles).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > mu gly
 Multiple copy geometry for : (GLY) 
 Nr of atoms : (          4) 
 Atoms : (  N  CA  C  O) 
 Looking for selected residues ...
 RESIDUE  GLY A  22  1CEL
 RESIDUE  GLY A  23  1CEL
 ...
 RESIDUE  GLY B 424  1CEL
 RESIDUE  GLY B 427  1CEL
 ERROR --- Too many copies
 Maximum : (        100) 
 Nr of copies found : (        100) 
 Nr of bonds : (          3) 
 Bond distance range large if > (   0.050) 
 Bond angle    range large if > (   5.000) 

 Bonded distances with cut-off :    2.000 A
 ==========================================
  N   -  CA  # 100 Ave, Sdv, Min, Max    1.451   0.004   1.440   1.464            
  CA  -  C   # 100 Ave, Sdv, Min, Max    1.517   0.006   1.501   1.529            
  C   -  O   # 100 Ave, Sdv, Min, Max    1.232   0.004   1.223   1.244            

 Angles and 1-3 angle distances
 ==============================
  N   -  CA  -  C   Angle     : 100  113.89    4.23  101.49  122.24 Large range
                    1-3 Dist  : 100   2.486   0.059   2.307   2.588
  CA  -  C   -  O   Angle     : 100  120.44    0.96  116.96  122.29 Large range
                    1-3 Dist  : 100   2.389   0.015   2.339   2.415

 Dihedrals and 1-4 torsion distances
 ===================================
  N   -  CA  -  C   -  O   Dihedral : 100    5.27  114.42 -178.61  179.19
                           1-4 Dist : 100   3.150   0.432   2.608   3.695
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > mu glc
 Multiple copy geometry for : (GLC) 
 Nr of atoms : (         12) 
 Atoms : (  C1  C2  C3  C4  C5  C6  O1  O2  O3  O4  O5  O6) 
 Looking for selected residues ...
 RESIDUE  GLC     1      
 RESIDUE  GLC     2      
 RESIDUE  GLC     3      
 RESIDUE  GLC     4      
 RESIDUE  GLC     5      
 RESIDUE  GLC     6      
 RESIDUE  GLC     7      
 RESIDUE  GLC     8      
 Nr of copies found : (          8) 
 Nr of bonds : (         11) 
 Bond distance range large if > (   0.050) 
 Bond angle    range large if > (   5.000) 

 Bonded distances with cut-off :    2.000 A
 ==========================================
  C1  -  C2  #   8 Ave, Sdv, Min, Max    1.533   0.013   1.513   1.548            
  C1  -  O5  #   8 Ave, Sdv, Min, Max    1.435   0.014   1.414   1.456            
  C2  -  C3  #   8 Ave, Sdv, Min, Max    1.519   0.013   1.503   1.543            
  C2  -  O2  #   8 Ave, Sdv, Min, Max    1.409   0.016   1.385   1.426            
  C3  -  C4  #   8 Ave, Sdv, Min, Max    2.528   0.413   1.497   2.875 Large range
  C3  -  O3  #   8 Ave, Sdv, Min, Max    1.416   0.008   1.411   1.436            
  C4  -  C5  #   8 Ave, Sdv, Min, Max    2.537   0.390   1.544   2.792 Large range
  C4  -  O4  #   1 Ave, Sdv, Min, Max    1.413   0.000   1.413   1.413            
 ...
  C6  -  O6  #   8 Ave, Sdv, Min, Max    1.410   0.016   1.374   1.426 Large range

 Angles and 1-3 angle distances
 ==============================
  C2  -  C1  -  O5  Angle     :   8  109.93    2.36  106.56  113.02 Large range
                    1-3 Dist  :   8   2.430   0.027   2.383   2.463
  C1  -  C2  -  C3  Angle     :   8  111.72    1.48  110.48  114.24            
                    1-3 Dist  :   8   2.526   0.013   2.512   2.546
 ...
  C1  -  O5  -  C5  Angle     :   8  117.02    1.53  115.16  119.50            
                    1-3 Dist  :   8   2.454   0.045   2.414   2.529

 Dihedrals and 1-4 torsion distances
 ===================================
  O5  -  C1  -  C2  -  C3  Dihedral :   8   51.28    7.74   39.17   60.96
                           1-4 Dist :   8   2.853   0.019   2.839   2.902
  O5  -  C1  -  C2  -  O2  Dihedral :   8   37.03  167.50 -179.25  174.97
                           1-4 Dist :   8   3.662   0.036   3.592   3.694
 ...
  O4  -  C4  -  C5  -  O5  Dihedral :   1 -172.14    0.00 -172.14 -172.14
                           1-4 Dist :   1   3.718   0.000   3.718   3.718
 ...
  C6  -  C5  -  O5  -  C1  Dihedral :   8  -89.61  149.13 -176.72  168.72
                           1-4 Dist :   8   3.760   0.052   3.691   3.839
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## GEometry_selected - list geometry of selected atoms

 This command will list the following for all currently selected atoms:
 - bonded distances
 - bond angles and 1-3 distances
 - torsion angles and 1-4 distances

 Make sure to use the SElect commands to isolate only those atoms that
   you are interested in !  Use the LIst_selected command before using
   this command to see exactly how many (and which) atoms/residues are
   selected.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se an re rea
 AND atom selection
 With atoms for which : (RE) 
 Equals : (REA) 
 Selection history : (ALL | AND REsidu = REA |) 
 Nr of selected atoms : (         22) 
 MOLEMAN2 > ge
 Nr of selected atoms : (         22) 

 Bonded distances with cut-off :    2.000 A
 ==========================================
  C1  [B 200 ] -  C2  [B 200 ] =    1.546 A
  C1  [B 200 ] -  C6  [B 200 ] =    1.564 A
 ...
  C15 [B 200 ] -  O2  [B 200 ] =    1.251 A
 Nr of bonded distances : (         22) 

 Angles and 1-3 angle distances
 ==============================
  C2  [B 200 ] -  C1  [B 200 ] -  C6  [B 200 ] =  109.691 deg =    2.543 A
  C2  [B 200 ] -  C1  [B 200 ] -  C16 [B 200 ] =  108.110 deg =    2.494 A
 ...
  O1  [B 200 ] -  C15 [B 200 ] -  O2  [B 200 ] =  121.547 deg =    2.183 A
 Nr of angles : (         30) 

 Dihedrals and 1-4 torsion distances
 ===================================
  C6  [B 200 ] -  C1  [B 200 ] -  C2  [B 200 ] -  C3  [B 200 ] =  -42.758 deg =    2.902 A
  C16 [B 200 ] -  C1  [B 200 ] -  C2  [B 200 ] -  C3  [B 200 ] = -162.723 deg =    3.847 A
 ...
  C13 [B 200 ] -  C14 [B 200 ] -  C15 [B 200 ] -  O2  [B 200 ] =  129.005 deg =    3.505 A
 Nr of dihedrals : (         32) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and ch m
 AND atom selection
 With atoms for which : (CH) 
 Equals : (M) 
 Selection history : (ALL | AND CHain = M |) 
 Nr of selected atoms : (         22) 
 MOLEMAN2 > ge
 Nr of selected atoms : (         22) 

 Bonded distances with cut-off :    2.000 A
 ==========================================
  C1  [M 602 ] -  O1  [M 602 ] =    1.410 A
  C1  [M 602 ] -  C2  [M 602 ] =    1.515 A
 ...
  O5  [M 603 ] -  C5  [M 603 ] -  C6  [M 603 ] -  O6  [M 603 ] =  -51.669 deg =    2.729 A
 Nr of dihedrals : (         43) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se all
 ...
 MOLEMAN2 > se and chain a
 ...
 MOLEMAN2 > se num and res 85 87
 ...
 MOLEMAN2 > geom
 Nr of selected atoms : (         12) 

 Bonded distances with cut-off :    2.000 A
 ==========================================
  CB  [A  86 ] -  CA  [A  86 ] =    1.521 A
  C   [A  86 ] -  O   [A  86 ] =    1.229 A
 ...
  CB  [A  87 ] -  CA  [A  87 ] -  C   [A  87 ] -  O   [A  87 ] =   86.999 deg =    3.216 A
 Nr of dihedrals : (         14) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ! - enter a comment

 Any command beginning with an exclamation mark will prompt the program to
   ignore that line.  This may be useful to annotate scripts which run
   MOLEMAN2.

 ## QUit - stop working with MOLEMAN2

 This will end you current session.

 ## $ - enter a shell command

 Syntax: $ shell_command

 Anything following the dollar sign is passed on to the operating system
   shell.  This can be used to list the files in a directory, or even
   to run another program from within MOLEMAN2.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > $ ls *.pdb
1cbs.pdb     1cel.pdb     hydro.pdb    q.pdb        twentyz.pdb
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## COnstants REset - reset program parameters to factory defaults

 This resets some of the program parameters to the values that I deemed
   reasonable.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > co re
 Reset program constants to defaults
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## COnstants LIst - list names and values of program parameters

 This lists the names of those parameters than can be modified by the
   user.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > co li
 BLIMLO = B-factor default minimum     : (   2.000) 
 BLIMHI = B-factor default maximum     : (  50.000) 
 QLIMLO = Occupancy default minimum    : (   0.000) 
 QLIMHI = Occupancy default maximum    : (   1.000) 
 MXCACA = Max connected CA-CA distance : (   4.500) 
 TORTOL = Torsion/improper tolerance   : (   5.000) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## COnstants SEt - set a program parameter value

 Syntax: COnstants SEt name value
 name   = parameter name
 value  = new value for this parameter

 This enables you to set the value of a program parameter.  Use the
   COnstants LIst option to see what parameters can be set in the
   current version of the program

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > co set tortol 10
 Set TORTOL to 10.000
 MOLEMAN2 > co set junk 103
 Set JUNK to 103.000
 ERROR --- Name not recognised
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## REad - read a PDB file

 Syntax: REad file [format] [hydro]
 file   = PDB file name
 format = Pdb | Alwyn
 hydro  = No  | Yes

 The Alwyn format is only required when you try to read *very* old PDB
   files created with older versions of O.
 By default, hydrogen atoms are *stripped* when you read a file, unless
   you set the hydro parameter to y(es) !
 Once the file has been read, some book-keeping is done.  By default,
   *all* atoms will be selected (including hydrogen atoms, if they
   were read) !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re 1cbs.pdb
 Reading from file : (1cbs.pdb) 
 in normal PDB format
 ignoring hydrogen atoms
 ==> Found file in GKPATH : (/nfs/pdb/full/1cbs.pdb) 
 HEADER :     RETINOIC-ACID TRANSPORT                 28-SEP-94   1CBS      1CBS   2
 AUTHOR :     G.J.KLEYWEGT,T.BERGFORS,T.A.JONES                             1CBS  10
 REVDAT :    1   26-JAN-95 1CBS    0                                        1CBS  11
 CRYST1 :    45.650   47.560   77.610  90.00  90.00  90.00 P 21 21 21    4  1CBS 216

 >>>>> END card encountered <<<<<

 Nr of lines read : (       1459) 
 Nr of hydrogens skipped : (          0) 

 Total nr of residues      : (        238) 
 Nr of amino acid residues : (        137) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (        100) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          1) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...

 Checking "special" positions (X~Y~Z), Bs and Qs ...
 No suspicious coordinates encountered
 All atoms have B <= 100 A2
 All atoms have B >= 2.0 A2
 All atoms have Q <= 1.0
 All atoms have Q >= 0.01
 No atoms with ANISOU cards

 Nr of atoms now : (       1213) 
 Nr of residues  : (        238) 
 Select ALL atoms
 Selection history : (ALL |) 
 Nr of selected atoms : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## APpend - append a structure to the one(s) already in memory

 Syntax: APpend file [format] [hydro]

 Same parameters etc. as for the REad command.  Book-keeping is done
   again, and *all* atoms are selected.

 ## WRite - write a PDB file

 Syntax: WRite file [format] [which]
 file   = PDB file name
 format = Pdb | Xplor | Ccp4
 which  = ALl | NO_hydro | SElected | PAla |
          PGly | PSer | CAlpha

 Write (a subset of) the current atoms to a PDB file.  You must 
   provide the name of the output file.  If the file already exists,
   an error message is generated and you are asked if you want to
   overwrite it ("Open file as OLD (Y/N) ?").  If you don't, you
   can subsequently supply a different file name.

 If the format is Pdb, then all records (including any REMARKS etc.)
   will be written, and atoms which were on HETATM cards on input
   will be on HETATM cards on output.  Cell constants etc. are also
   included.

 If the format is Xplor, only ATOM records will be written (even for
   HETATMs), and nothing else (no CRYST1, etc.).

 If the format is Ccp4, the same is written as for Xplor format, but
   in addition the CRYST1 etc. cards will added at the top of the file.

 You can specify which atoms you want to write out:
 - ALl writes all atoms currently in memory
 - NO_hydro writes all non-hydrogen atoms
 - SElected writes only the currently selected atoms (if any)
 - PGly creates a poly-Glycine file (i.e., only main-chain atoms of
   protein residues and all residues will be called GLY; the program
   recognizes main-chain atoms by their atom names or by the fact
   that they have been labelled as such in the library file)
 - PAla generates a poly-Alanine file in a similar fashion
 - PSer generates a poly-Serine file (in which atoms CG, OG, SG,
   OG1 and CG1 will be called OG)
 - CAlpha writes only the C-alpha atoms of protein residues

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > wr q.pdb p se
 Output PDB file : (q.pdb) 
 Format : (Pdb) 
 Atoms  : (SE) 
 Number of atoms to write : (       3220) 
 Nr of atoms written : (       3220) 
 Nr of lines written : (       3705) 

 CPU total/user/sys :       1.0       1.0       0.0
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > wr q.pdb ccp pser
 Output PDB file : (q.pdb) 
 Format : (CCP) 
 Atoms  : (PSER) 
 ERROR --- XOPXNA - error # 126 while opening NEW file : q.pdb
 OPEN : (UNIT= 10 STATUS=NEW CAR_CONTROL=LIST FORM=FORMATTED 
  ACCESS=SEQUENTIAL) 
 Error : (Connection timed out) 
 Open file as OLD (Y/N) ? (N) y
 Number of atoms to write : (       4952) 
 Nr of atoms written : (       4952) 
 Nr of lines written : (       4952) 

 CPU total/user/sys :       1.5       1.5       0.0
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SPlit - split a PDB file into one for each chain/segment

 Syntax: SPlit file_prefix

 This option is primarily intended for X-PLOR users.  As such, it removes
   much of the dread previously associated with the preparation of files
   for the GENERATE step.

 You provide the prefix for the PDB file names (e.g., /Usr/Billy/Xplor/m1
   or ../../xplor/m5tom6/m5 or ./m1).  Upper and lower case characters
   in the prefix will be maintained.  For each segment id found in the
   set of *ALL* atoms, a separate PDB file is written which contains
   all atoms which have that segment id (even if they are separated
   in the structure).  The name of this file will be your prefix plus
   an underscore (_) plus the segment id (converted to lowercase and
   without any spaces) plus the extension ".pdb".  For instance, if
   your prefix is "../Xplor/m1", then segment "PROA" will be written
   to a file called "../Xplor/m1_proa.pdb".

 In addition to all these PDB files, an X-PLOR input file is created
   for the GENERATE stage.  It will need some editing if your structure
   contains things other than protein and water (i.e.: insert topology
   and parameter file names; insert any patches that are necessary).
   The program will also look for any disulfide links and create
   DISU patch statements for each of these (if any).  Note that in
   the case of for instance iron-sulfur clusters you may have to
   remove (some of) the DISU patch statements !

 IMPORTANT: the segment id *ALONE* is used to identify different
   segments.  In other words: the chain names are ignored (this is
   in agreement with the current PDB convention in which segment
   identifiers designate separate entities; a chain may contain
   multiple segments, e.g. protein + glycosylation + ligand + water).

 NOTE: make sure that the segment ids make sense !!  If you just read
   in a PDB file from O or downloaded one from Brookhaven, you probably
   have to use one or more of the CHain commands (e.g., CHain ASk or
   CHain AUto) to get correct segmentation.  You have yourself to blame
   for any segmentation faults ;-)

 Since the program writes all atoms with a certain segment id to the
   same file (even if they are interspersed with other segments), you
   can use the CHain commands to "merge" two previously distinct segments
   into one.  For instance, if you have two-fold NCS, you may initially
   have refined only waters which obey the NCS and used separate segments
   for them (e.g., WATA and WATB).  When you start to add waters which
   are not conserved in both molecules, you could create a third segment
   but this tends to get very confusing as you add and delete waters
   while you rebuild.  Instead, you may want to merge all waters.  You
   can do this by simply giving all of them the same segment id with
   the CHain commands.

 NOTE: from version 0.21 onward, the program tries its best to make sure
   that OT1 and OT2 are named correctly.  Also, if an OT2 atom is
   missing it will be generated on the fly and written to the PDB file
   (but it will not be added to your structure in memory !).

 NOTE: from version 1.1.1 onward, the default is to delete hydrogen atoms
   and atoms with unknown coordinates.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re test.pdb
 ...
 MOLEMAN2 > ch au
 ...
 MOLEMAN2 > split qqq
 Split PDB files for X-PLOR
 File prefix : (qqq) 
 X-PLOR generate input file : (qqq_generate.inp) 

 File nr      1 Segment |AAAA| File name : qqq_aaaa.pdb
 ATOM     1  CB  SER A   4      51.238  19.799   7.294  1.00 34.72      AAAA
 Found & written OT1
 ... Adding OT2 at : (  39.097   17.619   13.212) 
 Nr of lines written : (        446) 
 Nr of atoms written : (        443) 

 File nr      2 Segment |AAAB| File name : qqq_aaab.pdb
 ATOM   483  N   ASN B  66      26.962  19.074  20.708  1.00  2.00      AAAB
 Found & written OT1
 Found & written OT2
 Nr of lines written : (       3747) 
 Nr of atoms written : (       3744) 

 File nr      3 Segment |AAAC| File name : qqq_aaac.pdb
 ATOM  4227  CB  THR C   1      -3.115   5.872  13.814  1.00 77.65      AAAC
 Found & written OT1
 ... Adding OT2 at : (   1.912   19.586   15.804) 
 Nr of lines written : (        467) 
 Nr of atoms written : (        464) 

 File nr      4 Segment |AAAD| File name : qqq_aaad.pdb
 ATOM  4691  O1  HOH D 701      -6.674  -2.991  11.360  1.00 15.26      AAAD
 Nr of lines written : (         39) 
 Nr of atoms written : (         36) 

 File nr      5 Segment |AAAE| File name : qqq_aaae.pdb
 ATOM  4727 ZN+2 ZNC E 901     -15.390  36.554  20.084  1.00 19.82      AAAE
 Nr of lines written : (          5) 
 Nr of atoms written : (          2) 

 File nr      6 Segment |AAAF| File name : qqq_aaaf.pdb
 ATOM  4729  C1  NAG F 990      39.707  11.948  13.548  1.00 77.90      AAAF
 Nr of lines written : (         17) 
 Nr of atoms written : (         14) 

 Nr of PDB files generated : (          6) 

 Looking for disulfides ...
 Looking for CYS- SG  atoms ...
 ATOM   496  SG  CYS B  67      26.853  23.275  24.788  1.00 18.16      AAAB
 ATOM   719  SG  CYS B  94      27.958  21.920  25.822  1.00  2.00      AAAB
 ATOM  1765  SG  CYS B 231      17.706  42.764  23.358  1.00  2.00      AAAB
 ATOM  1944  SG  CYS B 254      15.900  18.643  43.219  1.00 14.44      AAAB
 ATOM  2032  SG  CYS B 265      17.033  17.112  43.932  1.00 13.67      AAAB
 ATOM  3118  SG  CYS B 402      11.202  50.463  20.218  1.00 17.06      AAAB
 ATOM  4105  SG  CYS B 521      12.171  51.649  18.881  1.00  2.00      AAAB
 ATOM  4247  SG  CYS C   3      -0.622   9.196  15.268  1.00 34.29      AAAC
 ATOM  4355  SG  CYS C  17       1.031   6.187  17.911  1.00 53.34      AAAC
 ATOM  4388  SG  CYS C  22      -1.328   8.466  17.020  1.00 31.20      AAAC
 ATOM  4529  SG  CYS C  39       2.164   5.235  19.293  1.00 20.78      AAAC
 ATOM  4539  SG  CYS C  41      -5.604  11.002  25.701  1.00 52.29      AAAC
 ATOM  4620  SG  CYS C  52      -4.745  12.199  24.311  1.00 29.91      AAAC
 ATOM  4626  SG  CYS C  53      -4.229  13.247  16.868  1.00 42.61      AAAC
 ATOM  4669  SG  CYS C  59      -4.012  11.998  15.283  1.00 12.80      AAAC
 Nr of CYS SG atoms : (         15) 
 Max SG-SG distance for link : (   2.200) 
 Disulfide #    1    67 AAAB <->    94 AAAB @   2.03 A
 Disulfide #    2   254 AAAB <->   265 AAAB @   2.03 A
 Disulfide #    3   402 AAAB <->   521 AAAB @   2.03 A
 Disulfide #    4     3 AAAC <->    22 AAAC @   2.03 A
 Disulfide #    5    17 AAAC <->    39 AAAC @   2.02 A
 Disulfide #    6    41 AAAC <->    52 AAAC @   2.03 A
 Disulfide #    7    53 AAAC <->    59 AAAC @   2.03 A
 Nr of disulfides : (          7) 

 X-PLOR generate input file written
 CPU total/user/sys :       1.5       1.4       0.1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The PDB files may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
REMARK Created by MOLEMAN2 V. 960227/0.8 at Tue Feb 27 15:29:35 1996 for user gerard
REMARK File name : m1_aaaa.pdb
ATOM      1  CB  ALA    86       3.109  42.928  53.312  1.00 28.54      AAAA
ATOM      2  C   ALA    86       4.129  45.032  52.428  1.00 27.90      AAAA
 ...
ATOM   3319  OT1 LEU   447      38.267  47.693  63.602  1.00 18.65      AAAA
ATOM   3320  OT2 LEU   447      39.049  46.653  65.371  1.00 20.12      AAAA
REMARK Nr of atoms in file : 2740
END   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The GENERATE input file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 remarks File m1_generate.inp - generate pdb/psf file
 remarks Created by MOLEMAN2 V. 960227/0.8 at Tue Feb 27 15:29:35 1996 for user gerard

 topology
   @tophcsdx.pro
   @toph19.sol
   { add more topology files here }
 end

 parameter
   @parhcsdx.pro
   @param19.sol
   { add more parameter files here }

   nbonds
     atom cdie shift eps=8.0  e14fac=0.4
     cutnb=7.5 ctonnb=6.0 ctofnb=6.5
     nbxmod=5 vswitch wmin=0.5
   end
   { dielectric constant set to 8.0 (EPS) }
   { close contacts printed only if dist < 0.5 A (WMIN) }
 end

 { protein }
 segment name="AAAA"
   chain @toph19.pep
     coordinates @m1_aaaa.pdb
   end
 end
 vector do (name="CD1") ( name CD and resname ile )
 coordinates @m1_aaaa.pdb

 { CARB }
 segment name="BBBB"
   chain
     coordinates @m1_bbbb.pdb
   end
 end
 coordinates @m1_bbbb.pdb

 { HETE }
 segment name="CCCC"
   chain
     coordinates @m1_cccc.pdb
   end
 end
 coordinates @m1_cccc.pdb

 { protein }
 segment name="KKKK"
   chain @toph19.pep
     coordinates @m1_kkkk.pdb
   end
 end
 vector do (name="CD1") ( name CD and resname ile )
 coordinates @m1_kkkk.pdb

 { CARB }
 segment name="LLLL"
   chain
     coordinates @m1_llll.pdb
   end
 end
 coordinates @m1_llll.pdb

 { HETE }
 segment name="MMMM"
   chain
     coordinates @m1_mmmm.pdb
   end
 end
 coordinates @m1_mmmm.pdb

 { META }
 segment name="XXXX"
   chain
     coordinates @m1_xxxx.pdb
   end
 end
 coordinates @m1_xxxx.pdb

 { WATE }
 segment name="WWWW"
   chain
     coordinates @m1_wwww.pdb
   end
 end
 coordinates @m1_wwww.pdb

 { the disulfides }
 patch DISU
   refer=1=(segid="AAAA" and resid          176)
   refer=2=(segid="AAAA" and resid          235)
 end

 patch DISU
   refer=1=(segid="AAAA" and resid          368)
   refer=2=(segid="AAAA" and resid          415)
 end

 patch DISU
   refer=1=(segid="KKKK" and resid          176)
   refer=2=(segid="KKKK" and resid          235)
 end

 patch DISU
   refer=1=(segid="KKKK" and resid          368)
   refer=2=(segid="KKKK" and resid          415)
 end

 flags exclude vdw elec end

 hbuild
   selection=(hydrogen and not known)
   phistep=45
 end

 { optimise hydrogens to get rid of clashes }
 constraints fix=( not hydrogen ) end
 flags include vdw elec end
 minimize powell nstep=50 end
 constraints fix=( not all ) end

 write coordinates output=m1_gen.pdb end

 write structure output=m1.psf end

 stop
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DELETE_molecule - remove all atoms from memory

 This command (of which the first SIX letters should be typed - to
   prevent accidental deletion) removes all atoms from memory.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > dele
 ERROR --- Invalid command
 ==> (dele) 
 MOLEMAN2 > delete
 ALL ATOMS AND RESIDUES DELETED !!!
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** PDB COMMANDS

 ## PDb HEtero - manipulate ATOM/HETATM flags

 You have the following options with this command:
 - Atom_all; this will change all HETATMs to ATOMs (useful if you
   want to use a model from the PDB for molecular replacement or
   refinement with a program that chokes on or ignores HETATM cards);
 - Deduce; the program will set all protein and nucleic acid atoms
   to ATOM, and all others to HETATM (useful when you deposit your
   model coordinates with the PDB).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pd he a
 All atoms set to type ATOM
 MOLEMAN2 > pd he d
 Deducing ATOM/HETATM types ...
 Nr set to ATOM   : (       4952) 
 Nr set to HETATM : (          0) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb NO_atom_numbers - remove O-style atom numbers

 O likes to write the chemical element number of each atom/hetatm,
   but the PDB does not like them.  Use this command to remove them.

 ## PDb CRystal - set crystal parameters for CRYST1 etc. cards

 Supply the six cell constants, the number of molecules in the unit
   cell (using the PDB definition), and the spacegroup symbol (using
   the PDB definition, i.e. with spaces).  The cell constants *must*
   be known for CCP4-type PDB files !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pd cr 84 84 111.8 90 90 90 8 "P 21 21 2"
 Unit-cell axes (A)      : (  84.000   84.000  111.800) 
 Unit-cell angles (deg)  : (  90.000   90.000   90.000) 
 Unit-cell volume (A3)   : (  7.889E+05) 
 Nr of molecules in cell : (       8) 
 Spacegroup symbol       : (P 21 21 2) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb crys 41.2 41.2 196.5 90 90 90
 Nr of molecules in cell ? (       8) 
 Spacegroup symbol ? (P 21 21 2) P 41 21 2
 Unit-cell axes (A)      : (  41.200   41.200  196.500) 
 Unit-cell angles (deg)  : (  90.000   90.000   90.000) 
 Unit-cell volume (A3)   : (  3.335E+05) 
 Nr of molecules in cell : (       8) 
 Spacegroup symbol       : (P 41 21 2) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb SSbond - manipulate SSBOND records

 Syntax: PDb SSbond what
 what   = List | Delete | Generate

 Use the COnstants SEt command to change the cut-off S-S link distance if
   necessary.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb ssb lis
 List SSBOND records
 SSBOND   1 CYS A    4    CYS A   72                                     1CEL 340
 SSBOND   2 CYS A   19    CYS A   25                                     1CEL 341
 SSBOND   3 CYS A   50    CYS A   71                                     1CEL 342
 SSBOND   4 CYS A   61    CYS A   67                                     1CEL 343
 ...
 SSBOND  20 CYS B  261    CYS B  331                                     1CEL 359
 Nr of SSBOND records listed : (         20) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb ssb del
 Delete SSBOND records
 Nr of SSBOND records deleted : (         20) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb ssb gen
 Generate SSBOND records
 Looking for CYS- SG  atoms ...
 ATOM    25  SG  CYS A   4      36.618  67.989  34.228  1.00 21.90      1CEL 398
 ...
 ATOM  5990  SG  CYS B 331      -7.298   9.647  20.243  1.00 10.03      1CEL6363
 ATOM  6483  SG  CYS B 397     -25.330  24.877  13.503  1.00 10.62      1CEL6856
 Max SG-SG distance for link : (   2.200) 
 SSBOND   1 CYS A    4    CYS A   72     S-S =   2.03 A
 SSBOND   2 CYS A   19    CYS A   25     S-S =   2.02 A
 ...
 SSBOND  19 CYS B  238    CYS B  243     S-S =   2.03 A
 SSBOND  20 CYS B  261    CYS B  331     S-S =   2.03 A
 Nr of SSBOND records generated : (         20) 
 MOLEMAN2 > pdb ssb l 
 List SSBOND records
 SSBOND   1 CYS A    4    CYS A   72     S-S =   2.03 A
 SSBOND   2 CYS A   19    CYS A   25     S-S =   2.02 A
 SSBOND   3 CYS A   50    CYS A   71     S-S =   2.02 A
 ...
 SSBOND  19 CYS B  238    CYS B  243     S-S =   2.03 A
 SSBOND  20 CYS B  261    CYS B  331     S-S =   2.03 A
 Nr of SSBOND records listed : (         20) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb REmark - add a REMARK record

 Syntax: PDb REmark text
 text   = text of the remark

 Add information about the molecule(s) as a REMARK record (e.g., model
  name, current R-factor and Rfree, etc.).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb re "Model M3 @ 960303 R=0.231 Rfree=0.273"
 Add REMARK record : (Model M3 @ 960303 R=0.231 Rfree=0.273) 
     4: REMARK Model M3 @ 960303 R=0.231 Rfree=0.273
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb LIst_remark - list all REMARK records

 Syntax: PDb LIst_remark

 List the current set of REMARK records (if any).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb li
 List REMARK records
 Nr of REMARK records : (          4) 
     1: REMARK FILENAME="/nfs/gerard/gerard/proteins/cbh2/ibgx/xplor/m1_final_2.pdb"
     2: REMARK Uses *NO* sigma or amplitude cut-offs
     3: REMARK DATE:15-Jan-96  23:31:00       created by user: gerard
     4: REMARK Model M3 @ 960303 R=0.231 Rfree=0.273
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb DElete_remark - delete any or all REMARK records

 Syntax: PDb DElete_remark which
 which  = number of the REMARK record (* means ALL)

 Delete one or all REMARK records (if any).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb del 3
 Delete REMARK record nr: (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb NAme - change name of selected atoms or residues

 Syntax: PDb NAme which old new
 which  = Atom | Residue
 old    = old name to replace
 new    = new name

 Change the atom or residue name of selected atoms.  A residue is
   considered to be selected if at least one of its atoms is
   selected.

 This command can be used to rename all waters (e.g., from residue
   HOH with atom O1 to residue WAT and atom OW).  You can also write
   macros, for instance to convert residue and atom names for your
   favourite ligand or cofactor from/to X-PLOR or CCP4 or TNT or
   PDB or ... conventions.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel and type water
 ...
 MOLEMAN2 > pdb name res hoh wat
 Replace residue name |HOH| by |WAT|
 Nr of residues changed : (        100) 
 MOLEMAN2 > pdb name atom " o1 " " ow "
 Replace atom name | O1 | by | OW |
 Nr of atom names changed : (        100) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The following macro would convert X-PLOR waters into PDB waters:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 select all
 select and type water
 pdb name atom " o1 " " o  "
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb CHemical+charge - try to deduce chemical element and charge

 In the new PDB format definition, column 77-78 of each ATOM and HETATM
   record contains the symbol of the chemical element type of the atom
   and column 79-80 the charge (don't ask me why the charge has to fit
   inside two columns ...).  This command tries to deduce this information
   as best as it can, using information in the atom name (4 characters)
   field.

 Chemical element: the following four methods are tried in turn:
 (1) is it one of the special hydrogen names ?
 (2) are the first two characters of the atom name a valid element symbol ?
 (3) is a space plus the second character a valid element symbol ?
 (4) is a space plus the first character a valid element symbol ?
 (5) if none of the above, generate an error message, and use "??" as
     the element symbol

 Charge: the following are valid charge definitions for columns 3 and 4
   of the atom name, which will be recognised by the program (default
   charge otherwise is " 0"):
 (1) "++" or "--"
 (2) "+ " or " +" or "- " or " -"
 (3) "n+" or "+n" or "n-" or "-n", where n is 0,1,2,...,9

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb che
 Deriving chemical name and charge ...
 Nr of atoms processed    : (         10) 
 Unknown chemical element : (          0) 
 Nr of positive atoms     : (          7) 
 Nr of negative atoms     : (          3) 
 Nr uncharged or unknown  : (          0) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Example: the following bogus PDB file:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
HETATM 7039 CA++  CA K 440      40.443  57.977  83.935  1.00 16.86
HETATM 7039 CA2+  CA K 441      40.443  57.977  83.935  1.00 16.86
HETATM 7039 CA+2  CA K 442      40.443  57.977  83.935  1.00 16.86
HETATM 7039  S--  CA K 443      40.443  57.977  83.935  1.00 16.86
HETATM 7039  S-2  CA K 444      40.443  57.977  83.935  1.00 16.86
HETATM 7039  S2-  CA K 445      40.443  57.977  83.935  1.00 16.86
HETATM 7039 AH1+  CA K 446      40.443  57.977  83.935  1.00 16.86
HETATM 7039  H+   CA K 447      40.443  57.977  83.935  1.00 16.86
HETATM 7039 'H1+  CA K 448      40.443  57.977  83.935  1.00 16.86
HETATM 7039 HX +  CA K 449      40.443  57.977  83.935  1.00 16.86
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 gives the following result:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
HETATM 7039 CA++  CA A 440      40.443  57.977  83.935  1.00 16.86      AAAACA+2
HETATM 7039 CA2+  CA A 441      40.443  57.977  83.935  1.00 16.86      AAAACA+2
HETATM 7039 CA+2  CA A 442      40.443  57.977  83.935  1.00 16.86      AAAACA+2
HETATM 7039  S--  CA A 443      40.443  57.977  83.935  1.00 16.86      AAAA S-2
HETATM 7039  S-2  CA A 444      40.443  57.977  83.935  1.00 16.86      AAAA S-2
HETATM 7039  S2-  CA A 445      40.443  57.977  83.935  1.00 16.86      AAAA S-2
HETATM 7039 AH1+  CA A 446      40.443  57.977  83.935  1.00 16.86      AAAA H+1
HETATM 7039  H+   CA A 447      40.443  57.977  83.935  1.00 16.86      AAAA H+1
HETATM 7039 'H1+  CA A 448      40.443  57.977  83.935  1.00 16.86      AAAA H+1
HETATM 7039 HX +  CA A 449      40.443  57.977  83.935  1.00 16.86      AAAA H+1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb SAnity_check - sanity checks w.r.t. alternate locations and occupancies

 Syntax: PDb SAnity_check

 This command performs a number of sanity checks on your PDB file
   w.r.t. alternate locations and occupancies. Since alternate locations
   are often generated by manual editing of a PDB file, mistakes are
   easily made. This command will check for the following for each atom
   in your structure:

 - ERROR   - ALTERNATE LOCATION WITH BLANK LABEL
 - ERROR   - ALTERNATE LOCATIONS WITH IDENTICAL LABELS
 - ERROR   - ALTERNATE LOCATIONS IN IDENTICAL POSITIONS

 - WARNING - OCCUPANCIES DO NOT SUM TO 1.00
 - WARNING - SINGLE LOCATION WITH NON-BLANK LABEL
 - WARNING - MORE THAN 3 ALTERNATE LOCATIONS
 - WARNING - ALTERNATE LOCATIONS IN ALMOST IDENTICAL POSITIONS

 - NOTE    - LABELS NOT IN ALPHABETICAL ORDER
 - NOTE    - ALTERNATE LOCATIONS IN SIMILAR POSITIONS

 Note: the BOok_keep command provides additional sanity-related info,
   and the DIstance LIst command can be used to print a list of atoms
   that lie too close to each other in space (e.g., DIst LIst 0 1).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb san

 WARNING - OCCUPANCIES DO NOT SUM TO 1.00
           for the following atom, the occupancies of the   1
           alternate locations add up to  0.50 instead of
           1.00 (this can be okay if you are sure that the
           atom has partial occupancy, or if it lies in a
           special position, such as on a twofold axis):
 ATOM   845  CB  GLN A  53      74.460  37.771  14.755  0.50  7.15           C
[...]
 ERROR   - ALTERNATE LOCATIONS IN IDENTICAL POSITIONS
           the following two atoms have alternate locations
           but their distance is only  0.03 A, suggesting
           that they are in identical positions in space and
           should be merged into a single location:
 ATOM  1245  CA ALYS A  78      73.331  23.163  -7.825  0.50 12.88           C
 ATOM  1246  CA BLYS A  78      73.311  23.144  -7.841  0.50 13.01           C

 WARNING - ALTERNATE LOCATIONS IN ALMOST IDENTICAL POSITIONS
           the following two atoms have alternate locations
           but their distance is only  0.10 A, suggesting
           that they are in almost identical positions in
           space and could be merged into a single location:
 ATOM  1249  CB ALYS A  78      73.945  24.503  -7.388  0.50 12.63           C
 ATOM  1250  CB BLYS A  78      73.881  24.510  -7.464  0.50 12.88           C

 NOTE    - ALTERNATE LOCATIONS IN SIMILAR POSITIONS
           the following two atoms have alternate locations
           and their distance is  0.32 A, suggesting that
           they are in similar positions in space and could
           perhaps be merged into a single location:
 ATOM  1255  CG ALYS A  78      74.081  25.533  -8.510  0.50 12.41           C
 ATOM  1256  CG BLYS A  78      74.263  25.347  -8.691  0.50 13.05           C
[...]

 WARNING - OCCUPANCIES DO NOT SUM TO 1.00
           for the following atom, the occupancies of the   1
           alternate locations add up to  0.50 instead of
           1.00 (this can be okay if you are sure that the
           atom has partial occupancy, or if it lies in a
           special position, such as on a twofold axis):
 ATOM  7694  O  AHOH S  64      70.295  19.056   5.753  0.50  2.05           O

 WARNING - SINGLE LOCATION WITH NON-BLANK LABEL
           the following atom has only one location, but its
           alternate location label is "A" instead of
           blank (this can be okay in some cases, e.g. for
           waters that only interact with one of a set of
           alternative conformations of an amino acid
           residue):
 ATOM  7694  O  AHOH S  64      70.295  19.056   5.753  0.50  2.05           O
[...]
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb SEqres - generate quick'n'dirty SEQRES records

 Syntax: PDb SEqres

 This command generates a set of SEQRES records for every chain that
   contains amino acids or nucleic acids. Note that, by necessity,
   this command does NOT know if your model contains all residues
   of the molecule(s) that you crystallised. If this is NOT the
   case (e.g., if tags are missing, or loop residues, or terminal
   residues), then the SEQRES records do NOT contain the information
   they are supposed to contain and, hence, can NOT be used for
   deposition purposes !!!

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read 1cbs.pdb
 [...]
 MOLEMAN2 > pdb seq
 Generating quick-n-dirty SEQRES records ...
 Add REMARK record : (Quick-n-dirty SEQRES records) 
   183: REMARK Quick-n-dirty SEQRES records
 Chain IDs found : ( ) 

 Chain ID : ( ) 
 Nr of residues : (        137) 
 Nr of SEQRES records : (         11) 
 MOLEMAN2 > wr qq.pdb
 [...]
 MOLEMAN2 > $ grep SEQRES qq.pdb
 Spawn system command : (  grep SEQRES qq.pdb) 
REMARK Quick-n-dirty SEQRES records
SEQRES   1    137  PRO ASN PHE SER GLY ASN TRP LYS ILE ILE ARG SER GLU  1CBS 202
SEQRES   2    137  ASN PHE GLU GLU LEU LEU LYS VAL LEU GLY VAL ASN VAL  1CBS 203
SEQRES   3    137  MET LEU ARG LYS ILE ALA VAL ALA ALA ALA SER LYS PRO  1CBS 204
SEQRES   4    137  ALA VAL GLU ILE LYS GLN GLU GLY ASP THR PHE TYR ILE  1CBS 205
SEQRES   5    137  LYS THR SER THR THR VAL ARG THR THR GLU ILE ASN PHE  1CBS 206
SEQRES   6    137  LYS VAL GLY GLU GLU PHE GLU GLU GLN THR VAL ASP GLY  1CBS 207
SEQRES   7    137  ARG PRO CYS LYS SER LEU VAL LYS TRP GLU SER GLU ASN  1CBS 208
SEQRES   8    137  LYS MET VAL CYS GLU GLN LYS LEU LEU LYS GLY GLU GLY  1CBS 209
SEQRES   9    137  PRO LYS THR SER TRP THR ARG GLU LEU THR ASN ASP GLY  1CBS 210
SEQRES  10    137  GLU LEU ILE LEU THR MET THR ALA ASP ASP VAL VAL CYS  1CBS 211
SEQRES  11    137  THR ARG VAL TYR VAL ARG GLU                          1CBS 212
SEQRES   1    137  PRO ASN PHE SER GLY ASN TRP LYS ILE ILE ARG SER GLU
SEQRES   2    137  ASN PHE GLU GLU LEU LEU LYS VAL LEU GLY VAL ASN VAL
SEQRES   3    137  MET LEU ARG LYS ILE ALA VAL ALA ALA ALA SER LYS PRO
SEQRES   4    137  ALA VAL GLU ILE LYS GLN GLU GLY ASP THR PHE TYR ILE
SEQRES   5    137  LYS THR SER THR THR VAL ARG THR THR GLU ILE ASN PHE
SEQRES   6    137  LYS VAL GLY GLU GLU PHE GLU GLU GLN THR VAL ASP GLY
SEQRES   7    137  ARG PRO CYS LYS SER LEU VAL LYS TRP GLU SER GLU ASN
SEQRES   8    137  LYS MET VAL CYS GLU GLN LYS LEU LEU LYS GLY GLU GLY
SEQRES   9    137  PRO LYS THR SER TRP THR ARG GLU LEU THR ASN ASP GLY
SEQRES  10    137  GLU LEU ILE LEU THR MET THR ALA ASP ASP VAL VAL CYS
SEQRES  11    137  THR ARG VAL TYR VAL ARG GLU
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb INdonesia - generate quick'n'dirty HELIX and SHEET records

 Syntax: PDb INdonesia
 (Alternatively: PDb FArout)

 This command uses the YASSPA-determined secondary structure assignment
   to generate quick'n'dirty secondary structure records (HELIX and
   SHEET). Save the molecule to a new PDB file to get these records.
   The new PDB file can then subsequently be read by Indonesia
   (which used to be called "FarOut" once upon a time). The records
   are used by Indonesia to increase the gap penalties in regions
   of secondary structure when you align sequences to it.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pdb far
 Generating quick-n-dirty HELIX and SHEET records ...
 Add REMARK record : (YASSPA quick-n-dirty HELIX and SHEET records) 
   232: REMARK YASSPA quick-n-dirty HELIX and SHEET records
 Record : (SHEET    1   1 1 THR A   2  PRO A   5  0) 
 Record : (HELIX    1   1 ILE A    7  ARG A   17  1) 
 Record : (HELIX    2   2 ALA A   27  TYR A   29  1) 
 Record : (SHEET    2   2 1 CYS A  32  ILE A  35  0) 
 Record : (SHEET    3   3 1 THR A  39  PRO A  41  0) 
 Record : (HELIX    3   3 GLY A   42  TYR A   44  1) 
 Nr of HELIX records : (          3) 
 Nr of SHEET records : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PDb FArout - generate quick'n'dirty HELIX and SHEET records

 This is the old name of the PDb INdonesia command (quod vide).

 ## PDb NUmber - renumber selected residues

 Syntax: PDb NUmber first_new

 Renumber the selected residues, starting from the given number.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and typ water
 AND atom selection
 With atoms for which : (TYP) 
 Equals : (WATER) 
 Selection history : (ALL | AND TYpe = WATE |) 
 Nr of selected atoms : (        100) 
 MOLEMAN2 > pdb numb 501
 Renumber selected residues starting at : (        501) 
 Nr of last changed residue : (        600) 
 Nr of residues changed : (        100) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** SELECTION COMMANDS

 These commands enable you to define a subset of atoms for which one or
   more operations have to be carried out.  You can use this, for example,
   to get statistics about the temperature factors of all protein main-chain
   atoms in segment ABC3, or to set the occupancy of all calcium atoms
   to 0.5.

 Some selection commands reset the selections (ALl, NOne, HYdrogen, and
   EXhydrogen).  Others make it narrower (ANd), wider (OR) or invert the
   current selection (NEgate).

 Examples:
 - to select the non-hydrogen atoms of all segments except QQQQ, use:
   SElect HYdrogen, SElect OR SEgid QQQQ, SElect NEgate
 - to select all non-hydrogen main-chain protein atoms of chain A, use:
   SElect EXhydro, SElect ANd TYpe PROT, SElect ANd CLass Main,
   SElect ANd CHain A
 - to select all non-hydrogen protein atoms, use: SElect EXhydro,
   SElect ANd TYpe PROT
 - to select all non-hydrogen protein and nucleic acid atoms, use:
   SElect EXhydro, SElect ANd TYpe PROT, SElect OR TYpe NUCL

 The program keeps a record of the SElection commands executed since the
   last time a resetting command was carried out.  For instance, after
   selecting all non-hydrogen main-chain protein atoms, you will see:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ?
 Selection history : (NON-HYDROGEN | AND TYpe = PROT | AND CLass = MAI |) 
 Nr of selected atoms : (        548) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect ? - list number and type of currently selected atoms.

 The number of selected atoms is shown with a history of the recently
   executed SElect commands.

 ## SElect ALl - select all atoms

 This selects all atoms, including any hydrogen atoms.

 ## SElect NOne - select none of the atoms

 This de-selects all atoms.

 ## SElect NEgate - invert current selection

 All atoms which had previously been selected will be de-selected, and
   the other way around.

 ## SElect HYdrogen - select all hydrogen atoms

 No non-hydrogen atoms will be selected.

 ## SElect EXhydrogen - select all non-hydrogen atoms

 No hydrogen atoms will be selected.

 ## SElect BY_residue - select entire residue if at least one atom selected

 If at least one atom of a residue has been selected, all atoms of the
   residue will be selected.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and res rea
 ...
 Nr of selected atoms : (         22) 
 MOLEMAN2 > se dist 0 3.5
 ...
 Nr of selected atoms : (         29) 
 MOLEMAN2 > se by
 Select by residue
 Selection history : (ALL | AND REsidu = REA | DIstance  0.00  3.50 | 
  BY_residue |) 
 Nr of selected atoms : (         55) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect POint - select atoms a certain distance from a point in 3D space

 This can be used to select all atoms that lie in a distance shell from
   any given point in 3D space. In the following example, the SElect
   POint command is used (with others) to select the atoms of all
   protein residues that have at least one atom that lies within 4 \A
   from either the manganese or the chloride ion in PDB entry 2CHR
   and to write them to a small PDB file:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read pdb2chr.ent
[...]
 MOLEMAN2 > select all
[...]
 MOLEMAN2 > select point and 28.850  50.835  90.295 0 4
 Point (A) : (  28.850   50.835   90.295) 
 Minimum distance (A) : (   0.000) 
 Maximum distance (A) : (   4.000) 
 Selection history : (ALL | AND POint_distance |) 
 Nr of selected atoms : (         13) 
 MOLEMAN2 > list
 List first selected atom of every residue
 ATOM  1459  CG  ASP   194      29.827  52.252  93.077  1.00 18.37      2CHR1601
 ATOM  1663  CG  GLU   220      32.533  50.136  90.995  1.00 18.18      2CHR1805
 ATOM  1859  CB  ASP   245      30.976  50.114  87.466  1.00 23.09      2CHR2001
 ATOM  1870  OE1 GLU   246      29.942  53.433  87.548  1.00  7.93      2CHR2012
 ATOM  2789 MN    MN   400      28.850  50.835  90.295  1.00  9.21      2CHR2931
 ATOM  2790 CL    CL   500      26.076  49.901  90.673  1.00  2.00      2CHR2932
 Nr of residues listed : (          6) 
 MOLEMAN2 > select point or  26.076  49.901  90.673 0 4
 Point (A) : (  26.076   49.901   90.673) 
 Minimum distance (A) : (   0.000) 
 Maximum distance (A) : (   4.000) 
 Selection history : (ALL | AND POint_distance | OR POint_distance |) 
 Nr of selected atoms : (         17) 
 MOLEMAN2 > select by_residue
 Select by residue
 Selection history : (ALL | AND POint_distance | OR POint_distance | 
  BY_residue |) 
 Nr of selected atoms : (         77) 
 MOLEMAN2 > select and type protein
 AND atom selection
 With atoms for which : (TYPE) 
 Equals : (PROTEIN) 
 Selection history : (ALL | AND POint_distance | OR POint_distance | 
  BY_residue | AND TYpe = PROT |) 
 Nr of selected atoms : (         75) 
 MOLEMAN2 > write mncl.pdb pdb selected
 Output PDB file : (mncl.pdb) 
 Format : (Pdb) 
 Atoms  : (SELECTED) 
 Number of atoms to write : (         75) 
 Nr of atoms written : (         75) 
 Nr of lines written : (        224) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect DIst - select atoms a certain distance from the current selection

 This can be used to select, e.g. a ligand, and subsequently all atoms
   within 3.5 or 4 \A from this compound.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and res rea
 ...
 Nr of selected atoms : (         22) 
 MOLEMAN2 > se dist 0 3.5
 ...
 Nr of selected atoms : (         29) 
 MOLEMAN2 > se by
 Select by residue
 Selection history : (ALL | AND REsidu = REA | DIstance  0.00  3.50 | 
  BY_residue |) 
 Nr of selected atoms : (         55) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect ANd - make a selection narrower

 Syntax: SElect ANd what which
 what   = CHain | SEgid | TYpe | CLass |
          REsidue | ATom
 which  = which chain, segid, etc. to use
          type can prot, nucl, wate, etc.
          class can be main or side chain
          residue can be Ala, HOH, BGL etc.
          atom can be " CA ", " O1 " etc.

 This can be used to select by chain name (one character), segment name
   (4 characters), type (any of PROT, NUCL, WATE, META, INOR, CARB, ORGA
   or HETE; 4 characters), or class (main or side chain, one character).
   Alternatively, you can select by residue type (Ala, Asn, etc.) or
   by atom name (enclose in "double quotes").  Note that atom names
   are 4 characters (e.g., use " CA " to select C-alpha atoms).

 The new selection will be those atoms that were already selected AND
   satisfy the new criterion.  This usually reduces the selection.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       1213) 
 MOLEMAN2 > se an ty prot
 AND atom selection
 With atoms for which : (TY) 
 Equals : (PROT) 
 Selection history : (NON-HYDROGEN | AND TYpe = PROT |) 
 Nr of selected atoms : (       1091) 
 MOLEMAN2 > se and cl main
 AND atom selection
 With atoms for which : (CL) 
 Equals : (MAIN) 
 Selection history : (NON-HYDROGEN | AND TYpe = PROT | AND CLass = MAIN |) 
 Nr of selected atoms : (        548) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       5794) 
 MOLEMAN2 > se an resi trp
 AND atom selection
 With atoms for which : (RESI) 
 Equals : (TRP) 
 Selection history : (NON-HYDROGEN | AND REsidu = TRP |) 
 Nr of selected atoms : (        280) 
 MOLEMAN2 > se and at " CA "
 AND atom selection
 With atoms for which : (AT) 
 Equals : ( CA) 
 Selection history : (NON-HYDROGEN | AND REsidu = TRP | AND ATom = CA |) 
 Nr of selected atoms : (         20) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect BUtnot - make a selection narrowes

 Syntax: SElect BUtnot what which
 what   = CHain | SEgid | TYpe | CLass |
          REsidue | ATom
 which  = which chain, segid, etc. to use
          type can prot, nucl, wate, etc.
          class can be main or side chain
          residue can be Ala, HOH, BGL etc.
          atom can be " CA ", " O1 " etc.

 Analogous to SElect ANd and SElect OR.

 The new selection will be those atoms that were already selected AND
   do NOT satisfy the new criterion.  This usually narrows the selection.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel but type prot 
 BUtnot atom selection
 With atoms for which : (TYPE) 
 Equals : (PROT) 
 Selection history : (ALL | BUTNOT TYpe = PROT |) 
 Nr of selected atoms : (        906) 
  ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect OR - make a selection wider

 Syntax: SElect OR what which
 what   = CHain | SEgid | TYpe | CLass |
          REsidue | ATom
 which  = which chain, segid, etc. to use
          type can prot, nucl, wate, etc.
          class can be main or side chain
          residue can be Ala, HOH, BGL etc.
          atom can be " CA ", " O1 " etc.

 This can be used to select by chain name (one character), segment name
   (4 characters), type (any of PROT, NUCL, WATE, META, INOR, CARB, ORGA
   or HETE; 4 characters), or class (main or side chain, one character).
   Note that atom names are 4 characters (e.g., use " CA " to select
   C-alpha atoms).

 The new selection will be those atoms that were already selected OR
   satisfy the new criterion.  This usually increases the selection.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       1213) 
 MOLEMAN2 > se and type prot
 AND atom selection
 With atoms for which : (TYPE) 
 Equals : (PROT) 
 Selection history : (NON-HYDROGEN | AND TYpe = PROT |) 
 Nr of selected atoms : (       1091) 
 MOLEMAN2 > se or type water
 OR atom selection
 With atoms for which : (TYPE) 
 Equals : (WATER) 
 Selection history : (NON-HYDROGEN | AND TYpe = PROT | OR TYpe = WATER |) 
 Nr of selected atoms : (       1191) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SElect NUmeric - select using numerical properties

 Syntax: SElect NUmeric and_or what lo hi
 and_or = And | Or | Butnot
 what   = Residue_nr | B-factor | Occupancy | 
          X-coord | Y-coord | Z-coord |
          Mass | Element | Covalent_bond_radius
 lo     = minimum value to select
 hi     = maximum value to select

 Make a selection wider or narrow using numerical properties.  This can
   be used to select a zone of residues (e.g., SEl NUm And Res 23 38),
   all atoms with high B-factors (SEl NUm And Bfac 50 9999), non-zero
   occupancy (SEl NUm And Occ 0.0 0.9999), etc.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel num and res 50 50
 Select Numeric : ( AND Residue_nr 50 50) 
 Selection history : (ALL | AND Residue_nr 50 50 |) 
 Nr of selected atoms : (         11) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel all
 Select ALL atoms
 Selection history : (ALL |) 
 Nr of selected atoms : (       7038) 
 MOLEMAN2 > sel num and mass 40 999
 Select Numeric : ( AND Mass 40.00000 999.0000) 
 Selection history : (ALL | AND Mass 40.00000 999.0000 |) 
 Nr of selected atoms : (          3) 
 MOLEMAN2 > lis 
 List first selected atom of every residue
 ATOM  3244  I   IBZ A 436      19.199  55.708  63.367  1.00 38.03      1CEL3617
 ATOM  6763  I   IBZ B 436     -19.688  12.428   7.328  1.00 32.65      1CEL7136
 ATOM  7039 CA    CA   440      40.443  57.977  83.935  1.00 16.86      1CEL7412
 Nr of residues listed : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel all
 ...
 MOLEMAN2 > se num and bfac 50 9999
 Select Numeric : ( AND B-factor 50.00000 9999.000) 
 Selection history : (ALL | AND B-factor 50.00000 9999.000 |) 
 Nr of selected atoms : (          8) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** B-FACTOR AND OCCUPANCY COMMANDS

 ## BFactor STats - statistics concerning B-factors of selected atoms

 Syntax: BFactor STats [how]
 how    = Chain | Type

 Lists statistics for the B-factors of all selected atoms, either split
   up by chain or by type.  For example, to get B-factor statistics
   for all non-hydrogen atoms by chain, use:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       7038) 
 MOLEMAN2 > bf st c
 Chain name      Atoms       Bave       Bsdv       Bmin       Bmax
   A<->1CEL       3518      18.70       8.58       5.31      66.29
   B<->1CEL       3518      17.23       8.68       5.91      67.75
    <->1CEL          2      24.27       7.41      16.86      31.68
 Nr of chains encountered  : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Ditto, but by type:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf st ty
       Type      Atoms       Bave       Bsdv       Bmin       Bmax
       PROT       6440      17.14       8.06       5.31      67.75
       WATE        529      27.65       9.99       7.05      55.30
       CARB         50      20.91       5.42      12.52      34.04
       HETE         19      21.67       6.61       8.66      38.03
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 To get information for only the main-chain protein atoms of chain A, use:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sel ex
 MOLEMAN2 > se and ty prot
 MOLEMAN2 > se and ch a
 MOLEMAN2 > sel an cl mai
 AND atom selection
 With atoms for which : (CL) 
 Equals : (MAI) 
 Selection history : (NON-HYDROGEN | AND TYpe = PROT | AND CHain = A | AND 
  CLass = MAI |) 
 Nr of selected atoms : (       1736) 
 MOLEMAN2 > bf st ty
       Type      Atoms       Bave       Bsdv       Bmin       Bmax
       PROT       1736      17.02       6.61       6.97      53.21
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Don't forget to *explicitly* exclude any hydrogen atoms you may have !

 ## OCcupancy STats - statistics concerning occupancies of selected atoms

 Syntax: OCcupancy STats [how]
 how    = Chain | Type

 Lists statistics for the occupancies of all selected atoms, either split
   up by chain or by type.  See the BFactor STats command for examples.

 Don't forget to *explicitly* exclude any hydrogen atoms !

 ## BFactor NO_anisou - delete all ANISOUs (if any)

 This command will remove all ANISOUs (if any are present; otherwise
   nothing will happen).

 ## BFactor LImit - set or limit B-factors of selected atoms

 Syntax: BFactor LImit lo hi

 Reset all B-factors less than "lo" to a value of "lo", and all those greater
   than "hi" to a value of "hi".  This can be used to reset very low and/or
   very high B-factors, or to reset all temperature factors.
 To reset very low B-factors: use a very high number for "hi" (e.g., 1000).
 To reset very high B-factors: use a negative number for "lo" (e.g., -1).
 To reset all B-factors, make "lo" equal to "hi".

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ex
 Select NON-HYDROGEN atoms
 Selection history : (NON-HYDROGEN |) 
 Nr of selected atoms : (       7038) 
 MOLEMAN2 > bf st c
 Chain name      Atoms       Bave       Bsdv       Bmin       Bmax
   A<->1CEL       3518      18.70       8.58       5.31      66.29
   B<->1CEL       3518      17.23       8.68       5.91      67.75
    <->1CEL          2      24.27       7.41      16.86      31.68
 Nr of chains encountered  : (          3) 
 MOLEMAN2 > bf li 10 50
 Reset B-factors to lie in range    10.00 to    50.00
 MOLEMAN2 > bf st c
 Chain name      Atoms       Bave       Bsdv       Bmin       Bmax
   A<->1CEL       3518      18.72       8.39      10.00      50.00
   B<->1CEL       3518      17.32       8.44      10.00      50.00
    <->1CEL          2      24.27       7.41      16.86      31.68
 Nr of chains encountered  : (          3) 
 MOLEMAN2 > bf li 18 18
 Reset B-factors to lie in range    18.00 to    18.00
 MOLEMAN2 > bf st c
 Chain name      Atoms       Bave       Bsdv       Bmin       Bmax
   A<->1CEL       3518      18.00       0.00      18.00      18.00
   B<->1CEL       3518      18.00       0.00      18.00      18.00
    <->1CEL          2      18.00       0.00      18.00      18.00
 Nr of chains encountered  : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## OCcupancy LImit - set or limit occupancies of selected atoms

 Syntax: OCcupancy LImit lo hi

 Reset all occupancies less than "lo" to a value of "lo", and all those greater
   than "hi" to a value of "hi".  This can be used to reset very low and/or
   very high occupancies, or to reset all occupancies.
 See the BFactor LImit command for further discussion and examples.

 ## BFactor PRod_plus - multiply/add B-factors of selected atoms

 Syntax: BFactor PRod_plus [prod] [plus]
 prod   = multiply selected Bs by this number (default 1.0)
 plus   = add this number to the selected Bs (default 0.0)

 This can be used to change the scale of temperature factors (e.g.,
   prior to molecular replacement with a room-temperature search
   model using new cryo data).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
 ...
   B-factor         16.622          9.305          3.920         54.210
 ...
 MOLEMAN2 > bf pr 0.6 2
 New B =     0.6000 * Old B +     2.0000
 Nr of atoms updated : (       1213) 
 MOLEMAN2 > st
 ...
   B-factor         11.973          5.583          4.352         34.526
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## OCcupancy PRod_plus - multiply/add occupancies of selected atoms

 Syntax: OCcupancy PRod_plus [prod] [plus]
 prod   = multiply selected occupancies by this number (default 1.0)
 plus   = add this number to the selected occupancies (default 0.0)

 This can be used to change the occupancies of the selected atoms.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > oc pr 0.5
 New Q =     0.5000 * Old Q +     0.0000
 Nr of atoms updated : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor PLot - plot B-factors for selected atoms

 Syntax: BFactor PLot file [what]
 file   = O2D plot file name
 what   = Average | Radial

 Option Average creates a plot of average B-factor per residue, using only
   currently selected atoms.  Option Radial produces a plot of average
   B-factor in 2.0 A shells from the centre-of-gravity of the currently
   selected atoms.  The plot files are for use with O2D.

 For example, to plot the average B-factors for all protein residues in
   chain A, use: SE EX, SE ANd CHain A, SE ANd TYpe PROT (only needed if
   chain A contains things other than protein residues), BF PLot bave.plt a.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/bf_av.gif">
 $$ Example of a BFactor PLot (average)</A>.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/bf_rad.gif">
 $$ Example of a BFactor PLot (radial)</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se ex
 MOLEMAN2 > se an ch a
 MOLEMAN2 > bf pl bave.plt a
 Residues with selected atoms : (        701) 
 MOLEMAN2 > bf pl brad.plt r
 Selected atoms : (       3518) 
 Centre-of-gravity : (  30.052   63.904   61.356) 
 Shell    0.0 -    2.0 A -      3 atoms; <B> = 13.80 A**2
 Shell    2.0 -    4.0 A -      9 atoms; <B> = 17.73 A**2
 Shell    4.0 -    6.0 A -     35 atoms; <B> = 12.22 A**2
 Shell    6.0 -    8.0 A -     69 atoms; <B> = 12.69 A**2
 ...
 Shell   32.0 -   34.0 A -     33 atoms; <B> = 25.13 A**2
 Shell   34.0 -   36.0 A -     13 atoms; <B> = 35.35 A**2
 Shell   36.0 -   38.0 A -      1 atoms; <B> = 43.24 A**2
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## Occupancy PLot - plot occupancies for selected atoms

 Syntax: OCcupancy PLot file [what]
 file   = O2D plot file name
 what   = Average | Radial

 Option Average creates a plot of average occupancy per residue, using only
   currently selected atoms.  Option Radial produces a plot of average
   occupancy in 2.0 A shells from the centre-of-gravity of the currently
   selected atoms.  The plot files are for use with O2D.

 For example, to plot the average occupancy for all protein residues in
   chain A, use: SE EX, SE ANd CHain A, SE ANd TYpe PROT (only needed if
   chain A contains things other than protein residues), OC PLot qave.plt a.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/oc_av.gif">
 $$ Example of a OCcupancy PLot (average)</A>.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/oc_rad.gif">
 $$ Example of a OCcupancy PLot (radial)</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > oc pl q1.plt ave
 Residues with selected atoms : (        680) 
 MOLEMAN2 > oc pl q2.plt rad
 Command > (oc pl q2.plt rad) 
 Selected atoms : (       5416) 
 Centre-of-gravity : (  30.728   16.687   12.025) 
 Shell    0.0 -    2.0 A -      1 atoms; <OCC> =  1.00
 Shell    2.0 -    4.0 A -     11 atoms; <OCC> =  1.00
 ...
 Shell   52.0 -   54.0 A -     63 atoms; <OCC> =  0.89
 Shell   54.0 -   56.0 A -     75 atoms; <OCC> =  0.79
 Shell   56.0 -   58.0 A -     77 atoms; <OCC> =  0.88
 Shell   58.0 -   60.0 A -     39 atoms; <OCC> =  0.79
 Shell   60.0 -   62.0 A -      8 atoms; <OCC> =  0.62
 Shell   62.0 -   64.0 A -      1 atoms; <OCC> =  1.00
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor BOnded - list RMS delta-B for (non-)bonded atoms

 This commands calculates (for the currently selected set of
   atoms only) the RMS delta-B for all bonded atoms, bonded main-chain
   and side-chain atoms separately, and for atoms involved in non-bonded
   interactions (the distance cut-offs can be changed with the COnstants
   SEt command).  Note that hydrogens are included if they are
   currently selected !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > BF BO
 Calculating RMS delta-B for (non-)bonded atoms
 Max bonded distance     : (   2.000) 
 Max non-bonded distance : (   3.600) 
 Nr of selected non-H atoms : (       7038) 
 Nr of bonds (all atoms)   : (    6662) 
        RMS delta-B (A**2) : (   2.099) 
 Nr of bonds (main chain)  : (    4278) 
        RMS delta-B (A**2) : (   1.562) 
 Nr of bonds (side chain)  : (    3192) 
        RMS delta-B (A**2) : (   2.613) 
 Nr of non-bonded contacts : (   23812) 
        RMS delta-B (A**2) : (   5.194) 
 CPU total/user/sys :      17.7      17.7       0.1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor SMooth - smooth B-factors of bonded atoms

 This command will operate on all selected atoms, and replace
   the B-factor of each atom by the average of its own B-factor and those
   of all its bonded neighbours (if any).  This can be useful when you
   make the transition from refining grouped to individual temperature
   factors.  Use the BFactor BOnded command before and after this
   operation to see the effect.  Note that hydrogens are included if they
   are currently selected !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > BF SM
 Smoothing Bs for bonded atoms
 Max bonded distance : (   2.000) 
 Nr of selected non-H atoms : (       7038) 
 CPU total/user/sys :      34.6      34.4       0.2
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor GRoup - group-average B-factors

 Syntax: BFactor GRoup how
 how    = Mc_sc | Residue | Overall

 This command enables you to average B-factors for certain groups of
   atoms, e.g. prior to refinement of a high-resolution model against
   low-resolution data (e.g., a complex or mutant).  Note that hydrogens
   are included if they are currently selected !

 Grouping is carried out for all currently selected atoms in one of
   three ways:
 - Overall: the B-factor of each selected atom is set to the average
   B-factor of all selected atoms
 - Residue: the B-factors are averaged for all selected atoms for
   every residue
 - Mc_sc: ditto, but grouped for main-chain and side-chain atoms
   separately

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf gr mc
 Group Bs for main/side chain atoms
 Nr of main-chain groups : (        137) 
 Nr of side-chain groups : (        230) 
 MOLEMAN2 > bf gr re
 Group Bs per residue
 Nr of residues grouped : (        238) 
 MOLEMAN2 > bf gr ov
 Group Bs for all selected atoms
 Nr of selected atoms : (       1213) 
 Average B-factor : (  16.622) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor PSeudo - replace B-factors by pseudo-B-factors

 Syntax: BFactor PSeudo how [parameters]
 how    = X | Y | Z | Q | A | I | R | G | D | N | C | H

 With this command you can replace the B-values of a model by a range
   of other property values. You can use this so as to be able to
   colour-ramp your model by these properties, e.g. in O or Rasmol.

 Note that this command only works on the B-factors of the currently
   selected atoms ! And before using this command you may want to
   "back-up" your true B-values with the BFactor SAve command (they can
   then be restored later with the BFactor REstore command).

 The following properties have been implemented:

 - X = X-coordinate
 - Y = Y-coordinate
 - Z = Z-coordinate
 - Q = Occupancy
 - A = Atom index (sequential); i.e. the first selected atom will get
       a B-factor of 1.0, the second 2.0, etc.
 - I = Residue index (sequential); same as A, but now the numbering
       is done per residue rather than per atom
 - R = Residue number (in sequence); now each atom will get a B-value
       equal to the actual number of its residue (this can be used
       to colour-ramp multiple protein molecules in the same way)
 - G = Distance from Centre-of-Gravity (of the selected atoms); atoms
       close to the centre-of-gravity will get low B-values
 - D = Distance from a point; you can provide any or all of the coordinates
       of a point (e.g., the coordinates of a metal ion); they will
       default to zero
 - N = Nr of neighbour atoms in sphere; provide the radius of a sphere
       (default is 10 \A); every atom will get a B-value equal to the
       number of atoms (including itself) that lie within a sphere of
       the specified radius from it (related to, but different from,
       the so-called Ooi number). Surface atoms will get low B-values,
       and buried atoms will get high values.
 - C = CX values (atomic convexity); see A Pintar et al, Bioinformatics
       18, 980-984 (2002). CX is a measure for the convexity of an atom.
       Note that the formula for CX can be simplified to (C/N) - 1,
       where C = Vsphere / Vatom = 4 * PI * Radius**3 / (3 * Vatom).
       You can supply values for Radius (default 10 \A) and Vatom (default
       20 \A3).
 - H = Halle B (LDM-prediction); see B Halle, PNAS 99, 1274-1279 (2002).
       Halle gives a method to predict B-values from packing density
       alone. His equation (7) can be used to get: B(LDM) = 
       4 * PI**2 * C / Nk, where Nk is the number of atoms surrounding
       the atom within a sphere of radius 7.35 \A, and C is a scaling
       constant that makes the observed and calculated average B-values
       the same. Note that this option requires that the B-values
       are the experimental ones and not some pseudo-B-values ! After
       this operation, the B-values will be those computed using
       Halle's method. If you plot the average of CA B-value before
       and after this operation, the plots should show similar trends.
       Substantial deviations may be indicative of problems in the
       structure or its refined B-values.

 Note that some properties can get values that are unsuitable for the
   B-value field in PDB files (e.g., >= 1000; some programs may also
   balk at non-positive B-factors). You can therefore adjust the
   range of values using the BF LImit, BF PRod_plus or BF SCale
   commands. Also, if you want to invert the colour-ramping, simply
   do a BF SCale with the minimum and maximum value swapped.
   If you want to use the properties in O, you can save the pseudo-B-values
   as an O datablock file with the BFactor ODb command.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf ps c
 Replace B-factors by Pseudo-B-factors ...
 Pseudo-B = C = CX values (atomic convexity)
 Radius (A) : (  10.000) 
 Atomic volume (A3) : (  20.000) 
 Nr of atoms processed : (       1213) 

 Minimum Pseudo-B : (  -0.089) 
 Warning - non-positive values for Pseudo-B !
 Maximum Pseudo-B : (   5.160) 
 Dynamic range    : (   5.249) 
 Average Pseudo-B : (   0.656) 
 You may use BF LImit, BF PRod_plus and BF SCale
 to modify the range and values of the Pseudo-Bs
 MOLEMAN2 > wr cx.pdb
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Example of the use of Halle's method:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re pdb1cbs.ent
 MOLEMAN2 > bf odb bexp.odb m1
 MOLEMAN2 > sel and type prot
 MOLEMAN2 > sel and atom " CA "
 MOLEMAN2 > bf plot bexp.plt ave
 MOLEMAN2 > sel all
 MOLEMAN2 > sel and type prot
 MOLEMAN2 > bf ps halle
 Replace B-factors by Pseudo-B-factors ...
 Pseudo-B = H = Halle B (LDM-prediction)
 Radius (A) : (   7.350) 
 Nr of atoms selected : (       1091) 
 Average experimental B (A2) : (  1.548E+01) 
 Average predicted B (A2) : (  6.474E-01) 
 ==> Scale factor : (  2.391E+01) 
 Nr of atoms processed : (       1091) 

 Minimum Pseudo-B : (   9.255) 
 Maximum Pseudo-B : (  72.619) 
 Dynamic range    : (  63.364) 
 Average Pseudo-B : (  15.480) 
 You may use BF LImit, BF PRod_plus and BF SCale
 to modify the range and values of the Pseudo-Bs
 MOLEMAN2 > bf odb bldm.odb m2
 MOLEMAN2 > sel and atom " CA "
 MOLEMAN2 > bf pl bldm.plt ave
 MOLEMAN2 > wr halleb.pdb
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor SAve - back-up the real B-factors of a model

 Syntax: BFactor SAve

 Use this command prior to using the BFactor PSeudo command. Later on,
   you can then restire the true B-values with the BFactor REstore
   command. Note that the program will not allow you to use the BFactor
   SAvecommand when your B-values have been replaced by pseudo-B-values !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf save
 ERROR ---  Cannot save Pseudo-B-factors !
 MOLEMAN2 > bf re
 Restored all atomic B-factors
 MOLEMAN2 > bf sa
 Saved all atomic B-factors
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor REstore - restore the real B-factors of a model

 Syntax: BFactor REstore

 When you have backed-up your true B-values with the BFactor SAve command,
   you can restore them with this command (e.g., after generating
   pseudo-B-values).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf re
 Restored all atomic B-factors
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor SCale - scale the B-factors of a model

 Syntax: BFactor SCale [min] [max]

 Scale the B-values so that they lie in the range specified. This is
   mostly intended for manipulation of pseudo-B-values. The minimum
   and maximum values default to 1.0 and 100 A2, respectively.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf sc 1 100
 Scale B-factors of selected atoms
 Requested range (A2) :   1.000 100.000
 Nr of selected atoms : (       1213) 
 Current range (A2)   :    3.920  54.210
 B-factors scaled
 MOLEMAN2 > bf st
 Chain name      Atoms       Bave       Bsdv       Bmin       Bmax       Brms   Bharm.av
    <->1CBS       1213      26.00      18.32       1.00     100.00      31.81      17.01
 Nr of chains encountered  : (          1) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## BFactor ODb - save B-factors to an O datablock file

 Syntax: BFactor ODb [filename] [molname]

 Save the current atomic B-values (pseudo or real) to an O-style
   datablock file. Such files can be read by O and ODBMAN for
   further use or analysis.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > bf odb b.odb cbs
 Save B-values in ODB file : (b.odb) 
 Molecule name in O : (CBS) 
 File written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The ODB file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 % 618 gerard sarek 22:09:47 gerard/junk > head b.odb 
! Created by MOLEMAN2 V. 030221/3.2 at Sat Feb 22 02:38:30 2003 for gerard
CBS_ATOM_B     R          1213 (10F8.3)
  30.050  28.820  26.590  26.840  29.240  29.290  30.710  24.040  20.790  16.750
  15.230  22.810  24.290  21.870  27.940  14.690  12.620  12.430  12.120  10.740
  11.850  10.900  13.260   9.120  11.760  10.300  11.240  11.300  10.390  10.240
  13.530  16.760   9.870  10.860  11.210   9.910  10.410  11.060  10.330  11.280
  12.950  18.080  19.520  21.230   8.660   8.740   9.630   9.450   8.000   8.010
   8.290   7.600   9.200   8.730   6.990   7.670   7.580   5.920   9.390  11.560
  10.560  10.140  15.200  18.520  26.260  29.220  32.480   8.210   8.080   7.860
   8.380  10.700  10.950  10.700  13.230   7.080   7.450   8.490   9.490  10.280
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** NUCLEIC COMMANDS

 ## NUcleic DUarte_pyle - analysis of RNA/DNA pseudo-torsion angles

 Syntax: NUcleic DUarte_pyle [file] [what] [chain]
 file   = name of output file or blank
 what   = Plot | ACGTU_plot | Text_file
 chain  = * | _ | chain_name

 If you don't provide a filename, no output file is generated.  If you
   do, the second parameter determines what type of file you will get.
   You can get a simple list of the ETA and THETA pseudo-torsion
   angles for every residue by selecting type T(ext_file).  If you want
   a Ramachandran-like plot (PostScript format), you can select P or A.
   With the P option, all residues will be plotted as black plus signs.
   With the ACGTI command, you will get: A=black box, C=red plus,
   G=cyan cross, T=blue diamond, U=magenta triangle, other=green Z.
   Note that the plot file is already in PostScript format, so you don't
   have to convert it with O2D.

 From version 2.9 on, there is a new (optional) parameter "chain".
   This can be:
 - "*" (default) : all chains will be processed in one go
 - "_" : the chains will be processed one by one; in this case
         "_chain_X.ps" will be appended to "file" (where "X" is
         the uppercase name of each chain) to generate the name
         of the PostScript file
 - the (one-character) name of a specific chain

 Reference: CM Duarte & AM Pyle (1998), J. Mol. Biol. 284, 1465-1478.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/nuc_du_ac.gif">
 $$ Example of a NUcleic DUarte_pyle plot (ACGTU)</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > nu du q.ps a
 Command > (nu du q.ps a) 
 => XPS_GRAF - GJK (19981216/3.1.2) 
 Opened PostScript file : (q.ps) 
 Date    : (Fri Nov 17 20:47:20 2000) 
 User    : (gerard) 
 Program : (MOLEMAN2) 
 Nr of residues to check : (        316) 


 RESIDUE    G A 103      
 <<<<< Start of new chain
   A-A 104 -          191.9      259.0
   A-A 105 -          217.3      212.9
   U-A 106 -          300.2      241.2
   U-A 107 -          265.9      223.0
   G-A 108 -          168.8      223.2
   C-A 109 -          170.7      194.8
[...]
   U-B 259 -          166.6      209.7

 RESIDUE    C B 260      
 >>>>> End of chain

 Total nr of residues checked : (        316) 
 Start/end residues           : (          4) 
 Problems (missing atoms ?)   : (          0) 
 Remaining residues in plot   : (        312) 
 Number of A : (         90) 
 Number of C : (         64) 
 Number of G : (         86) 
 Number of T : (          0) 
 Number of U : (         72) 
 Others      : (          0) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** PROTEIN COMMANDS

 ## PRotein MC_analysis - analysis of main-chain torsion angles

 Syntax: PRotein MC_analysis [file] [what] [chain]
 file   = name of output file or blank
 what   = Rama_plot | Labelled_rama | Text_file
 chain  = * | _ | chain_name

 If you don't provide a filename, no output file is generated.  If you
   do, the second parameter what type of file you will get.  You can
   get a simple list of Phi, Psi, Omega and Planarity (pseudo-)torsion
   angles for every residue by selecting type T(ext_file).  If you want
   a Ramachandran plot (PostScript format only; use the old MOLEMAN if
   you want other formats, or Balasubramanian plots, or polar Ramachandran
   plots), you can select R or L.  With option L, the outliers will be
   marked with a text label in the plot; with option R they won't be.
   Note that the plot file is already in PostScript format, so you don't
   have to convert it with O2D.

 From version 2.9 on, there is a new (optional) parameter "chain".
   This can be:
 - "*" (default) : all chains will be processed in one go
 - "_" : the chains will be processed one by one; in this case
         "_chain_X.ps" will be appended to "file" (where "X" is
         the uppercase name of each chain) to generate the name
         of the PostScript file
 - the (one-character) name of a specific chain

 The screen output is simply a list of "features" of your protein
   main chain, including:
 - start and end residues of chains (looking at CA-CA distances, *not*
   chain or segment names; the maximum CA-CA distance allowed is 4.5 A);
 - inability to calculate certain torsion angles (e.g., due to missing
   atoms in a residue or one of its neighbours);
 - type of peptide (cis, trans, or "unusual");
 - planarity of the peptide bond;
 - positive PHI angles (not for glycines; unusual outside the poly-Pro
   area);
 - outliers in the Ramachandran plot (not for glycines);
 - suspected left-handed helices (check hydrogen bonding yourself to
   decide if they really are helices, and, if so, if they are alpha
   or 3-10 helices).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 RESIDUE  HIS B 211      
 Warning - positive PHI =     57.1

 RESIDUE  ALA B 212      
 Warning - positive PHI =     51.5

 RESIDUE  GLU B 214      
 Warning - positive PHI =     36.9
 Warning - unusual PHI,PSI combination =     36.9    74.8

 Left-handed helix - nr of residues : (          6) 
 Left-handed helix first :  HIS B 211      
 Left-handed helix last  :  GLY B 216      
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The Ramachandran outliers are identified using data obtained in an
   analysis of 403 PDB structurs (October 1995) which are mutually
   <= 95 % homologous (Hobohm & Sander list), and were refined at a
   resolution of 2.0 A or better.  For
   the 74,893 non-Gly residues included (with temperature factors less
   than two standard deviations above the average for the protein), a
   mega-Ramachandran plot was generated using 10 degree-square bins.
   The set of most-populated bins containing 98% of all residues was
   then defined as the core of the ramachandran plot.  Any residue
   outside this core region is called an outlier.  For your average
   2.0 A or better structure, one would expect ~0-5% outliers.  Outliers
   will be shown with an asterisks (and, optionally, a text label) in
   the Ramachandran plot. From version 2.4.1 on, D-amino acids are
   treated explicitly (-phi and -psi are used to determine if they
   are outliers; they will be shown as red diamonds in the PostScript
   plot).

 Reference for the most-favoured regions in the Ramachandran plot:
   Kleywegt, G.J. and Jones, T.A. (1996). Phi/psi-chology: Ramachandran
   revisited. Structure 4, 1395-1400.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/pr_mc_lab.gif">
 $$ Example of a PDb MC plot (labeled)</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > prot mc 1cel_rama.ps lab
 => XPS_GRAF - GJK (2.3 @ 960209) 
 Opened PostScript file : (1cel_rama.ps) 
 Date    : (Sun Feb 18 02:15:33 1996) 
 User    : (gerard) 
 Program : (MOLEMAN2) 
 Nr of residues to check : (        868) 


 RESIDUE  PCA A   1  1CEL
 <<<<< Start of new chain

 RESIDUE  SER A  99  1CEL
 Warning - unusual PHI,PSI combination =   -118.7  -112.1
 ...
 RESIDUE  MET A 374  1CEL
 Warning - positive PHI =     65.2

 RESIDUE  TYR A 381  1CEL
 Cis-peptide; omega =      0.4; next residue is PRO
 Warning - non-planar peptide; planarity =      5.5

 RESIDUE  ASN A 420  1CEL
 Warning - positive PHI =     47.3

 RESIDUE  GLY A 434  1CEL
 >>>>> End of chain


 RESIDUE  PCA B   1  1CEL
 <<<<< Start of new chain

 RESIDUE  SER B  99  1CEL
 Warning - unusual PHI,PSI combination =   -134.0  -130.7
 ...
 RESIDUE  TYR B 381  1CEL
 Cis-peptide; omega =     -1.1; next residue is PRO

 RESIDUE  ASN B 420  1CEL
 Warning - positive PHI =     49.6

 RESIDUE  GLY B 434  1CEL
 >>>>> End of chain

 Total nr of residues checked : (        868) 
 Cis-peptide bonds            : (          2) 
 Unusual OMEGA values         : (          0) 
 Non-planar peptide bonds     : (          1) 
 Start/end residues           : (          4) 
 Problems (missing atoms ?)   : (          0) 
 Glycine residues             : (        100) 
 Remaining residues in Ramach : (        764) 
   In core regions            : (        759) 
   Outliers                   : (          5) 
   Outlier percentage         : (   0.654) 
 An average <= 2.0 A model has ~0-5% outliers
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pr mc cbh2.list t
 Nr of residues to check : (        725) 


 RESIDUE  ALA    86  AAAA
 <<<<< Start of new chain

 RESIDUE  ASN   158  AAAA
 Warning - unusual PHI,PSI combination =   -102.6    52.9
 ...
 RESIDUE  GLN   422  KKKK
 Cis-peptide; omega =      0.1; next residue is PRO

 RESIDUE  ASN   443  KKKK
 Cis-peptide; omega =      1.1; next residue is PRO

 RESIDUE  LEU   447  KKKK
 >>>>> End of chain

 Total nr of residues checked : (        725) 
 Cis-peptide bonds            : (          6) 
 Unusual OMEGA values         : (          0) 
 Non-planar peptide bonds     : (          0) 
 Start/end residues           : (          4) 
 Problems (missing atoms ?)   : (          0) 
 Glycine residues             : (         60) 
 Remaining residues in Ramach : (        661) 
   In core regions            : (        637) 
   Outliers                   : (         24) 
   Outlier percentage         : (   3.631) 
 An average <= 2.0 A model has ~0-5% outliers
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The text file produced in the example above may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Created by MOLEMAN2 V. 960217/0.4 at Sun Feb 18 02:16:43 1996 for user gerard

 Listing of Phi, Psi, Omega and Planarity (pseudo) torsion
 angles for PDB file hydro.pdb

 PHI = C(i-1) - N(i) - CA(i) - C(i) - usually negative
 PSI = N(i) - CA(i) - C(i) - N(i+1)
 OMEGA = CA(i) - C(i) - N(i+1) - CA (i+1) - cis=0, trans=180
 PLANARITY = C(i) - CA(i) - N(i+1) - O(i) - planar < 5

 An entry of "-999.9" means that the torsion angle could
 not be calculated (for terminal residues and residues with
 missing atoms).

         Residue        Phi        Psi      Omega  Planarity
         -------        ---        ---      -----  ---------

 ALA-   86 -AAAA     -999.9      -60.2     -179.0       -0.8
 THR-   87 -AAAA      -73.7      142.9     -178.7        0.2
 TYR-   88 -AAAA     -139.9      162.0      178.3       -0.7
 SER-   89 -AAAA     -124.5      117.2      179.7        1.7
 GLY-   90 -AAAA       86.1     -131.6     -179.6        0.4
 ASN-   91 -AAAA      -65.5      116.2     -179.7       -1.9
 ...
 SER-  445 -KKKK      -70.6      146.1      178.6        0.7
 PHE-  446 -KKKK      -98.7      -32.7      179.2        0.4
 LEU-  447 -KKKK      -77.7     -999.9     -999.9     -999.9
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PRotein SC_analysis - analysis of side-chain torsion angles

 Syntax: PRotein SC_analysis [file]
 file   = name of output file or blank

 If you don't provide a filename, no output file is generated.  If you
   do, you'll get a plain text file with a listing for all protein
   residues except Gly of the CA-chirality improper and the side chain
   torsion angles Chi1 to Chi5 (the latter only occurs for Arg and should
   be zero).

 On the screen you'll get a list of "features" of your sidechains.
   Things that are checked (using a tolerance of 5 degrees) include:
 - CA-chirality (D/L amino acids; improper CA - N - C - CB; +34 for
   L-amino acids, -34 for D-amino acids; bad if not near an ideal
   value; note that the ideal value for Pro is more like 38 degrees)
 - naming of equivalent sidechain 1/2 atoms (Asp, Glu, Phe, Tyr, Arg;
   tested by checking if the corresponding Chi torsion i in the range
   [-90,+90]; if not, a message is printed; atom names are not swapped)
 - chirality of Ile CB (CB - CG1 - CG2 - CA; should be +34)
 - "tetrahedral-ness" of some other carbons (Leu CG, Val CB and Thr CB)
 - flatness of several atom types (not of rings; Arg CZ, Asn/Asp CG,
   Gln/Glu CD, His/Phe/Tyr/Trp CG)

 Example of the output:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > pr sc

 RESIDUE  ASP A 173  1CEL
 Warning - poor CA chirality improper =     27.3

 RESIDUE  PRO A 194  1CEL
 Warning - poor CA chirality improper =     39.1

 RESIDUE  PRO A 229  1CEL
 Warning - poor CA chirality improper =     39.8

 RESIDUE  TYR A 274  1CEL
 Warning - sidechain 1/2 atom names incorrect; Chi =     91.1

 ...

 RESIDUE  ASP B 368  1CEL
 Warning - poor CA chirality improper =     27.8

 Nr of residues checked    : (        766) 
 Nr of D-amino acids       : (          0) 
 Nr with poor CA chirality : (          9) 
 Nr wrong 1/2 atom names   : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The output text file (optional) may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Created by MOLEMAN2 V. 960217/0.4 at Thu Feb 22 19:37:07 1996 for user gerard

 Listing of Chi1-5 and Chirality (pseudo) torsion
 angles for PDB file 1cel.pdb

 CHIRAL = CA    - N     - C     - CB (+34=L-aa; -34=D-aa)
 CHI-1  = N     - CA    - CB    - ?G(1)
 CHI-2  = CA    - CB    - ?G(1) - ?D(1)
 CHI-3  = CB    - ?G(1) - ?D(1) - ?E(1)
 CHI-4  = ?G(1) - ?D(1) - ?E(1) - ?Z(1)
 CHI-5  = ?D(1) - ?E(1) - ?Z(1) - ?H(1)

 An entry of "-999.9" means that the torsion angle could
 not be calculated (e.g., for residues with missing atoms).

         Residue    CA-chir      Chi-1      Chi-2      Chi-3      Chi-4      Chi-5
         -------    -------      -----      -----      -----      -----      -----
 PCA-A   1 -1CEL       37.9       31.7      -30.2     -160.3
 SER-A   2 -1CEL       34.3       67.1
 ALA-A   3 -1CEL       35.0
 CYS-A   4 -1CEL       33.1      -80.1
 ...
 THR-B 429 -1CEL       34.5       69.0
 ASN-B 431 -1CEL       -1.0      -69.5      -37.0
 PRO-B 432 -1CEL       36.6      -39.5       47.1
 SER-B 433 -1CEL       35.4      -63.4
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## PRotein CA_analysis - analysis of Calpha geometry

 Syntax: PRotein CA_analysis [file] [what] [chain]
 file   = name of output file or blank
 what   = Rama_plot | Labelled_rama | Text_file
 chain  = * | _ | chain_name

 The meaning of the parameters is the same as for the PRotein MC_analysis
   command (quod vide).

 The program will check:
 - unusual CA-CA distances (2.9 A for cis and 3.8 for trans)
 - isolated residues (a CA not connected to the previous or the next
   residue in the sequence)
 - unusual CA geometry (in terms of angle/torsion combinations, similar
   to a Ramachandran plot)

 If you select a text file for output, for each residue the following
   will be listed:
 - CA(i)   - CA(i+1) distance
 - CA(i-1) - CA(i) - CA(i+1) angle
 - CA(i-1) - CA(i) - CA(i+1) - CA(i+2) pseudo-torsion angle

 From version 1.0.2 onward, the program will also look for sequential
   stretches of residues which contain several CA-geometry outliers.
   Such stretches are worth closer scrutiny; sometimes they coincide
   with the start or end of a zone that is out-of-register with the
   sequence !  The program checks for zones of 8 sequential residues
   with at least 5 outliers, then 5 residues with at least 3 outliers
   and finally 3 residues with at least 2 outliers.

 From version 2.9 on, there is a new (optional) parameter "chain".
   This can be:
 - "*" (default) : all chains will be processed in one go
 - "_" : the chains will be processed one by one; in this case
         "_chain_X.ps" will be appended to "file" (where "X" is
         the uppercase name of each chain) to generate the name
         of the PostScript file
 - the (one-character) name of a specific chain

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/pr_ca_lab.gif">
 $$ Example of a PDb CA plot (labeled)</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re /nfs/pdb/full/1chr.pdb
 ...
 MOLEMAN2 > pr ca q.ps r
 => XPS_GRAF - GJK (2.4 @ 960223) 
 Opened PostScript file : (q.ps) 
 Date    : (Thu Aug  1 20:04:50 1996) 
 User    : (gerard) 
 Program : (MOLEMAN2) 


 RESIDUE  MET A   1  1CHR
 <<<<< Start of new chain

 RESIDUE  LYS A   2  1CHR
 Warning - unusual CA-CA distance     3.66

 ...

 RESIDUE  SER B 370  1CHR
 >>>>> End of chain

 Nr of residues checked : (        743) 
 Nr of isolated CAs     : (          0) 
 Nr with CA-CA distance : (        738) 
 Nr with CA ang/torsion : (        732) 
   Ditto, non-Gly       : (        674) 

 CA-CA distances:
     738 CA-CA distances
 Average CA-CA distance =    3.808 Sigma =    0.089
 Minimum CA-CA distance =    3.482 Maxim =    4.367
 Short (<= 2.8 A)  CA-CA dists :      0 res =     0.00 % =  0.1 SIGMA from mean
 CIS   (<= 3.0 A)  CA-CA dists :      0 res =     0.00 % =  0.5 SIGMA from mean
 Poor  (<= 3.7 A)  CA-CA dists :     68 res =     9.21 % =  2.2 SIGMA from mean
 TRANS (<= 3.9 A)  CA-CA dists :    579 res =    78.46 % =  2.6 SIGMA from mean
 Long  (>  3.9 A)  CA-CA dists :     91 res =    12.33 % =  2.7 SIGMA from mean

 CA geometry:
       CORE res :    449 =    66.62 % =  0.7 SIGMA from mean
 Additional res :     84 =    12.46 %
   Generous res :    106 =    15.73 %
 DISALLOWED res :     35 =     5.19 % =  1.0 SIGMA from mean
 For <= 2.0 A structures :
 Core       -  7.1 % area - 72.8 % (8.9) residues
 Additional -  5.2 % area - 12.8 % (4.0) residues
 Generous   - 15.0 % area - 11.3 % (4.6) residues
 Disallowed - 72.6 % area -  3.1 % (2.2) residues

 WARNING !!!  At least three of five sequential residues
              have poor CA geometry, starting at:
 RESIDUE  VAL A  13  1CHR

 WARNING !!!  At least five of eight sequential residues
              have poor CA geometry, starting at:
 RESIDUE  ASP B  12  1CHR

 WARNING !!!  At least three of five sequential residues
              have poor CA geometry, starting at:
 RESIDUE  VAL B  34  1CHR

 WARNING !!!  At least three of five sequential residues
              have poor CA geometry, starting at:
 RESIDUE  GLY B 296  1CHR
 CPU total/user/sys :       1.6       1.4       0.2
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 A listing file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 Created by MOLEMAN2 V. 960222/0.5 at Fri Feb 23 19:24:38 1996 for user gerard

 Listing for PDB file aspglu.pdb

 CA(i)   - CA(i+1) distance (2.9=cis, 3.8=trans)
 CA(i-1) - CA(i) - CA(i+1) angle
 CA(i-1) - CA(i) - CA(i+1) - CA(i+2) pseudo-torsion angle

 An entry of "-999.9" means that the value could not be
 calculated (for near-terminal residues)

         Residue   Distance      Angle    Torsion
         -------   --------      -----    -------

 SER-    1 -            3.7     -999.9     -999.9
 THR-    2 -            3.5       75.8       58.9
 ASP-    3 -            3.7      127.0      152.5
 ASP-    4 -            3.8      117.4     -139.5
 ALA-    5 -            3.8      106.6       75.0
 SER-    6 -            3.7      123.0       -9.3
 ...
 GLU-  327 -            3.9      129.8     -167.1
 ILE-  328 -            3.9      150.3     -177.8
 ASP-  329 -            3.9     -999.9     -999.9
 ALA-  330 -            3.7     -999.9     -999.9
 ALA-  331 -         -999.9     -999.9     -999.9
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** COORDINATE MANIPULATION

 Coordinates of all selected atoms can be manipulated primarily with the
   XYz commands.

 ## XYz FRactionalise - fractionalise coordinates

 This command fractionalises your (selected) coordinates.  This may
   be useful for applying fractional translations (e.g., a translation
   function solution), and for converting orthogonal heavy-atom
   coordinates (from O or RSPS, for instance) into fractional ons.

 The cell constants can be entered with the PDb CRystal command if
   they are not present in the PDB file you have read.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy fr
 Fractionalise coordinates
 Cell axes   : (  45.650   47.560   77.610) 
 Cell angles : (  90.000   90.000   90.000) 
 New X =  0.021906 * X +  0.000000 * Y +  0.000000 * Z
 New Y =  0.000000 * X +  0.021026 * Y +  0.000000 * Z
 New Z =  0.000000 * X +  0.000000 * Y +  0.012885 * Z
 ATOM     1  N   PRO     1      16.979  13.301  44.555  1.00 30.05      1CBS 223
 Before : (  16.979   13.301   44.555) 
 After  : (   0.372    0.280    0.574) 
 Nr of transformed atoms : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz ORthogonalise - orthogonalise coordinates

 This command orthogonalises your (selected) coordinates.  This may be
   useful to convert refined heavy-atom coordinates (from MLPHARE, for
   instance) back into Cartesian ones for use with O.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy or
 Orthogonalise coordinates
 Cell axes   : (  45.650   47.560   77.610) 
 Cell angles : (  90.000   90.000   90.000) 
 New X = 45.650002 * X + -0.000002 * Y + -0.000003 * Z
 New Y =  0.000000 * X + 47.560001 * Y + -0.000003 * Z
 New Z =  0.000000 * X +  0.000000 * Y + 77.610001 * Z
 ATOM     1  N   PRO     1       0.372   0.280   0.574  1.00 30.05      1CBS 223
 Before : (   0.372    0.280    0.574) 
 After  : (  16.979   13.301   44.555) 
 Nr of transformed atoms : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz ROtate - rotate the selected atoms

 Syntax: XYz ROtate how ang1 ang2 ang3
 how    = CEuler | CPolar | MEuler | MPolar | XPolar | XLattmann
          (C=CCP4, M=Merlot, X=X-PLOR)
 ang1-3 = the three rotation angles

 Rotate the selected atoms using one of four conventions:
 - CCP4 Euler angles (alpha, beta, gamma; NCODE = 1 convention !)
 - CCP4 Polar angles (omega, phi, chi)
 - Merlot Euler angles (alpha, beta, gamma)
 - Merlot Polar angles (phi, psi, kappa)
 - X-PLOR Polar angles (phi, psi, kappa)
 - X-PLOR/Lattmann Euler angles (theta+, theta2, theta-)

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy ro ce 103.4 86.2 213.4
 CCP4 Euler angles : ( 103.400   86.200  213.400) 
 New X =  0.548317 * X +  0.803665 * Y + -0.231238 * Z
 New Y =  0.073750 * X +  0.228964 * Y +  0.970637 * Z
 New Z =  0.833012 * X + -0.549271 * Y +  0.066274 * Z
 Crowther Alpha Beta Gamma             103.40001    86.20000  -146.60001
 Spherical polars Omega Phi Chi        111.47401  -145.00000    94.48643
 Direction cosines of rotation axis     -0.76229    -0.53376    -0.36608
 Dave Smith                            -86.09398    33.59056   -55.69545
 ATOM     1  N   PRO     1      16.979  13.301  44.555  1.00 30.05      1CBS 223
 Before : (  16.979   13.301   44.555) 
 After  : (   9.697   47.544    9.791) 
 Nr of transformed atoms : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz AXis_rotate - rotate around the X, Y or Z axis

 Syntax: XYz AXis_rotate axis angle
 axis = the rotation axis (X, Y or Z)
 angle = the rotation angle

 Rotate the selected atoms around the chosen axis by the specified
   angle (in degrees).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz ax y 73    

 Rotate around X, Y or Z axis
 Rotation axis : (Y) 
 Angle (deg)   : (  73.000) 
 Determinant of rotation matrix : (  1.000E+00) 
 New X =  0.2923718 * X +  0.0000000 * Y + -0.9563047 * Z
 New Y =  0.0000000 * X +  1.0000000 * Y +  0.0000000 * Z
 New Z =  0.9563047 * X +  0.0000000 * Y +  0.2923718 * Z
 Crowther Alpha Beta Gamma               180.000      73.000     180.000
 Spherical polars Omega Phi Chi           90.000     -90.000      73.000
 Direction cosines of rotation axis     0.000000   -1.000000    0.000000
 X-PLOR polars Phi Psi Kappa         *undefined*     180.000      73.000
 Lattmann Theta+ Theta2 Theta-       *undefined*      73.000 *undefined*
 ATOM     1  N   SER A   1     -13.903  -4.439   3.739  1.00 34.27      1PMP 185
 Before : ( -13.903   -4.439    3.739) 
 After  : (  -7.640   -4.439  -12.202) 
 Nr of transformed atoms : (       1039) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz TRanslate - translate the selected atoms

 Syntax: XYz TRanslate tx ty tz
 tx..tz = the three translation vector components

 Translate the selected atoms according to the translation vector you
   supply.

 Hint: to carry out a fractional translation, first use XYz FRact to
   fractionalise the coordinates, then apply the translation and
   then reorthogonalise with XYz ORtho (this is useful when applying
   translation function solutions).

 Hint: to move a selected set of atoms such that their centre-of-gravity
   is at the origin, first use the STats command to find the coordinates
   of the CofG (being the average X, Y and Z coordinate), and then
   XYz TRanslate using a vector which is -1 times the CofG coordinates.
   E.g., if your CofG is at (12.4,-54.2,1.9), then use: XYz TRans
   -12.4 54.2 -1.9.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz frac
 Fractionalise coordinates
 ...
 MOLEMAN2 > xy tr 0.345 0.812 0.0
 Translation : (   0.345    0.812    0.000) 
 Length of translation vector : (   0.882) 
 Nr of transformed atoms : (       1213) 
 MOLEMAN2 > xyz ort
 Orthogonalise coordinates
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > st
 Nr of atoms    : (       1213) 
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord         17.837          8.350         -1.464         37.101
    Y-coord         20.849          6.794          2.899         34.741
    Z-coord         27.423          9.907          2.776         49.501
 ...
 MOLEMAN2 > xyz tr -17.837 -20.849 -27.423
 Translation : ( -17.837  -20.849  -27.423) 
 Length of translation vector : (  38.793) 
 Nr of transformed atoms : (       1213) 
 MOLEMAN2 > st
 Nr of atoms    : (       1213) 
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord          0.000          8.350        -19.301         19.264
    Y-coord          0.000          6.794        -17.950         13.892
    Z-coord          0.000          9.907        -24.647         22.078
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz MAtrix - apply user-matrix to selected atoms

 Syntax: XYz MAtrix [r11 r12 r13 r21 r22 r23 r31 r32 r33 tx ty tz]
 new X  = r11*X + r21*Y + r31*Z + tx
 new Y  = r12*X + r22*Y + r32*Z + ty
 new Z  = r13*X + r23*Y + r33*Z + tz
 (defaults: 1 0 0  0 1 0  0 0 1  0 0 0)

 Apply a user-defined rotation/translation operator.  The determinant of
   the matrix must be +1 or -1 (note that -1 implies an inversion !!!).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz mat 1 12 2 11 3 10 4 9 5 8 6 7

 Nr of NCS operators :   1

 NCSOP  1 =     1.0000000   11.0000000    4.0000000                  8.000
               12.0000000    3.0000000    9.0000000                  6.000
                2.0000000   10.0000000    5.0000000                  7.000
 Determinant of rotation matrix       -81.000000
 ERROR --- Determinant differs from +-ONE by more than 0.01
 ERROR --- Operation aborted
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz mat -1 0 0 0 1 0 0 0 1 0 0 0

 Nr of NCS operators :   1

 NCSOP  1 =    -1.0000000    0.0000000    0.0000000                  0.000
                0.0000000    1.0000000    0.0000000                  0.000
                0.0000000    0.0000000    1.0000000                  0.000
 Determinant of rotation matrix        -1.000000
 WARNING - Determinant is -1 !
 Column-vector products (12,13,23)      0.000000    0.000000    0.000000
 Rotation angle                        90.000000
 Nr of atoms transformed : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy mat  -0.9999319 0.0108257 -0.0043541 -0.0112386 -0.7931781
   0.6088861 0.0031381 0.6088936 0.7932457

 Nr of NCS operators :   1

 NCSOP  1 =    -0.9999319   -0.0112386    0.0031381                  0.000
                0.0108257   -0.7931781    0.6088936                  0.000
               -0.0043541    0.6088861    0.7932457                  0.000
 Determinant of rotation matrix         1.000000
 Column-vector products (12,13,23)      0.000000    0.000000    0.000000
 Crowther Alpha Beta Gamma              89.70471    37.51013    89.59029
 Spherical polars Omega Phi Chi         18.75507   -88.96022   179.33235
 Direction cosines of rotation axis      0.00584    -0.32158     0.94690
 Dave Smith                            -37.50976    90.24947   179.35606
 Rotation angle                       179.332367
 Nr of atoms transformed : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz DIstort - apply *any* user-matrix to selected atoms

 Syntax: XYz DIstort [r11 r12 r13 r21 r22 r23 r31 r32 r33 tx ty tz]
 new X  = r11*X + r21*Y + r31*Z + tx
 new Y  = r12*X + r22*Y + r32*Z + ty
 new Z  = r13*X + r23*Y + r33*Z + tz
 (defaults: 1 0 0  0 1 0  0 0 1  0 0 0)

 Apply a user-defined operator. Note that the operator may be anything
   in this command, i.e., even one that inflates or deflates or otherwise
   psychedelically distorts your model. All at your own risk, of course !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz dis 1 0 0  0 -1 0  2 0 -1  0 0 0

 Nr of RT operators :   1

 RT-OP  1 =     1.0000000    0.0000000    2.0000000                  0.000
                0.0000000   -1.0000000    0.0000000                  0.000
                0.0000000    0.0000000   -1.0000000                  0.000
 Determinant of rotation matrix         1.000000
 Column-vector products (12,13,23)      0.000000    2.000000    0.000000
 ERROR --- Seriously non-orthogonal column vectors
 Operator applied at your own risk !
 Nr of atoms transformed : (       1070) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz RT - apply O LSQ-operator to selected atoms

 Syntax: XYz RT file
 file   = LSQ operator in O format

 Apply an operator in O format to the currently selected atoms.  The
   operator may be from O (Lsq_* commands), from LSQMAN, from CELLO,
   from IMP, etc.  Example:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by LSQMAN V. 950413/3.3 at Tue May 9 02:32:33 1995 for user gerard
.lsq_rt_m14a_to_b r 12 (3f15.7)
     -0.9999319      0.0108257     -0.0043541
     -0.0112386     -0.7931781      0.6088861
      0.0031381      0.6088936      0.7932457
    174.4427795     -1.5139760      0.7045361
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 Note that, just like the XYz MAtrix command, the O file contains
   the operator elements in the following order: r11, r12, r13, r21, r22,
   r23, r31, r32, r33, tx, ty, tz and that the new coordinates are
   defined by the following equations:

 new X  = r11*X + r21*Y + r31*Z + tx
 new Y  = r12*X + r22*Y + r32*Z + ty
 new Z  = r13*X + r23*Y + r33*Z + tz


 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz rt rt.o

 ==> Read NCS operator : (.LSQ_RT_M14A_TO_B) 

 Nr of NCS operators :   1

 NCSOP  1 =    -0.9999319   -0.0112386    0.0031381                174.443
                0.0108257   -0.7931781    0.6088936                 -1.514
               -0.0043541    0.6088861    0.7932457                  0.705
 Determinant of rotation matrix         1.000000
 Column-vector products (12,13,23)      0.000000    0.000000    0.000000
 Crowther Alpha Beta Gamma              89.70471    37.51013    89.59029
 Spherical polars Omega Phi Chi         18.75507   -88.96022   179.33235
 Direction cosines of rotation axis      0.00584    -0.32158     0.94690
 Dave Smith                            -37.50976    90.24947   179.35606
 Rotation angle                       179.332367
 ERROR --- Maximum number of NCS operators read
 Maximum : (          1) 
 Nr of atoms transformed : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz RAndom_rotation - apply random rotation to selected atoms

 Use this command to apply a random rotation to the selected atoms.
   The random-number generator seed can be set with COnstants SEt ISEED
   if you want reproducile results.  Note that the centre-of-gravity
   is not maintained.  If you do want that, use the STatistics command
   to find the centre-of-gravity, then XYz TRanslate to move the
   CofG to the origin (i.e., a translation of -1 * CofG vector),
   then apply the random rotation, and finally XYz TRanslate back to
   the original CofG.
 This command can be used to generate randomly oriented molecules for
   VOIDOO, for example.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz rand
 Rotations around X,Y,Z (deg) :  109.73  242.98   38.43

 X Matrix :     1.0000000    0.0000000    0.0000000
                0.0000000   -0.3376119   -0.9412854
                0.0000000    0.9412854   -0.3376119
 Determinant of X rotation matrix : (  1.000E+00) 
 Y Matrix :    -0.4542299    0.0000000    0.8908845
                0.0000000    1.0000000    0.0000000
               -0.8908845    0.0000000   -0.4542299
 Determinant of Y rotation matrix : (  1.000E+00) 
 Z Matrix :     0.7833662    0.6215605    0.0000000
               -0.6215605    0.7833662    0.0000000
                0.0000000    0.0000000    1.0000000
 Determinant of Z rotation matrix : (  1.000E+00) 
   Matrix :    -0.3558283   -0.2823313    0.8908845
                0.8667588    0.2567523    0.4275599
               -0.3494502    0.9243199    0.1533534
 Determinant of random rotation matrix : (  1.000E+00) 

 Random rotation matrix:
 New X = -0.355828 * X + -0.282331 * Y +  0.890885 * Z
 New Y =  0.866759 * X +  0.256752 * Y +  0.427560 * Z
 New Z = -0.349450 * X +  0.924320 * Y +  0.153353 * Z
 Crowther Alpha Beta Gamma              25.63763    81.17869    69.29031
 Spherical polars Omega Phi Chi         49.30368    68.17366   118.22019
 Direction cosines of rotation axis      0.28189     0.70383     0.65205
 Dave Smith                            -70.26855   110.45370   141.56982
 ATOM     1  N   PRO     1       9.697  47.544   9.791  1.00 30.05      1CBS 223
 Before : (   9.697   47.544    9.791) 
 After  : (  -8.151   24.798   42.059) 
 Nr of transformed atoms : (       1213) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz PErturb - random perturbation of selected atoms

 Syntax: XYz PErturb [dx] [dy] [dz] [db] [dq]
 dx..dz = maximum absolute shift for the X/Y/Z coordinate (default 0 0 0)
 db     = maximum absolute shift for the B-factors (default 0)
 dq     = maximum absolute shift for the occupancies (default 0)

 Applies random shift to coordinates and/or B-factors and/or occupancies.
   The parameters are the amplitudes of the shifts.  If dx=dy=dz, then
   in practice the average atomic shift ~ dx.  A value of zero means
   that no shifts will be applied (negative values will be multiplied
   by -1).  The operation works only on the currently selected set of
   atoms.  Note that this operation may yield unphysical values for
   (some) B-factors and occupancies !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy per .1 .1 .1 10 0.02
 Max allowed shifts X/Y/Z/B/Q : (  1.000E-01   1.000E-01   1.000E-01   
  1.000E-01   1.000E-01) 
 Nr of perturbed atoms : (       2898) 
 Average     shifts X/Y/Z/B/Q : (  3.618E-04  -4.027E-04   1.844E-03   
  4.324E-04   5.640E-04) 
 RMS         shifts X/Y/Z/B/Q : (  5.809E-02   5.701E-02   5.816E-02   
  5.701E-02   5.837E-02) 
 AVERAGE POSITIONAL SHIFT (A) : (  9.588E-02) 
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
 ...
    Occpncy          1.001          0.058          0.900          1.100
 Warning - there are occupancies > 1 !
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz MIrror - mirror selected atoms in a plane

 Syntax: XYz MIrror [xyz] [value]
 xyz    = type of plane to mirror in (default X)
 value  = "xyz" coordinate of the plane (default 0.0)
          (e.g., to mirror fractionalised coordinates in the plane Z=1/2,
           use: z 0.5)

 Mirror the currently selected atoms in a plane.  This may be useful to
   get a different stereo-isomer for a chiral ligand, for instance.  If
   you mirror in the plane: X = Centre-of-Gravity(X) (or ditto for Y or Z)
   then the CofG will be conserved in this operation.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord         10.543         22.100        -33.949         54.913
 ...
 MOLEMAN2 > xy mi x 10.543
 Mirror selected atoms in plane: X = 10.543
 Nr of atoms mirrored : (       7038) 
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord         10.543         22.100        -33.827         55.035
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz INvert - invert selected atoms through a point

 Syntax: XYz INvert [icx] [icy] [icz]
 icx-z  = coordinates of inversion centre (default 0,0,0)

 Invert the currently selected atoms.  If you supply the coordinates of
   the centre-of-gravity as the inversion centre, the CofG will be
   conserved after this operation.  This command may be useful to generate
   D-amino acids or even proteins from their all-L counterparts.
   However, beware that the chirality at all chiral centres will be
   inverted, i.e. also at Thr-CB and Ile-CB !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord         17.837          8.350         -1.464         37.101
    Y-coord         20.849          6.794          2.899         34.741
    Z-coord         27.423          9.907          2.776         49.501
 ...
 MOLEMAN2 > xyz inv 17.837 20.849 27.423
 Invert through the point : (  17.837   20.849   27.423) 
 Nr of atoms inverted : (       1213) 
 MOLEMAN2 > stat
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord         17.837          8.350         -1.427         37.138
    Y-coord         20.849          6.794          6.957         38.799
    Z-coord         27.423          9.907          5.345         52.070
 ...
 MOLEMAN2 > pr sc
 Ideal chirality improper : (  34.000) 
 Ideal flatness improper  : (   0.000) 
 Tolerance                : (   5.000) 

 RESIDUE  PRO     1  1CBS
 Warning - D-amino acid !

 RESIDUE  ASN     2  1CBS
 Warning - D-amino acid !
 ...
 RESIDUE  GLU   137  1CBS
 Warning - D-amino acid !

 Nr of residues checked    : (        129) 
 Nr of D-amino acids       : (        129) 
 Nr with poor CA chirality : (          2) 
 Nr wrong 1/2 atom names   : (          0) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz CEntre_origin - move CofG of selected atoms to (0,0,0)

 This will calculate the centre-of-gravity of the currently selected
   atoms, and translate them by -1 times that vector, so that the
   new CofG coincides with the origin at (0,0,0).
 From version 1.0 onward, there is an optional "use_masses" parameter.
   The default is N(o), but if you set it to Y(es), the actual masses
   will be used in calculating th centre-of-gravity.  Note that this
   feature depends on the chemical element being recognisable for all
   selected atoms (either from the atom name or the element field in
   the PDB records).  Also, if you don't have explicit hydrogens the
   calculated CofG will be off in general.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xyz cen
 Moving CofG of selected atoms to (0,0,0)
 Nr of selected atoms : (       1213) 
 Centre-of-Gravity : (  17.837   20.849   27.423) 
 CofG now at (0,0,0)
 MOLEMAN2 > stats
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord          0.000          8.350        -19.301         19.264
    Y-coord          0.000          6.794        -17.950         13.892
    Z-coord          0.000          9.907        -24.647         22.078
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > xy ce y
 Moving CofG of selected atoms to (0,0,0)
 Using atom masses to calculate CofG
 Nr of selected atoms   : (       1213) 
 Nr of unknown elements : (          0) 
 Sum of masses          : (  1.632E+04) 
 Centre-of-Mass : (  17.831   20.824   27.406) 
 CofG now at (0,0,0)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## XYz ALign_inertia_axes - align inertia axes with X, Y, Z axes

 This will move the currently selected atoms such that their
   centre-of-gravity is at the origin (0,0,0); then it will calculate
   the three principal inertia axes, and align the selected atoms
   such that these axes coincide with the X, Y and Z axis.  This
   alignment is done such that the major inertia axis coincides
   with the X-axis (largest eigenvalue), and the minor inertia
   axis coincides with the Z-axis (smallest eigenvalue).  If the
   hand of the three inertia axes is inverted (determinant = -1),
   the three axes are inverted (multiplied by -1).
 This is basically the same operation as the one AMORE performs
   when it puts your search model inside the smallest box (TABLING
   step).
 As a "side-effect", the XY-plane is now the "least-squares plane"
   through the selected atoms, which means that if you view your
   molecule looking along the Z-axis, you get the least-cluttered
   view (i.e., the least overlap between atoms).
 After this operation, the "standard deviation" and range of the
   X-coordinates is greater than or equal to those of the Y-coordinates,
   which in turn exceed those of the Z-coordinates.
 The program prints the Centre-of-Gravity vector, so if you want to
   restore the old CofG, use XYz TRanslate along this vector.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ...
 Selection history : (ALL | AND TYpe = PROT | AND CHain = A |) 
 Nr of selected atoms : (       3220) 
 MOLEMAN2 > xyz align
 Moving CofG of selected atoms to (0,0,0)
 Nr of selected atoms : (       3220) 
 Centre-of-Gravity : (  30.107   63.884   61.070) 
 CofG now at (0,0,0)
 Eigen value 1 =     684466.3 Vector :  -0.070020  0.049714  0.996306
 Eigen value 2 =     370175.8 Vector :   0.732493  0.680549  0.017521
 Eigen value 3 =     298389.2 Vector :  -0.677164  0.731014 -0.084067
 Determinant : (   1.000) 

 Nr of NCS operators :   1

 NCSOP  1 =    -0.0700198    0.0497140    0.9963061                  0.000
                0.7324933    0.6805488    0.0175209                  0.000
               -0.6771638    0.7310143   -0.0840671                  0.000
 Determinant of rotation matrix         1.000000
 Column-vector products (12,13,23)      0.000000    0.000000    0.000000
 Crowther Alpha Beta Gamma               1.00749    94.82238    47.18999
 Spherical polars Omega Phi Chi         69.42821    66.90875   103.69593
 Direction cosines of rotation axis      0.36719     0.86122     0.35138
 Dave Smith                           -168.22716   132.62241  -144.62529
 Rotation angle                       103.695923
 MOLEMAN2 > stats
 ...
       Item        Average         St.Dev            Min            Max
       ----        -------         ------            ---            ---
    X-coord          0.000         14.580        -34.834         30.615
    Y-coord          0.000         10.722        -26.141         28.231
    Z-coord          0.000          9.626        -22.863         23.692
 ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** CHAIN & SEGMENT COMMANDS

 ## CHain AUto

 Auto-generate chain and segment identifiers.  This starts at "AAAA" for
   the first residue (chain "A"), then "AAAB" (chain "B"), etc.  A new
   segment starts if:
 - a residue is the first residue in the current structure
 - a residue is not of the same type as its predecessor (e.g., from
   PROTein to WATEr)
 - a protein residue is too far away from its predecessor (using the
   CA-CA distance to check this)
 - a non-protein residue (OTHER THAN WATER) does not have a residue
   number which is one higher than that of its predecessor (note that
   all *consecutive* waters, irrespective of their numbering, will end
   up in one segment)

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re 1cel.pdb
 Reading from file : (1cel.pdb) 
 in normal PDB format
 ignoring hydrogen atoms
 ...
 MOLEMAN2 > ch auto

 RESIDUE  PCA A   1  1CEL
 New segment : (          1) 
 Because : (First residue) 
 Segment ID (4 char) : (AAAA) 
 Chain name (1 char) : (A) 

 RESIDUE  NAG A 435  1CEL
 New segment : (          2) 
 Because : (Different type of residue: CARB) 
 Segment ID (4 char) : (AAAB) 
 Chain name (1 char) : (B) 

 RESIDUE  IBZ A 436  1CEL
 New segment : (          3) 
 Because : (Different type of residue: HETE) 
 Segment ID (4 char) : (AAAC) 
 Chain name (1 char) : (C) 

 RESIDUE  GLC A 437  1CEL
 New segment : (          4) 
 Because : (Different type of residue: CARB) 
 Segment ID (4 char) : (AAAD) 
 Chain name (1 char) : (D) 

 RESIDUE  HOH A 501  1CEL
 New segment : (          5) 
 Because : (Different type of residue: WATE) 
 Segment ID (4 char) : (AAAE) 
 Chain name (1 char) : (E) 

 RESIDUE  PCA B   1  1CEL
 New segment : (          6) 
 Because : (Different type of residue: PROT) 
 Segment ID (4 char) : (AAAF) 
 Chain name (1 char) : (F) 
 ...
 RESIDUE  HOH   441  1CEL
 New segment : (         12) 
 Because : (Different type of residue: WATE) 
 Segment ID (4 char) : (AAAL) 
 Chain name (1 char) : (L) 

 Total number of segment/chains found : (         12) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain ASk

 This command does the same as the CHain AUto command, except that you
   are prompted for the new segment and chain names.  The program will
   then continue generating new segment names from the one you provided.
   For example, if you have three protein molecules in your file, and
   you call the first "PROA", the program will suggest "PROB" for the
   name of the second molecule, etc.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read 1cbs.pdb
 Reading from file : (1cbs.pdb) 
 in normal PDB format
 ignoring hydrogen atoms
 ...
 MOLEMAN2 > ch ask

 RESIDUE  PRO     1  1CBS
 New segment : (          1) 
 Because : (First residue) 
 Segment ID (4 char) ? (AAAA) prot
 Chain name (1 char) ? (T) P

 RESIDUE  REA   200  1CBS
 New segment : (          2) 
 Because : (Different type of residue: ORGA) 
 Segment ID (4 char) ? (PROU) RTA
 Chain name (1 char) ? ( ) r

 RESIDUE  HOH   300  1CBS
 New segment : (          3) 
 Because : (Different type of residue: WATE) 
 Segment ID (4 char) ? (RTAB) WATR
 Chain name (1 char) ? (R) w

 Total number of segment/chains found : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain REname - change chain name for selected atoms

 Syntax: CHain REname old new
 old    = old chain name (to be replaced; * means ANY)
 new    = new chain name

 Replaces the old by the new chain name for the selected atoms.  If you
   type all parameters on the command line, you must enclose a space
   in "double quotes".

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se all
 Select ALL atoms
 Selection history : (ALL |) 
 Nr of selected atoms : (       5794) 
 MOLEMAN2 > ch ren x " "
 Replace chain name |X| by | |
 Nr of chain names replaced : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch re 
 Old chain name ? ( ) 
 New chain name ? ( ) x
 Replace chain name | | by |X|
 Nr of chain names replaced : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se all
 ...
 MOLEMAN2 > se and ty prot
 ...
 MOLEMAN2 > ch re * a
 Replace chain name |*| by |A|
 Nr of chain names replaced : (       5487) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain SEgid_rename - change segment id for selected atoms

 Syntax: CHain SEgid_rename old new
 old    = old segment id (to be replaced; * means ANY)
 new    = new segment id

 Replaces the old by the new segment id for the selected atoms.  If you
   type all parameters on the command line, you must enclose segment ids
   with spaces in them in "double quotes".

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch se xxxx " a B"
 Replace segment id |XXXX| by | A B|
 Nr of segment ids replaced : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch seg
 Old segment id ? ( )  a b
 New segment id ? ( ) xxxx
 Replace segment id | A B| by |XXXX|
 Nr of segment ids replaced : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se all
 ...
 MOLEMAN2 > se and ty prot
 ...
 MOLEMAN2 > se negate
 ...
 MOLEMAN2 > ch se * bbbb
 Replace segment id |*   | by |BBBB|
 Nr of segment ids replaced : (        307) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain NAme_selection - set chain name/segment id for selected atoms

 Syntax: CHain NAme_selection chain segid
 chain  = new chain name (= means no change)
 segid  = new segment id (= means no change)

 Set the chain name and/or the segment id for all currently selected
   atoms.  A value of "=" means that no change will take place.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se al
 MOLEMAN2 > se and ty prot
 MOLEMAN2 > ch name = prot
 Give selected atoms chain name |=| and segment id |PROT|
 Nr of chain names replaced : (          0) 
 Nr of segment ids replaced : (       5487) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain FRom_segid - derive chain names from segment ids

 Syntax: CHain FRom_segid [how]
 how    = AUto | ASk

 Generate chain names from segment ids for all atoms.  In automatic mode,
   the chain name will be equal to the last character of the segment id;
   in interactive mode, the user can set the chain name.  This is useful
   for quickly adding chain names for O to a PDB file which comes out
   of X-PLOR.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch fr

 RESIDUE  ALA    86  AAAA
 New chain name : (A) 

 RESIDUE  NAG   501  BBBB
 New chain name : (B) 

 RESIDUE  I     601  CCCC
 New chain name : (C) 

 RESIDUE  THR    85  KKKK
 New chain name : (K) 

 RESIDUE  NAG   501  LLLL
 New chain name : (L) 

 RESIDUE  I     601  MMMM
 New chain name : (M) 

 RESIDUE  CD2   701  XXXX
 New chain name : (X) 

 RESIDUE  HOH   801  WWWW
 New chain name : (W) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain TO_segid - derive segment ids from chain names

 Syntax: CHain TO_segid [how]
 how    = AUto | ASk

 Generate segment ids from chain names for all atoms.  In automatic mode,
   the segment id will be equal to "four times" the chain name; in
   interactive mode, the user can set the chain name.  This is useful
   for quickly adding segment ids for X-PLOR to a PDB file which comes
   out of O.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch to ask

 RESIDUE  ALA A  86      
 Segment id ? (AAAA) 
 New segment id : (AAAA) 

 RESIDUE  NAG B 501      
 Segment id ? (BBBB) 
 New segment id : (BBBB) 
 ...
 RESIDUE  CD2 X 701      
 Segment id ? (XXXX) METL
 New segment id : (METL) 

 RESIDUE  HOH W 801      
 Segment id ? (WWWW) WATR
 New segment id : (WATR) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## CHain OT2_suggest

 This commands screens your structure to find protein chain ends and
   generates coordinates for the two terminal oxygens (needed for
   X-PLOR).  The atoms are not actually added to your structure !!
   Protein chain ends are recognised in a way similar as that described
   for the CHain AUto command.  For this operation to work, at least the
   N, CA and C atoms must be known.

 NOTE: from version 0.21 onwards, the SPlit command will add an OT2
   atom automagically where necessary (provided your segment IDs are
   correct).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ch ot
 Looking for protein chain ends ...

 RESIDUE  ILE    63  1CBS
 ==>  OT1 NOW :   16.286  28.434  35.144 SUGGESTED :   16.306  28.432  35.120
 ==>  OT2 NOW :    0.000   0.000   0.000 SUGGESTED :   14.246  29.041  34.934
 You must add/edit OT1/OT2 yourself !

 RESIDUE  LYS    98  1CBS
 ==>  OT1 NOW :    0.000   0.000   0.000 SUGGESTED :    4.068  25.479  21.799
 ==>  OT2 NOW :    0.000   0.000   0.000 SUGGESTED :    4.140  26.276  23.802
 You must add/edit OT1/OT2 yourself !

 RESIDUE  GLU   137  1CBS
 ==>  OT1 NOW :   34.221  19.175  38.659 SUGGESTED :   34.267  19.157  38.667
 ==>  OT2 NOW :    0.000   0.000   0.000 SUGGESTED :   35.724  18.613  37.173
 You must add/edit OT1/OT2 yourself !

 Nr of chain ends found : (          3) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** ONO COMMANDS

 ## ONo RSr - generate RSR dictionary datablock for a residue type

 Syntax: ONo RSr res_type [file] [res_nr]
 res_typ = type of residue (3 characters; e.g. GLC)
 file    = name of output file (default: automatic)
 res_nr  = residue number (default: first)

 Generate an O datablock for use with the RSR commands for a certain
   type of residue.  If you don't supply a file name, a reasonable
   default will be generated.  If you don't supply a residue number,
   the first residue of the specified type encountered will be used.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono rsr rea
 ONO file type : (RSR_dict) 
 Residue type  : (REA) 
 Residue used  :
 RESIDUE  REA   200  1CBS
 Atoms in residue : (         22) 
 ATOM  1093  C1  REA   200      21.972  29.831  16.739  1.00 15.25      1CBS1315
 ATOM  1094  C2  REA   200      20.921  30.524  15.841  1.00 15.61      1CBS1316
 ...
 ATOM  1114  O2  REA   200      21.840  21.712  27.037  1.00 10.99      1CBS1336
 Output file   : (rea_rsr_dict.odb) 
 Cut-off distance for bonded atoms : (   2.000) 
 Special torsion-angle tolerance   : (   6.000) 
 Datablock name : (RSR_dict_REA) 
 Datablock written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 960301/0.9 at Fri Mar 1 23:52:36 1996 for user gerard
!
! RSR datablock for REA
!
RSR_dict_REA T 2 70
 C1   C2   C3   C4   C5   C6   C7   C8   C9   C10  C11  C12  C13  C14
 C15  C16  C17  C18  C19  C20  O1   O2 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo FIt - generate RS_fit dictionary datablock for a residue type

 Syntax: ONo FIt res_type [file] [res_nr]
 res_typ = type of residue (3 characters; e.g. GLC)
 file    = name of output file (default: automatic)
 res_nr  = residue number (default: first)

 Generate an O datablock for use with the RS_fit command for a certain
   type of residue.  If you don't supply a file name, a reasonable
   default will be generated.  If you don't supply a residue number,
   the first residue of the specified type encountered will be used.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono fit rea
 ONO file type : (RS_fit) 
 Residue type  : (REA) 
 Residue used  :
 RESIDUE  REA   200  1CBS
 Atoms in residue : (         22) 
 ATOM  1093  C1  REA   200      21.972  29.831  16.739  1.00 15.25      1CBS1315
 ...
 ATOM  1114  O2  REA   200      21.840  21.712  27.037  1.00 10.99      1CBS1336
 Output file   : (rea_rs_fit.odb) 
 Cut-off distance for bonded atoms : (   2.000) 
 Special torsion-angle tolerance   : (   6.000) 
 Datablock name : (rsfit_REA) 
 Datablock written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 960301/0.9 at Fri Mar 1 23:59:24 1996 for user gerard
!
! RS-fit datablock for REA
!
rsfit_REA T 2 70
 C1   C2   C3   C4   C5   C6   C7   C8   C9   C10  C11  C12  C13  C14
 C15  C16  C17  C18  C19  C20  O1   O2 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo COnnect - generate connectivity entry for a residue type

 Syntax: ONo COnnect res_type [file] [res_nr]
 res_typ = type of residue (3 characters; e.g. GLC)
 file    = name of output file (default: automatic)
 res_nr  = residue number (default: first)

 Generate an O connectivity entry (to be included in "o.dat") for a certain
   type of residue.  If you don't supply a file name, a reasonable
   default will be generated.  If you don't supply a residue number,
   the first residue of the specified type encountered will be used.
   Two hydrogen atoms will not be connected.  You can set the cut-off
   distance for bonded atoms with the COnstants SEt command (MXBOND).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono con rea
 ONO file type : (Connect) 
 Residue type  : (REA) 
 Residue used  :
 RESIDUE  REA   200  1CBS
 Atoms in residue : (         22) 
 ATOM  1093  C1  REA   200      21.972  29.831  16.739  1.00 15.25      1CBS1315
 ...
 ATOM  1114  O2  REA   200      21.840  21.712  27.037  1.00 10.99      1CBS1336
 Output file   : (rea_connect.dat) 
 Cut-off distance for bonded atoms : (   2.000) 
 Special torsion-angle tolerance   : (   6.000) 
 Nr of bonds : (         22) 
 Nr of ATOM records : (          3) 
 Nr of CONNECT ,,   : (          7) 
 Connect file written (append to all.dat)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
REA
ATOM  C1   C2   C3   C4   C5   C6   C7   C8   C9   C10
ATOM  C11  C12  C13  C14  C15  C16  C17  C18  C19  C20
ATOM  O1   O2 
CONNECT -  C1   C2  C3  C4  C5  C6  C1  C16 +
CONNECT  C1   C17
CONNECT  C5   C18
CONNECT  C6   C7  C8  C9  C10  C11  C12  C13  C14  C15  O1
CONNECT  C9   C19
CONNECT  C13  C20
CONNECT  C15  O2
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo TOrsion - generate torsion entry for a residue type

 Syntax: ONo TOrsion res_type [file] [res_nr]
 res_typ = type of residue (3 characters; e.g. GLC)
 file    = name of output file (default: automatic)
 res_nr  = residue number (default: first)

 Generate an O torsion entry (include in "torsion.o") for a certain
   type of residue.  If you don't supply a file name, a reasonable
   default will be generated.  If you don't supply a residue number,
   the first residue of the specified type encountered will be used.
   Two hydrogen atoms will not be connected.  You can set the cut-off
   distance for bonded atoms with the COnstants SEt command (MXBOND).
   The TORTOL parameter can also be set; it determines if a certain
   torsion is almost "special" (i.e., zero or a multiple of 180 degrees);
   if this is the case, the torsion is assumed to be fixed and no entry
   will be generated for it.

 This appears to be a simple exercise, but it is not.  Consider all-
   trans-retinoic acid with 22 atoms and 22 bonds.  This yields more than
   40 dihedral angles, but only 3 torsion entries ...  The trick is to
   throw away every dihedral which appears to be strongly restrained,
   dihedrals inside rings, etc.  MOLEMAN uses the following criteria
   to reduce the number of torsions:
 - any dihedral which is equal to -180, 0 or +180 degrees (with a
   tolerance of 5 degrees) is rejected as (probably) being strongly
   restrained to its current value (e.g., in conjugated systems)
 - any dihedral K->I->J->L whose rotation affects atom "K" or
   "I" is rejected as (probably) being part of a ring system
 - if the number of atoms affected by the torsion is >= the total
   nr of atoms minus 4, the torsion is rejected.  In this case,
   (for example, a torsion involving a carboxylate) it makes more
   sense to use the torsion defined the other way around (i.e.,
   use torsion L-J-I-K which affects only 1 or 2 atoms, instead of
   K-I-J-L)
 - if a torsion is around the same bond as a previous torsion, and
   it affects the same atoms as that previous torsion, it is rejected
   as being a simple permutation.  This happens, for instance, for
   carboxylates and for aliphatic tails sprouting from a ring, in
   which case there are two equivalent ways to define the torsion
   of the tail relative to the ring)

 The "surviving", freely rotatable torsion angles are written to a
   file.  This file must be *appended* to your standard torsion file
   (ODAT/torsion.o, for instance), and the number of lines in the
   datablock must be updated accordingly.

 Note that this option doesn't know anything about linkages to
   other residues (and therefore is less suited for use with oligomeric
   compounds).  For instance, if you run it on a TRP residue, you'll
   get several unwanted torsions.

 Note: at present, O can only handle a maximum of 12 torsion angles.
   This means you may have to remove some of them (but remember that
   many of them will be defined in two ways, so you can keep the one
   you find most useful of each such pair).

 The following example shows how this works for retinoic acid (residue
   200 in PDB entry 1CBS if you want to try it at home).  Note that
   indeed only the three intuitively reasonable torsions are
   generated: the tail relative to the ring, the ring relative to
   the tail, and the carboxylate relative to the tail !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 All-trans-retinoic is (incorrectly ;-) numbered as follows:

     C16     C19        C20        O21
     |        |          |        /
     C5  C7   C9   C11   C13   C15
    /\\ / \\ / \\ /  \\ /  \\ /   \
  C4  C6    C8  C10   C12   C14    O22
   |  |
  C3  C1--C17
   \  /\
    C2  C18

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono tors rea
 ONO file type : (Torsion) 
 Residue type  : (REA) 
 Residue used  :
 RESIDUE  REA   200  1CBS
 Atoms in residue : (         22) 
 ATOM  1093  C1  REA   200      21.972  29.831  16.739  1.00 15.25      1CBS1315
 ...
 ATOM  1114  O2  REA   200      21.840  21.712  27.037  1.00 10.99      1CBS1336
 Output file   : (rea_torsion.dat) 
 Cut-off distance for bonded atoms : (   2.000) 
 Special torsion-angle tolerance   : (   6.000) 
 Nr of bonds : (         22) 

 DIHEDRAL  C6   C1   C2   C3    -42.76
 Skip -> ring torsion
 ...
 DIHEDRAL  C1   C6   C7   C8    154.33
 Affected atoms : ( C8  C9  C10  C11  C12  C13  C14  C15  C19  C20  O1  O2)
 OKAY ==> new torsion : (TOR1) 

 DIHEDRAL  C5   C6   C7   C8    -32.57
 Affected atoms : ( C8  C9  C10  C11  C12  C13  C14  C15  C19  C20  O1  O2)
 Permutation of : (TOR1) 
 Skip -> permutation

 DIHEDRAL  C8   C7   C6   C1    154.33
 Affected atoms : ( C1  C2  C3  C4  C5  C16  C17  C18) 
 OKAY ==> new torsion : (TOR2) 

 DIHEDRAL  C8   C7   C6   C5    -32.57
 Affected atoms : ( C5  C1  C2  C3  C4  C16  C17  C18) 
 Permutation of : (TOR2) 
 Skip -> permutation

 DIHEDRAL  C6   C7   C8   C9   -179.29
 Skip -> torsion ~ 180
 ...
 DIHEDRAL  C15  C14  C13  C20    -0.15
 Skip -> torsion ~ 0

 DIHEDRAL  C13  C14  C15  O1    -50.98
 Affected atoms : ( O1  O2) 
 OKAY ==> new torsion : (TOR3) 

 DIHEDRAL  C13  C14  C15  O2    129.00
 Affected atoms : ( O2  O1) 
 Permutation of : (TOR3) 
 Skip -> permutation

 DIHEDRAL  O1   C15  C14  C13   -50.98
 Affected atoms : ( C13  C1  C2  C3  C4  C5  C6  C7  C8  C9  C10  C11  C12 
   C16  C17  C18  C19  C20) 
 Skip -> too many affected atoms

 DIHEDRAL  O2   C15  C14  C13   129.00
 Affected atoms : ( C13  C1  C2  C3  C4  C5  C6  C7  C8  C9  C10  C11  C12 
   C16  C17  C18  C19  C20) 
 Skip -> too many affected atoms

 Nr of unique rotatable torsions : (       3) 
 Nr of lines written : (          5) 
 Torsion file written (append to torsion.o)
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
RESIDUE REA
TORSION TOR1 154. C1 C6 C7 C8 C8 C9 C10 C11 C12 C13 C14 C15 C19 C20 \
O1 O2
TORSION TOR2 154. C8 C7 C6 C1 C1 C2 C3 C4 C5 C16 C17 C18
TORSION TOR3 -51. C13 C14 C15 O1 O1 O2
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo DIsulfide - create ODL file to draw disulfide links in O

 Syntax: ONo DIsulfide_odl o_mol [file] [how] [object]
 o_mol  = name of the molecule inside O
 file   = name of the ODL file (default: disulfide.odl)
 how    = Sticks | Lines (default: Sticks)
 object = name of the ODL object in O (default: ssbond)

 Generate an ODL file to draw disulfide links in O.  Draw the file with
   the Draw command in O.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_dis.jpg">
 $$ Example of the use of an ONo DIsulfide ODL file in O</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono dis m1 disu.odl sticks ss_st
 O molecule name : (M1) 
 ODL file name : (disu.odl) 
 Draw as Sticks
 ODL object name : (ss_st) 

 Looking for disulfides ...
 Looking for CYS- SG  atoms ...
 ATOM   496  SG  CYS A  67      26.853  23.275  24.788  1.00 18.16      1FSS 721
 ATOM   719  SG  CYS A  94      27.958  21.920  25.822  1.00  2.00      1FSS 944
 ATOM  1767  SG  CYS A 231      17.706  42.764  23.358  1.00  2.00      1FSS1992
 ATOM  1944  SG  CYS A 254      15.900  18.643  43.219  1.00 14.44      1FSS2169
 ATOM  2032  SG  CYS A 265      17.033  17.112  43.932  1.00 13.67      1FSS2257
 ATOM  3118  SG  CYS A 402      11.202  50.463  20.218  1.00 17.06      1FSS3343
 ATOM  4105  SG  CYS A 521      12.171  51.649  18.881  1.00  2.00      1FSS4330
 ATOM  4264  SG  CYS B   3      -0.622   9.196  15.268  1.00 34.29      1FSS4489
 ATOM  4372  SG  CYS B  17       1.031   6.187  17.911  1.00 53.34      1FSS4597
 ATOM  4405  SG  CYS B  22      -1.328   8.466  17.020  1.00 31.20      1FSS4630
 ATOM  4546  SG  CYS B  39       2.164   5.235  19.293  1.00 20.78      1FSS4771
 ATOM  4556  SG  CYS B  41      -5.604  11.002  25.701  1.00 52.29      1FSS4781
 ATOM  4637  SG  CYS B  52      -4.745  12.199  24.311  1.00 29.91      1FSS4862
 ATOM  4643  SG  CYS B  53      -4.229  13.247  16.868  1.00 42.61      1FSS4868
 ATOM  4686  SG  CYS B  59      -4.012  11.998  15.283  1.00 12.80      1FSS4911
 Nr of CYS SG atoms : (         15) 
 Max SG-SG distance for link : (   2.200) 
 Disulfide #    1    67 1FSS <->    94 1FSS @   2.03 A
 Disulfide #    2   254 1FSS <->   265 1FSS @   2.03 A
 Disulfide #    3   402 1FSS <->   521 1FSS @   2.03 A
 Disulfide #    4     3 1FSS <->    22 1FSS @   2.03 A
 Disulfide #    5    17 1FSS <->    39 1FSS @   2.02 A
 Disulfide #    6    41 1FSS <->    52 1FSS @   2.03 A
 Disulfide #    7    53 1FSS <->    59 1FSS @   2.03 A
 Nr of disulfides : (          7) 
 ODL file written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
begin ss_st                                                                           
  colour green
  stick m1 a67 sg m1 a94 sg 0.20
  stick m1 a254 sg m1 a265 sg 0.20
  stick m1 a402 sg m1 a521 sg 0.20
  stick m1 b3 sg m1 b22 sg 0.20
  stick m1 b17 sg m1 b39 sg 0.20
  stick m1 b41 sg m1 b52 sg 0.20
  stick m1 b53 sg m1 b59 sg 0.20
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
begin ss_li                                                                           
  colour green
  move_atom m1 a67 sg
  line_atom m1 a94 sg
  move_atom m1 a254 sg
  line_atom m1 a265 sg
  move_atom m1 a402 sg
  line_atom m1 a521 sg
  move_atom m1 b3 sg
  line_atom m1 b22 sg
  move_atom m1 b17 sg
  line_atom m1 b39 sg
  move_atom m1 b41 sg
  line_atom m1 b52 sg
  move_atom m1 b53 sg
  line_atom m1 b59 sg
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo WAter_fit_macro - generate O macro to real-space fit all waters

 Syntax: ONo WAter_fit_macro [file]
 file   = name of the O macro (default: water_fit.omac)

 Generate an O macro to real-space fit all waters.  Execute the macro
   inside O with the @ command.  Hint: don't use the graphics when
   you run the macro; this will speed up the fitting considerably !!!

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono water
 File name : (water_fit.omac) 
 Nr of waters to be fitted : (         50) 
 O macro written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 960303/0.10 at Sun Mar 3 22:11:24 1996 for user gerard
!
bell Message Set up for water fitting ...
!
symbol mymol # Molecule name ? #
mol $mymol
!
symbol mymap # Map file name ? #
map_file $mymap
rsr_map $mymap
!
rsr_setup
yes
no
conv
# RS-fit RFAC or RSCC ? #
yes
;
;
20.0
3.5
;
3
10.0
!
bell Message Fitting waters of mol $mymol in map $mymap ...
!
rs_fit J801   ;
rsr_rigid J801   ; yes
!
rs_fit J802   ;
rsr_rigid J802   ; yes
 ...
rs_fit J850   ;
rsr_rigid J850   ; yes
!
Message Calculating new RS-fit values
! copy_db ${mymol}//_residue_rsprefit ${mymol}//_residue_rsfit
rs_fit J801   J850  
!
on_off bell Message Done
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo OOps - generate O macro to run checks for OOPS

 Syntax: ONo OOps o_mol [file]
 o_mol  = name of the molecule inside O
 file   = name of the O macro file (default: pre_oops.omac)

 This commands generates an O macro which, when executed, will run the
   standard checks and write out the necessary datablocks for use with
   OOPS.  Your model must have been read into O before you execute this
   macro (with the @ command in O).  It works fastest if you don't have
   the graphics turned on.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono oops m3
 File name : (pre_oops.omac) 
 O macro written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 960304/0.11 at Tue Mar 5 16:35:40 1996 for user gerard
! File: pre_oops.omac
!
mol M3
yasspa M3 alpha 0.5
yasspa M3 beta 0.8
write M3_residue_name resnam.o ;
write M3_residue_type restyp.o ;
!
pep_flip M3 A86    W850  
write M3_residue_pepflip pepflip.o ;
!
rsc_fit M3 A86    W850  
write M3_residue_rsc rsc.o ;
!
symbol mymap # Map file name ? #
map_file $mymap
rsr_map $mymap
!
rsr_setup
yes
 ...
10.0
!
read odat/rsfit_all.o
rs_fit M3 A86    W850  
write M3_residue_rsfit rsfit_all.o ;
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo XPlor_hydrogens - fix X-PLOR hydrogen names for Asn and Arg

 Syntax: ONo XPlor_hydrogens

 O mutilates HD* and HH* hydrogen atom names from X-PLOR.  This command
   fixes them again.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono xpl
 Fixing hydrogen names for Asn and Arg

 RESIDUE  ASN    91      
 ATOM    51 HD21 ASN    91      14.601  54.916  49.939  1.00  0.00   6
 ATOM    52 HD22 ASN    91      15.605  53.517  50.014  1.00  0.00   6

 RESIDUE  ASN   101      
 ATOM   139 HD21 ASN   101      20.743  36.104  53.964  1.00  0.00   6
 ATOM   140 HD22 ASN   101      22.169  35.310  53.410  1.00  0.00   6

 RESIDUE  ARG   153      
 ATOM   589 HH11 ARG   153       3.392  34.583  57.094  1.00  0.00   6
 ATOM   590 HH12 ARG   153       2.672  33.266  56.241  1.00  0.00   6
 ATOM   592 HH21 ARG   153       3.632  30.818  58.523  1.00  0.00   6
 ATOM   593 HH22 ARG   153       2.799  31.153  57.036  1.00  0.00   6
 ...
 RESIDUE  ASN   443      
 ATOM  6855 HD21 ASN   443      51.984 102.581  98.476  1.00  0.00   6
 ATOM  6856 HD22 ASN   443      51.250 104.024  99.061  1.00  0.00   6
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo CEll - make ODL file for drawing the unit cell

 Syntax: ONo CEll [file] [mode] [col]
 file   = name of ODL file (default: cell.odl)
 mode   = type of graphics object in O (line or solid, default: line)
 col    = colour of the object (default: red)

 With this command you can generate an ODL file that will draw
   the unit cell (as read from the CRYST1 card or entered with
   the PDb CRyst command) in O, either as a set of lines or
   a set of planes (solid mode).

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_cell_solid.jpg">
 $$ Example of the use of an ONo CEll (solid) ODL file in O</A>.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_cell_line.jpg">
 $$ Example of the use of an ONo CEll (line) ODL file in O</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono cell
 ODL file : (cell.odl) 
 Mode     : (line) 
 Colour   : (red) 
 Origin (fract.) : (   0.000    0.000    0.000) 
 Top    (fract.) : (   1.000    1.000    1.000) 
 Origin (cart.)  : (   0.000    0.000    0.000) 
 Top    (cart.)  : (  54.124   45.617   39.426) 
 ODL file written
 MOLEMAN2 > ono cell cell2.odl solid gold
 ODL file : (cell2.odl) 
 Mode     : (solid) 
 Colour   : (gold) 
 Origin (fract.) : (   0.000    0.000    0.000) 
 Top    (fract.) : (   1.000    1.000    1.000) 
 Origin (cart.)  : (   0.000    0.000    0.000) 
 Top    (cart.)  : (  54.124   45.617   39.426) 
 ODL file written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The ODL file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
begin celly
colour red
m      0.000     0.000     0.000
l     40.430     0.000     0.000
l     47.277    39.846     0.000
l      6.847    39.846     0.000
l      0.000     0.000     0.000
m      6.847     5.771    39.426
l     47.277     5.771    39.426
l     54.124    45.617    39.426
l     13.694    45.617    39.426
l      6.847     5.771    39.426
m      0.000     0.000     0.000
l      6.847     5.771    39.426
m     40.430     0.000     0.000
l     47.277     5.771    39.426
m     47.277    39.846     0.000
l     54.124    45.617    39.426
m      6.847    39.846     0.000
l     13.694    45.617    39.426
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 And for a solid cell:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
begin celly
mode solid
colour gold
poly 4
      0.000     0.000     0.000
     40.430     0.000     0.000
     47.277    39.846     0.000
      6.847    39.846     0.000
poly 4
     13.694    45.617    39.426
     54.124    45.617    39.426
     47.277     5.771    39.426
      6.847     5.771    39.426
poly 4
      0.000     0.000     0.000
     40.430     0.000     0.000
     47.277     5.771    39.426
      6.847     5.771    39.426
poly 4
     13.694    45.617    39.426
     54.124    45.617    39.426
     47.277    39.846     0.000
      6.847    39.846     0.000
poly 4
      6.847    39.846     0.000
     13.694    45.617    39.426
      6.847     5.771    39.426
      0.000     0.000     0.000
poly 4
     40.430     0.000     0.000
     47.277     5.771    39.426
     54.124    45.617    39.426
     47.277    39.846     0.000
mode line
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo RIngs - make ODL file for solid planes in rings (Phe, Tyr, etc.)

 Syntax: ONo RIngs [file] [obj] [col]
 file   = name of ODL file (default: rings.odl)
 obj    = name of graphics object in O (default: rings)
 col    = colour of the plane (default: cyan)

 With this command you can generate an ODL file that will draw
   nice semi-transparent planes inside ring compounds (provided
   the atoms in the ring are defined in the "moleman2.lib" library
   file). All ring residues of which at least one atom is currently
   selected will be included.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_rings_prot.jpg">
 $$ Example of the use of an ONo RIngs ODL file (protein) in O</A>.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_rings_na.jpg">
 $$ Example of the use of an ONo RIngs ODL file (nucleic acid) in O</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono ring
 Command > (ono ring) 
 Nr of rings found : (          9) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The ODL file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 000526/2.6.3 at Sat May 27 02:06:11 2000 for gerard
begin rings
  mode solid
  colour cyan
  poly          6
       17.41      17.30      15.66
       16.48      18.24      15.59
       15.24      17.82      15.38
       15.41      16.47      15.30
       16.73      16.10      15.44
       17.41      17.30      15.66
  poly          7
       15.41      16.47      15.30
[...]
       18.36      16.14      11.87
       18.51      14.80      11.69
  mode line
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo MOlray - make trace pseudo-molecule for use with MolRay

 Syntax: ONo MOlray [file] [mode] [mult] [near_far] [for_rev] [resi] [atom]
 file     = name of output PDB file
 mode     = mode selection (only mode PEPT implemented so far)
 mult     = multiplier (non-zero real number)
 near_far = take nearest or farthest neighbours
 for_rev  = forward or reverse sequence order
 resi     = residue type to use in trace molecule (default: "HOH")
 atom     = residue type to use in trace molecule (default: " O  ")

 Generate a trace pseudo-molecule for use with MolRay (if you want
   to "fly" along the backbone in a movie).

 In mode PEPT, points are chosen, one for every peptide plane. The
   normal vector to the least-squares plane of CA(i), C(i), N(i+1),
   CA(i+1) is calculated together with the centre-of-gravity. The
   trace atom is placed at the centre-of-gravity plus the (unit) normal
   vector multiplied by the user-defined multiplier. Note that the
   multiplier can be positive or negative ("above" or "below" the
   first peptide plane). For the second, third, etc. planes, both
   the positive and the negative multiplier will be used to generate
   two possible points. In mode "nearest", the one that is closest
   to the previous trace point will be accepted; in mode "farthest"
   the more distant one will be used instead. Just experiment with
   the various parameters to see what gives the best effect.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read pdb1fss.ent
 [...]
 MOLEMAN2 > select and chain a
 [...]
 MOLEMAN2 > ono mol
 Trace PDB file name ? (molray_trace.pdb) 1fss_trace.pdb
 Mode (PEPT) ? (peptide) 
 Multiplier ? (    1.00) 0.5
 Near or Far nbrs (NEA/FAR) ? (nearest) 
 Forward or reverse (FOR/REV) ? (forward) 

 Opening output file : (1fss_trace.pdb) 
 Mode : (PEPT) 
 Multiplier for normal vector : (   0.500) 
 Near/Far : (NEAR) 
 Forward/reverse : (FORWARD) 
 Trace residue type : (HOH) 
 Trace atom type : ( O) 
 Nr of residues to check : (        532) 
 Nr of trace atoms written : (        531) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo LS_plane_odl - make ODL file for least-squares plane

 Syntax: ONo LS_plane_odl [file] [obj] [col] [border] [nr] [name]
 file   = name of ODL file (default: plane.odl)
 obj    = name of graphics object in O (default: _plane)
 col    = colour of the plane (default: cyan)
 border = size of the border of the plane around the atoms (approx.)
 nr     = plane number (1-20) if you want to store this plane's normal vector
 name   = name for this plane (e.g., name of the residue)

 This command does the same as the LS_plane command, plus:
 - it gives a list of the distances of all atoms to the least-squares
   plane
 - it generates an ODL file which can be drawn in O to show the plane
 - the normal vector of a plane can be stored (up to 20 planes can
   be stored in total), and the angles between any of the stored
   planes can subsequently be listed with the ONo ANgle_ls_planes
   command

 As of version 1.0.3 this command gives *much* better results (i.e.,
   not too big planes through your selected atoms), irrespective of
   the orientation (before, you could get 400 A long planes if they
   were oriented in an unfortunate way ;-).  From version 1.0.4, the
   size of the border around the atoms is a parameter (1 A is typically
   a good value, but there may be cases where you want bigger or
   smaller planes).

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/ono_lsplane.jpg">
 $$ Example of the use of an ONo LS_plane ODL file in O</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se all
 MOLEMAN2 > se an re rea
 MOLEMAN2 > ono ls rea.odl
 Nr of selected atoms : (         22) 
 Centre of Gravity : (  22.065   26.283   20.209) 
 Eigen value 1 =        515.0 Vector :   0.145303 -0.597192  0.788828
 Eigen value 2 =         31.0 Vector :   0.847841  0.486099  0.211834
 Eigen value 3 =          6.7 Vector :  -0.509954  0.638020  0.576955
 Determinant : (   1.000) 
 Eigenvector #3 defines the least-squares plane
 Equation:  -0.509954 X +   0.638020 Y +   0.576955 Z =  17.176491

 ATOM  1093  C1  REA   200  Distance    0.309
 ATOM  1094  C2  REA   200  Distance    0.769
 ATOM  1095  C3  REA   200  Distance   -0.026
 ATOM  1096  C4  REA   200  Distance   -0.043
 ATOM  1097  C5  REA   200  Distance   -0.259
 ATOM  1098  C6  REA   200  Distance   -0.019
 ATOM  1099  C7  REA   200  Distance   -0.193
 ATOM  1100  C8  REA   200  Distance   -0.016
 ATOM  1101  C9  REA   200  Distance   -0.185
 ATOM  1102  C10 REA   200  Distance    0.008
 ATOM  1103  C11 REA   200  Distance   -0.112
 ATOM  1104  C12 REA   200  Distance    0.077
 ATOM  1105  C13 REA   200  Distance    0.002
 ATOM  1106  C14 REA   200  Distance    0.202
 ATOM  1107  C15 REA   200  Distance    0.179
 ATOM  1108  C16 REA   200  Distance    1.449
 ATOM  1109  C17 REA   200  Distance   -0.955
 ATOM  1110  C18 REA   200  Distance   -0.616
 ATOM  1111  C19 REA   200  Distance   -0.621
 ATOM  1112  C20 REA   200  Distance   -0.290
 ATOM  1113  O1  REA   200  Distance   -0.797
 ATOM  1114  O2  REA   200  Distance    1.138

 RMSD to plane : (   0.552) 
 ODL file written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The ODL file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 960412/0.17 at Fri Apr 12 22:57:47 1996 for user gerard
begin plane
  mode solid
  colour cyan
  poly 5
       18.56      20.08      23.97
       18.56      31.74      11.08
       25.30      31.74      17.04
       25.30      20.08      29.94
       18.56      20.08      23.97
  mode line
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ..
 Selection history : (ALL | AND TYpe = PROT | AND CLass = Side | AND 
  REsidu = TRP | AND Residue_nr 109 109 |) 
 Nr of selected atoms : (         10) 
 MOLEMAN2 > ono ls trp109.odl
 Nr of selected atoms : (         10) 
 Centre of Gravity : (  13.617   20.280   29.635) 
 Eigen value 1 =         28.3 Vector :   0.044093  0.093234  0.994667
 Eigen value 2 =         12.4 Vector :  -0.373900  0.924815 -0.070112
 Eigen value 3 =          0.0 Vector :   0.926420  0.368814 -0.075638
 Determinant : (  -1.000) 
 ERROR --- Negative determinant; change hand of inertia axes
 Eigen value 1 =         28.3 Vector :  -0.044093 -0.093234 -0.994667
 Eigen value 2 =         12.4 Vector :   0.373900 -0.924815  0.070112
 Eigen value 3 =          0.0 Vector :  -0.926420 -0.368814  0.075638
 Determinant : (   1.000) 
 Eigenvector #3 defines the least-squares plane
 Equation:  -0.926420 X +  -0.368814 Y +   0.075638 Z = -17.853298

 ATOM   859  CB  TRP   109  Distance   -0.063
 ATOM   860  CG  TRP   109  Distance    0.034
 ATOM   861  CD1 TRP   109  Distance    0.028
 ATOM   862  CD2 TRP   109  Distance    0.021
 ATOM   863  NE1 TRP   109  Distance   -0.002
 ATOM   864  CE2 TRP   109  Distance   -0.009
 ATOM   865  CE3 TRP   109  Distance    0.027
 ATOM   866  CZ2 TRP   109  Distance   -0.028
 ATOM   867  CZ3 TRP   109  Distance    0.010
 ATOM   868  CH2 TRP   109  Distance   -0.018

 RMSD to plane : (   0.029) 
 ODL file written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo INertia_axes_odl - make ODL file for inertia axes of selected atoms

 Syntax: ONo INertia_axes_odl [file] [obj] [col] [length] 
 file   = name of ODL file (default: inertia.odl)
 obj    = name of graphics object in O (default: _inert)
 col    = colour of the plane (default: cyan)
 length = determines how long the axes will be: if length > 0,
          all three axes will be given this length; if length < 0,
          then the three axes will be scaled by the corresponding
          eigenvalues, such that the highest eigenvalue will
          have an axis of length "-length"; if length = 0, then
          the three axes will be 3, 2, and 1 A in length, for
          the axis with the highest, intermediate, and smallest
          eigenvalue, respectively. To get the axes drawn with
          lengths equal to their eigenvalues, run this command
          twice, and use -1 times the largest eigenvalue as the
          length the second time

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono in q4.odl _r321 magenta 0
 Nr of selected atoms : (         22) 
 Centre of Gravity : (  22.065   26.283   20.209) 
 Eigen value 1 =        515.0 Vector :   0.145303 -0.597192  0.788828
 Eigen value 2 =         31.0 Vector :   0.847841  0.486099  0.211834
 Eigen value 3 =          6.7 Vector :  -0.509954  0.638020  0.576955
 Determinant : (   1.000) 
 Eigenvector #3 defines the least-squares plane
 Equation:  -0.509954 X +   0.638020 Y +   0.576955 Z =  17.176491
 Creating ODL file   : (q4.odl) 
 Object name         : (_r321) 
 Axis lengths (A)    : (   3.000    2.000    1.000) 
 ODL file written
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The ODL file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 020927/3.0.5 at Fri Sep 27 23:14:42 2002 for gerard
begin _r321
  colour magenta
  m       22.07      26.28      20.21
  l       22.50      24.49      22.58
  m       22.07      26.28      20.21
  l       23.76      27.25      20.63
  m       22.07      26.28      20.21
  l       21.56      26.92      20.79
end_object
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## ONo ANgle_ls_planes - calculate angles between least-squares planes

 Syntax: ONo ANgle_ls_planes [nr1] [nr2]
 nr1    = number of the first plane (default: all planes)
 nr2    = number of the second plane (default: all planes)

 Least-squares planes calculated and stored with the ONo LS_plane_odl
   command can be compared here. This means that the angle between
   pairs of planes can be calculated and listed.  If you don't
   provide any parameters to this command, all pairs will be listed.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > ono ang 4 3
 Command > (ono ang 4 3) 

 Plane #   4 [G455      ] and plane #   3 [G454      ]
 COS (angle) = -0.60157 -> Angle =   126.98 =    53.02
 MOLEMAN2 > ono ang 1
 Command > (ono ang 1) 

 Plane #   1 [G452      ] and plane #   2 [G453      ]
 COS (angle) =  0.86964 -> Angle =    29.58 =   150.42

 Plane #   1 [G452      ] and plane #   3 [G454      ]
 COS (angle) = -0.68560 -> Angle =   133.28 =    46.72

 Plane #   1 [G452      ] and plane #   4 [G455      ]
 COS (angle) =  0.69565 -> Angle =    45.92 =   134.08
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** DISTANCE COMMANDS

 ## DIstance PLot - make 2D contour plot of distances between selected atoms

 Syntax: DIstance PLot file
 file   = name of the O2D contour plot file

 This command enables you to generate a plot file for O2D to contour the
   distances between all currently selected atoms.

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/di_pl.gif">
 $$ Example of a DIstance PLot</A>.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se an ch a
 ...
 MOLEMAN2 > di pl chaina_dist.plt
 Distance plot file   : (chaina_dist.plt) 
 Nr of selected atoms : (       2740) 
 ERROR --- Too many atoms selected for 2D contour plot
 Maximum allowed : (        724) 
 MOLEMAN2 > se and atom " CA "
 ...
 MOLEMAN2 > di pl caca.plt
 Distance plot file   : (caca.plt) 
 Nr of selected atoms : (        362) 
 Nr of distances : (     131044) 
 Average distance : (  25.497) 
 St. deviation    : (   9.705) 
 Maximum distance : (  54.998) 
 Plot file written
 CPU total/user/sys :       2.5       2.3       0.1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
REMARK Distance plot
REMARK Created by MOLEMAN2 V. 960304/0.11 at Mon Mar 4 17:12:54 1996 for user gerard
REMARK Generated from PDB file hydro.pdb
REMARK Selected atoms: NON-HYDROGEN | AND CHain = A | AND ATom = CA |
REMARK
XLABEL Selected atom
YLABEL Selected atom
NLEVEL      7
LEVELS
6 7 8  9 10 11 12
COLOUR
1 1 5  5 2 6 4
XPOINT    362
YPOINT    362
XLIMIT      1   362
YLIMIT      1   362
ZVALUE *
       0.0       3.8       6.6      10.3      12.7      12.7       9.6
      11.6      11.9      10.1       9.4      12.2      13.2      14.3
 ...
       9.2       5.5       3.8       0.0
END   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DIstance DIstribution - print histogram of distances for selected atoms

 Syntax: DIstance DIstribution [bin_size]
 bin_size = size of distance bins (default: 2.0)

 This command prints a histogram of inter-atomic distances for all
   selected atoms.  This may be useful to find a Patterson integration
   radius for molecular replacement calculations.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se an ch a
 ...
 MOLEMAN2 > di di 3
 Nr of selected atoms : (       2740) 
 Bin size : (   3.000) 
 Nr of distances : (    3752430) 
    lower    upper     # dist    # cumul   % dist  % cumul
      0.0      3.0       8119       8119    0.216    0.216
      3.0      6.0      46202      54321    1.231    1.448
      6.0      9.0     103187     157508    2.750    4.197
 ...
     54.0     57.0        704    3752393    0.019   99.999
     57.0     60.0         37    3752430    0.001  100.000
 CPU total/user/sys :      13.3      13.3       0.1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DIstance LIst - list specific distances for selected atoms

 Syntax: DIstance LIst [lower] [upper]
 lower = min distance to list (default: 0.0)
 upper = max distance to list (default: 1.0)

 This will list any short distances between the currently selected
   atoms that lie in the selected range. This can be used to find
   errors in coordinate files (atoms too close to one another;
   use an upper cut-off of 0.8 or so if hydrogens are present).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re pdb1bp8.ent
 ...
 MOLEMAN2 > dis lis 0 0.8
 Command > (dis lis 0 0.8) 
 Nr of selected atoms : (        664) 
 Lower cut-off : (   0.000) 
 Upper cut-off : (   0.800) 

 Distance:     0.78 A between:
 ATOM     1  O5*   A A   1      -3.605   0.160  -1.035  1.00  0.00           O
 ATOM     2  C5*   A A   1      -3.981  -0.413  -1.398  1.00  0.00           C

 Distance:     0.45 A between:
 ATOM   928  CC7 DXB C   3      -5.454  -5.084   7.980  1.00  0.00           C
 ATOM   952 HM71 DXB C   3      -5.313  -4.887   7.596  1.00  0.00           H
 ...
 Distance:     0.50 A between:
 ATOM  1110 HM52 DXB F   3       6.115  18.492   2.924  1.00  0.00           H
 ATOM  1111 HM53 DXB F   3       5.873  18.325   3.326  1.00  0.00           H

 Nr of distances checked : (     220116) 
 Nr of distances listed  : (         64) 
 Minimum distance : (   0.140) 
 Maximum distance : (   0.782) 
 Average distance : (   0.504) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DIstance CHains - list contacts between two chains

 Syntax: DIstance CHains chain1 chain2 [cut-off]
 cut-off = max distance to list (default: 3.5)

 This will list any contacts between the two chains provided by the user.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read pdb1fss.ent
 [...]
 MOLEMAN2 > di ch a b 3.5
 Chain 1 : (A) 
 Chain 2 : (B) 
 Cut-off (A) : (   3.500) 
 Nr of atoms in chain 1 : (       4242) 
 Nr of atoms in chain 2 : (        464) 

 Contact:     3.28 A
 ATOM   516  CA  TYR A  70      15.296  21.623  24.210  1.00  3.71      1FSS 741
 ATOM  4303  O   THR B   8      13.977  18.623  24.132  1.00  2.00      1FSS4528

 Contact:     3.18 A
 ATOM   526  OH  TYR A  70       9.231  22.863  22.093  1.00  3.71      1FSS 751
 ATOM  4510  O   VAL B  34       7.339  20.548  23.183  1.00  7.23      1FSS4735

 Contact:     2.86 A
 ATOM   527  N   VAL A  71      14.586  20.579  22.133  1.00 24.49      1FSS 752
 ATOM  4303  O   THR B   8      13.977  18.623  24.132  1.00  2.00      1FSS4528
 [...]
 Contact:     2.63 A
 ATOM  2593  O   TYR A 334       2.776  29.911  22.350  1.00 10.53      1FSS2818
 ATOM  4490  N   LYS B  32       2.754  28.159  24.308  1.00 22.68      1FSS4715

 Contact:     3.01 A
 ATOM  2647  NZ  LYS A 341       4.821  24.232   8.633  1.00 19.13      1FSS2872
 ATOM  4706  OH  TYR B  61       4.124  21.925  10.436  1.00 25.01      1FSS4931

 Nr of contacts : (         36) 
 CPU total/user/sys :       1.9       1.9       0.0
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DIstance SHort - list short non-bonded contacts for selected atoms

 Syntax: DIstance SHort [cut-off]
 cut-off = max distance to list (default: 2.4)

 This will list any short non-bonded and non-1-3 contacts between the
   currently selected atoms.

 NOTE!!! Any pair of atoms closer than (by default) 2.0 \A will be
   considered to be bonded and will therefore not be listed here
   (even if it is a bad contact - the program does not know any
   better)!!! The same applies for 1-3 contacts.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > di sh 2.6
 Nr of selected atoms : (       5794) 
 Cut-off : (   2.600) 
 Ditto, bonded atoms : (   2.000) 

 Short contact:     2.56 A
 ATOM    86  O   GLY    95       9.825  49.353  58.166  1.00 17.71      AAAA
 ATOM   662  ND2 ASN   161       9.523  47.419  59.810  1.00 26.48      AAAA

 Short contact:     2.60 A
 ATOM   522  OE2 GLU   146       6.642  27.638  53.763  1.00 18.98      AAAA
 ATOM  7142 CD+2 CD2   701       5.513  25.493  52.829  1.00 19.74      XXXX
 ...
 Short contact:     2.55 A
 ATOM  5594  OD1 ASN   307      47.820  97.543  83.813  1.00 18.24      KKKK
 ATOM  7175  O1  HOH   811      49.205  95.513  83.148  1.00 15.75      WWWW

 Short contact:     2.03 A
 ATOM  6190  SG  CYS   368      51.938  82.787  85.190  1.00 10.75      KKKK
 ATOM  6604  SG  CYS   415      52.449  81.267  83.945  1.00 13.57      KKKK

 Nr of distances      : (   16782321) 
 Nr of short contacts : (         12) 
 CPU total/user/sys :      11.6      11.6       0.1
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## DIstance SElect - list all distances involving selected atoms

 Syntax: DIstance SElect [cut-off] [mode]
 cut-off = max distance to list (default: 2.4)
 mode = ALl = list distances to all atoms (default), or
        SElected = list distances to other selected atoms, or
        UNselected = list distances to unselected atoms

 This will list the distances of all selected atoms to other
   atoms, provided they are shorter than the cut-off value provided.
   This can be used to quickly find the atoms that coordinate a
   metal, or all atoms surrounding a ligand, etc.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > read 1guh.pdb
 [...]
 MOLEMAN2 > sel num and res 209 222
 [...]
 MOLEMAN2 > sel and type prot
 [...]
 MOLEMAN2 > sel and chain a
 [...]
 MOLEMAN2 > dist sele 3.5 unse
 Nr of selected atoms : (        125) 
 Cut-off (A) : (   3.500) 
 Distances to UNselected atoms

 Distance:     3.46 A
 ATOM  1672  N   ASP A 209      98.442  23.509  14.741  1.00 54.82      1GUH1792
 ATOM  1664  N   MET A 208      96.305  21.623  12.786  1.00 41.66      1GUH1784

 [...]

 Distance:     3.26 A
 ATOM  1711  CD2 LEU A 213      94.899  24.438  20.484  1.00 36.30      1GUH1831
 ATOM   880  O   PRO A 110      93.705  21.664  21.714  1.00 49.62      1GUH1000

 Distance:     3.17 A
 ATOM  1728  OE1 GLU A 215      95.617  32.077  12.568  1.00 95.20      1GUH1848
 ATOM    77  CD2 PHE A  10      92.708  30.825  12.354  1.00 32.44      1GUH 197

 Distance:     3.49 A
 ATOM  1734  CB  ALA A 216      92.174  29.492  16.719  1.00 24.52      1GUH1854
 ATOM    80  CZ  PHE A  10      91.581  28.942  13.329  1.00 32.44      1GUH 200

 Distance:     3.50 A
 ATOM  1761  CG2 ILE A 219      89.812  36.108  14.693  1.00 30.69      1GUH1881
 ATOM   281  CG2 ILE A  35      89.641  37.143  11.354  1.00 34.96      1GUH 401

 Distance:     3.47 A
 ATOM  1769  CD1 PHE A 220      86.603  33.420  15.496  1.00 23.64      1GUH1889
 ATOM   327  CD2 LEU A  41      85.790  36.770  15.095  1.00 23.21      1GUH 447

 Distance:     3.44 A
 ATOM  1772  CE2 PHE A 220      88.307  31.663  14.246  1.00 23.64      1GUH1892
 ATOM    76  CD1 PHE A  10      90.428  30.428  11.841  1.00 32.44      1GUH 196

 Distance:     3.32 A
 ATOM  1783  NH1 ARG A 221      86.456  39.634  18.545  1.00 86.40      1GUH1903
 ATOM   335  OD2 ASP A  42      86.358  42.750  17.404  1.00 66.68      1GUH 455

 Distance:     2.89 A
 ATOM  1784  NH2 ARG A 221      86.648  41.439  19.966  1.00 86.40      1GUH1904
 ATOM   335  OD2 ASP A  42      86.358  42.750  17.404  1.00 66.68      1GUH 455

 Nr of distances : (     440125) 
 Nr listed       : (         16) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se an res cd2
 AND atom selection
 With atoms for which : (RES) 
 Equals : (CD2) 
 Selection history : (ALL | AND REsidu = CD2 |) 
 Nr of selected atoms : (          3) 
 MOLEMAN2 > di se 3.0
 Nr of selected atoms : (          3) 
 Cut-off : (   3.000) 

 Distance:     2.94 A
 ATOM  7142 CD+2 CD2   701       5.513  25.493  52.829  1.00 19.74      XXXX
 ATOM   520  CD  GLU   146       7.727  27.400  53.189  1.00 18.44      AAAA

 Distance:     2.64 A
 ATOM  7142 CD+2 CD2   701       5.513  25.493  52.829  1.00 19.74      XXXX
 ATOM   521  OE1 GLU   146       7.842  26.597  52.237  1.00 19.27      AAAA
 ...
 Distance:     2.60 A
 ATOM  7144 CD+2 CD2   703      17.470  55.275  21.475  1.00 36.65      XXXX
 ATOM  2333  NE2 HIS   340      15.878  54.722  23.452  1.00 19.18      AAAA

 Nr of distances : (      17379) 
 Nr listed       : (          8) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se an re i
 AND atom selection
 With atoms for which : (RE) 
 Equals : (I) 
 Selection history : (ALL | AND REsidu = I |) 
 Nr of selected atoms : (          2) 
 MOLEMAN2 > di se 4
 Nr of selected atoms : (          2) 
 Cut-off : (   4.000) 

 Distance:     3.53 A
 ATOM  3531  I   I   C 601      30.079  30.849  34.376  1.00 23.10      CCCC
 ATOM   822  CB  ALA A 178      30.484  31.903  31.031  1.00 21.62      AAAA

 Distance:     3.21 A
 ATOM  3531  I   I   C 601      30.079  30.849  34.376  1.00 23.10      CCCC
 ATOM   839  O   ALA A 180      30.976  27.917  33.428  1.00 24.14      AAAA
 ...
 Distance:     3.95 A
 ATOM  7106  I   I   M 601      45.445  80.203  80.802  1.00 48.25      MMMM
 ATOM  7241  O1  HOH W 833      42.484  77.927  82.087  1.00 11.16      WWWW

 Nr of distances : (      11586) 
 Nr listed       : (          6) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** SQUENCE COMMANDS

 ## SQuence LIst - list sequence of current molecule(s)

 Syntax: SQuence LIst how
 how    = 3-letter code | 1-letter code | Full

 List the sequence (note that the one-letter codes are defined in the
   library file).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq li 1

 Sequence in 1-letter code:
 ATYCGNPFVG VTPWANAYYA CEVCCLAIPC LTGAMATAAA AVAKVPCFMW LDTLDKTPLM
 EQTLADIRTA NKNGGNYAGQ FVVYDLPDRD CAALACNGEY CIADGGVAKY KNYIDTIRQI
 ...
 FQAYFVQLLT NANPCFL??? ?????????? ?????????? ?????????? ??????????
 ?????????? ?????????? ??
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq li 3

 Sequence in 3-letter code:
 ALA THR TYR SER GLY ASN PRO PHE VAL GLY VAL THR PRO TRP ALA
 ASN ALA TYR TYR ALA SER GLU VAL SER SER LEU ALA ILE PRO SER
 ...
 HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH HOH
 HOH HOH HOH HOH HOH HOH HOH
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq li f
 RESIDUE  ALA    86  AAAA
 RESIDUE  THR    87  AAAA
 RESIDUE  TYR    88  AAAA
 RESIDUE  SER    89  AAAA
 ...
 RESIDUE  HOH   850  WWWW
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SQuence PIr - write sequence to a PIR file

 Syntax: SQuence PIr file [seq_name] [title]
 file    = PIR output file name
 seq_nam = PIR sequence name
 title   = any text

 Write the sequence of the currently selected residues to a PIR file.  A
   residue is considered selected if at least one of its atoms is selected.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > re 1cel.pdb
 MOLEMAN2 > se and type prot
 MOLEMAN2 > se and chain a
 MOLEMAN2 > sq pir q
 Nr of selected residues  : (        434) 
 Total number of residues : (       1404) 
QSACTLQSET HPPLTWQKCS SGGTCTQQTG SVVIDANWRW THATNSSTNC YDGNTWSSTL
CPDNETCAKN CCLDGAAYAS TYGVTTSGNS LSIGFVTQSA QKNVGARLYL MASDTTYQEF
TLLGNEFSFD VDVSQLPCGL NGALYFVSMD ADGGVSKYPT NTAGAKYGTG YCDSQCPRDL
KFINGQANVE GWEPSSNNAN TGIGGHGSCC SEMDIWEANS ISEALTPHPC TTVGQEICEG
DGCGGTYSDN RYGGTCDPDG CDWNPYRLGN TSFYGPGSSF TLDTTKKLTV VTQFETSGAI
NRYYVQNGVT FQQPNAELGS YSGNELNDDY CTAEEAEFGG SSFSDKGGLT QFKKATSGGM
VLVMSLWDDY YANMLWLDST YPTNETSSTP GAVRGSCSTS SGVPAQVESQ SPNAKVTFSN
IKFGPIGSTG NPSG
 PIR file written ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! Created by MOLEMAN2 V. 970211/1.1.3 at Tue Feb 11 17:28:33 1997 for user gerard

>P1;PIRSEQ
No title
QSACTLQSET HPPLTWQKCS SGGTCTQQTG SVVIDANWRW THATNSSTNC YDGNTWSSTL
CPDNETCAKN CCLDGAAYAS TYGVTTSGNS LSIGFVTQSA QKNVGARLYL MASDTTYQEF
TLLGNEFSFD VDVSQLPCGL NGALYFVSMD ADGGVSKYPT NTAGAKYGTG YCDSQCPRDL
KFINGQANVE GWEPSSNNAN TGIGGHGSCC SEMDIWEANS ISEALTPHPC TTVGQEICEG
DGCGGTYSDN RYGGTCDPDG CDWNPYRLGN TSFYGPGSSF TLDTTKKLTV VTQFETSGAI
NRYYVQNGVT FQQPNAELGS YSGNELNDDY CTAEEAEFGG SSFSDKGGLT QFKKATSGGM
VLVMSLWDDY YANMLWLDST YPTNETSSTP GAVRGSCSTS SGVPAQVESQ SPNAKVTFSN
IKFGPIGSTG NPSG
*
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SQuence GLyco_sites - list potential N-glycosylation sites

 List possible sites for N-glycosylation in your protein(s).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq gl
 Looking for potential N-glycosylation sites
 Consensus: Asn - not Pro - Ser/Thr

 RESIDUE  ASN   289  AAAA
 RESIDUE  ALA   290  AAAA
 RESIDUE  SER   291  AAAA

 RESIDUE  ASN   310  AAAA
 RESIDUE  ILE   311  AAAA
 RESIDUE  THR   312  AAAA

 RESIDUE  ASN   289  KKKK
 RESIDUE  ALA   290  KKKK
 RESIDUE  SER   291  KKKK

 RESIDUE  ASN   310  KKKK
 RESIDUE  ILE   311  KKKK
 RESIDUE  THR   312  KKKK
 Potential sites found : (          4) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SQuence MOtif - search for a sequence motif

 Syntax: SQuence MOtif motif
 motif  = sequence motif in 1-letter code ("?" can be used as a 
          wild-card)

 Search the sequence of your molecule(s) for a certain motif.  Enter the
   motif in one-letter code (no spaces; question marks indicate residues
   which may be matched to any type).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq mo n?t
 Look for sequence motif : (N?T) 

 RESIDUE  ASN   310  AAAA
 RESIDUE  ILE   311  AAAA
 RESIDUE  THR   312  AAAA

 RESIDUE  ASN   310  KKKK
 RESIDUE  ILE   311  KKKK
 RESIDUE  THR   312  KKKK
 Nr of hits : (          2) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > sq mo dir??nk?ggn??gq
 Look for sequence motif : (DIR??NK?GGN??GQ) 

 RESIDUE  ASP   151  AAAA
 RESIDUE  ILE   152  AAAA
 RESIDUE  ARG   153  AAAA
 RESIDUE  THR   154  AAAA
 ...
 Nr of hits : (          2) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SQuence COunt_residue_types - count number of residues of each type

 This command will list the number of occurrences of each residue
   type defined in the library among the currently selected residues.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and chain a
 AND atom selection
 With atoms for which : (CHAIN) 
 Equals : (A) 
 Selection history : (ALL | AND CHain = A |) 
 Nr of selected atoms : (       3518) 
 MOLEMAN2 > sq count
 Nr of selected residues : (        701) 
 ERROR --- Residue not in library :
 RESIDUE  IBZ A 436  1CEL

     51 |G| GLY = GLYCINE
     27 |A| ALA = ALANINE
     46 |T| THR = THREONINE
     20 |C| CYS = CYSTEINE
 ...
     13 |K| LYS = LYSINE
      1 |Q| PCA = PYROGLUTAMATE
    264 |?| HOH = WATER
      1 |?| NAG = N-ACETYL-GLUCOSAMINE GLCNAC 2-ACETAMIDO-2-DEOXY-D-GLUCOSE
      1 |?| GLC = ALPHA-D-GLUCOSE
 Residues not in library : (          1) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## SQuence EXtinction_280 - guestimate molar extinction at 280 nm

 This command guestimates the molar extinction coefficient (using
   the currently selected residues; if you have non-physiological
   NCS or aggregation make sure to select only the physiological
   entities).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > se and chain a
 ...
 MOLEMAN2 > sq ext
 Reference: Gill & Von Hippel,
 Anal. Biochem. 182: 319-326 (1989).
 e280 = (1280*TYR + 5690*TRP + 120*CYS)
 accuracy roughly 5%; units M-1 cm-1
 Nr of selected residues : (        701) 
 Nr of TYR      : (      20) 
 Nr of TRP      : (       9) 
 Nr of CYS      : (      20) 
 e280 (M-1 cm-1) ~ (  7.921E+04) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** AUTO COMMANDS

 These commands can be used to generate bits of poly-Ala helix and
   strand out of the blue (a.k.a., "to spink" atoms).
 All new atoms will be added to any atoms you already have in memory,
   so you may want to use the DELETE command prior to issuing an
   AUto command.
 Automatically generated strands tend to give poor planarity
   messages in the PRotein MC command, even though omega is ~180
   degrees.  Some minor idealisation should fix that.
 Since in the AUto BOnes and AUto SSe commands only two points are
   used per helix or strand, the rotation aroudn its axis is
   undefined.  Therefore, inside O, you probably have to use
   Move_zone (or RSR_rigid) in order to fit the density.

 NOTE: the algorithm is much better than that used in the old
   MOLEMAN (the latter sometimes gave rubbish for small bits
   of structure !!!).  Also, it no longer uses the random-number
   generator ;-)

 ## AUto SPink - generate N-residue poly-Ala helix or strand

 Syntax: AUto SPink type nr_res
 type    = Alpha | Beta
 nr_res  = number of residues to generate

 This command has been named in memory of Neil Spink who first
   suggested a new O command to "spink" atoms out of the blue
   (FEBS course in Aarhus, 1992).

 A helix or strand of the requested number of residues will be
   generated.  The first CA will be at (0,0,0).  The N-th CA will
   be roughly at X=1.41*N for a helix, or at X=3.30*N for a strand
   with zero Y and Z coordinates (these formulae are only used
   if N > 10; if 1 < N < 11, the actual numbers are different;
   the program keeps them in two small tables so it can "predict"
   appropriate start and end coordinates).

 Other atom and residue attributes are set as follows (most can be
   modified afterwards, if you want):
 - atom numbering will be continuous
 - residue numbering: starts at 1, if there are no atoms in memory,
   or at I+2, where I is the residue number of the last atom
   currently in memory
 - chain name will be 'Z' if there aren't any atoms, or one higher
   in the alphabet than that of the last atom in memory (but never
   "exceeding" 'Z' of course)
 - residue type will be ALA; atom names as usual for alanines
 - insert character is blank
 - all Bs are set to 20.0 A2; all occupancies to 1.0

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > auto spink beta 3
 Length (A) : (   6.610) 
 Start CA coordinates : (   0.000    0.000    0.000) 
 End   CA coordinates : (   6.610    0.000    0.000) 
 Nr of residues  : (          3) 
 Nr of new atoms : (         15) 
 Actual distance terminal CAs (A) : (   6.610) 
 Actual N-term CA : (   0.000    0.000    0.000) 
 Actual C-term CA : (   6.610    0.000    0.000) 
 RMSD (A) : (   0.000) 

 Total nr of residues      : (          3) 
 Nr of amino acid residues : (          3) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (          0) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          0) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...
 MOLEMAN2 > au sp alpha 3
 Length (A) : (   5.540) 
 Start CA coordinates : (   0.000    0.000    0.000) 
 End   CA coordinates : (   5.540    0.000    0.000) 
 Nr of residues  : (          3) 
 Nr of new atoms : (         15) 
 Actual distance terminal CAs (A) : (   5.537) 
 Actual N-term CA : (   0.000    0.000    0.000) 
 Actual C-term CA : (   5.537    0.000    0.000) 
 RMSD (A) : (   0.002) 

 Total nr of residues      : (          6) 
 Nr of amino acid residues : (          6) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (          0) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          0) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 When saved, the PDB file may look as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
REMARKCreated by MOLEMAN2 V. 960414/0.18 at Mon Apr 15 01:06:26 1996 for user gerard
CRYST1    1.000    1.000    1.000  90.00  90.00  90.00 P 1           1
ORIGX1      1.000000  0.000000  0.000000        0.00000
ORIGX2      0.000000  1.000000  0.000000        0.00000
ORIGX3      0.000000  0.000000  1.000000        0.00000
SCALE1      1.000000  0.000000  0.000000        0.00000
SCALE2      0.000000  1.000000  0.000000        0.00000
SCALE3      0.000000  0.000000  1.000000        0.00000
ATOM      1  N   ALA Z   1      -1.214   0.817   0.081  1.00 20.00
ATOM      2  CA  ALA Z   1       0.000   0.000   0.000  1.00 20.00
ATOM      3  C   ALA Z   1       1.211   0.932  -0.081  1.00 20.00
ATOM      4  O   ALA Z   1       1.155   1.974  -0.777  1.00 20.00
ATOM      5  CB  ALA Z   1      -0.004  -0.896  -1.251  1.00 20.00
ATOM      6  N   ALA Z   2       2.094   0.809   0.892  1.00 20.00
 ...
ATOM     15  CB  ALA Z   3       6.525  -1.059  -1.126  1.00 20.00
ATOM     16  N   ALA Z   5       0.389   1.419  -0.158  1.00 20.00
 ...
ATOM     27  CA  ALA Z   7       5.537   0.000   0.000  1.00 20.00
ATOM     28  C   ALA Z   7       5.285  -0.699   1.326  1.00 20.00
ATOM     29  O   ALA Z   7       6.166  -1.424   1.825  1.00 20.00
ATOM     30  CB  ALA Z   7       5.785   1.503   0.276  1.00 20.00
END   
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## AUto BOnes - generate helix or strand between two points in space

 Syntax: AUto BOnes type x1 y1 z1 x2 y2 z2
 type    = Alpha | Beta
 x1..z2  = coordinates of first and last CA atom

 This command can be used if you want to generate a helix or strand
   between two particular points in space.  Usually, these will
   be coordinates read from a skeleton (bones) in O.  Note the
   directionality: (x1,y1,z1) specifies the N-terminus.
 If you want to generate more than one helix or strand, use the
   AUto SSe command instead.
 Atom and residue attributes are set in the same fashion as with
   the AUto Spink command (quod vide).

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > aut bones alpha 46 9 112  43 13 110
 Length (A) : (   5.385) 
 Start CA coordinates : (  46.000    9.000  112.000) 
 End   CA coordinates : (  43.000   13.000  110.000) 
 Nr of residues  : (          3) 
 Nr of new atoms : (         15) 
 Actual distance terminal CAs (A) : (   5.537) 
 Actual N-term CA : (  46.000    9.000  112.000) 
 Actual C-term CA : (  42.915   13.113  109.944) 
 RMSD (A) : (   0.107) 

 Total nr of residues      : (          3) 
 Nr of amino acid residues : (          3) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (          0) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          0) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## AUto SSe - generate strands and helices from a DEJAVU SSE file

 Syntax: AUto SSe filename
 filename = name of a DEJAVU SSE file

 If you have delineated secondary structure elements (SSEs) in your
   skeleton (bones) already, for instance to search the fold database
   with DEJAVU, you can easily generate poly-Ala fragments corresponding
   to the SSEs you found.  Such an SSE file (see the DEJAVU manual)
   looks as follows:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! ===  test
!
MOL    test
NOTE   sse test file moleman2
PDB    ./m1a.pdb
!
ALPHA 'A1' 'A82' 'A87' 6 43.023 3.630 102.404 51.740 7.245 100.634
ALPHA 'A2' 'A89' 'A91' 3 49.811 10.893 104.060 54.432 12.827 103.655
BETA  'B1' 'A99' 'A101' 3 52.141 14.649 111.454 51.195 21.767 112.558
ALPHA 'A3' 'A103' 'A110' 8 56.050 25.675 109.872 52.074 27.789 101.676
ALPHA 'A4' 'A118' 'A127' 10 49.546 30.795 110.663 39.466 20.855 114.772
BETA  'B2' 'A135' 'A137' 3 50.470 15.703 117.437 47.613 11.238 114.386
ALPHA 'A5' 'A138' 'A141' 4 46.482 8.779 111.744 43.362 12.567 109.661
ENDMOL
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 All lines except those beginning with 'ALPHA' or 'BETA' are ignored.
   Each SSE is defined by one ALPHA or BETA line.  The other items on
   such a line are:
 - 'A1' = name of the SSE (ignored)
 - 'A82' 'A87' - name of first and last residue; these are used to
   derive the chain and insert name (in this case, 'A' and blank,
   respectively); also, if the second residue number is *LOWER*
   than the first, the program will swap the start and end coordinates
 - 6 - the number of residues; if positive, this will be the actual
   number of residues generated; if zero or negative, the program will
   figure out the number of residues from the distance between the
   start and end points itself
 - 43.023 3.630 102.404 = approximate coordinates of first CA atom
 - 51.740 7.245 100.634 = approximate coordinates of last CA atom

 In other words: the first and last residue name define the directionality
   and the names of the new residues; if you don't know exactly how
   many residues there are, use zero or a negative number for the number
   of residues.  Other atom and residue parameters are set in the same
   fashion as with the AUto SPink command (quod vide).

 Executing this command with the SSE file shown above yields:

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > au sse trca.sse
 MOLEMAN2 > au sse trca.sse
 > (MOL    trca) 
 > (NOTE   calmodulin m1a) 
 > (PDB    ./m1a.pdb) 

 > (ALPHA 'A1' 'A82' 'A87' 6 43.023 3.630 102.404 51.740 7.245 100.634) 
 Length (A) : (   9.601) 
 Start CA coordinates : (  43.023    3.630  102.404) 
 End   CA coordinates : (  51.740    7.245  100.634) 
 Nr of residues  : (          6) 
 Nr of new atoms : (         30) 
 Actual distance terminal CAs (A) : (   8.201) 
 Actual N-term CA : (  43.023    3.630  102.404) 
 Actual C-term CA : (  50.469    6.718  100.892) 
 RMSD (A) : (   0.990) 

 ...

 > (BETA  'B1' 'A99' 'A101' 3 52.141 14.649 111.454 51.195 21.767 112.558) 
 Length (A) : (   7.265) 
 Start CA coordinates : (  52.141   14.649  111.454) 
 End   CA coordinates : (  51.195   21.767  112.558) 
 Nr of residues  : (          3) 
 Nr of new atoms : (         15) 
 Actual distance terminal CAs (A) : (   6.610) 
 Actual N-term CA : (  52.141   14.649  111.454) 
 Actual C-term CA : (  51.280   21.125  112.458) 
 RMSD (A) : (   0.463) 

 ...

 > (ALPHA 'A5' 'A138' 'A141' 4 46.482 8.779 111.744 43.362 12.567 109.661) 
 Length (A) : (   5.331) 
 Start CA coordinates : (  46.482    8.779  111.744) 
 End   CA coordinates : (  43.362   12.567  109.661) 
 Nr of residues  : (          4) 
 Nr of new atoms : (         20) 
 Actual distance terminal CAs (A) : (   5.086) 
 Actual N-term CA : (  46.482    8.779  111.744) 
 Actual C-term CA : (  43.505   12.393  109.757) 
 RMSD (A) : (   0.173) 
 > (ENDMOL) 
 New atoms : (        186) 

 Total nr of residues      : (         37) 
 Nr of amino acid residues : (         37) 
 Nr of nucleic acids       : (          0) 
 Nr of waters              : (          0) 
 Nr of metals              : (          0) 
 Nr of inorganics          : (          0) 
 Nr of carbohydrates       : (          0) 
 Nr of organic compounds   : (          0) 
 Nr of other compounds     : (          0) 

 Checking for missing/extra atoms ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** VRML COMMANDS

 From version 2.0 on, MOLEMAN2 can produce VRML files of your
   molecule (VRML = Virtual Reality Modelling Language).  Rather than
   writing a dedicated set of routines to display molecules, use of
   of VRML is trivial for the programmer, and easy for the user.

 Some things you may need to know:
 - VRML files have the extension ".wrl"
 - use your favourite browser with VRML viewer plug-in to inspect
   the displays (you can launch it from inside MOLEMAN2, e.g.:
   "$ netscape test.wrl &")
 - colours can be defined by name or by RGB values (red-green-blue,
   three numbers in the range 0-1).  The VRml LIst_colours command
   will list all (> 400) predefined colour names and their RGB
   values

 The following set of commands would produce a pretty picture
  of cellobiohydrolase I (PDB ID 1CEL; try it yourself !):

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
! read PDB file
re /nfs/pdb/full/1cel.pdb
!
! reset VRML parameters
vr in
vr reset
!
! draw yellow CA trace for chain A
sel all
sel and chain a
vr tr yellow
!
! draw green CA trace for chain B
sel all
se an cha b
vr tr green
!
! draw CPK models for inhibitor, NAG, Calcium
sel all
vr rad 1.5 0.0
sel and res glc
sel or res ibz
sel or res nag
sel or res " ca"
vr cp
!
! all-atom stick model for the tryptophans
sel all
sel and res trp
vr stick
!
! magenta ball-and-stick for the active site residues
vr reset
sel all
vr rad 0.0 0.3
sel num and res 212 212
sel num or res 214 214
sel num or res 217 217
vr ball 0.2 magenta
!
! draw the unit cell
vr cell purple
!
! close the file
vr close
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 The VRML interface was written for two purposes:
 - quick inspection of a structure without the need to fire up a
   separate graphics program
 - creating VRML files which you can include in your web pages (in
   this case, don't forget to compress the files with the "gzip"
   command to reduce their size !)

 You will want to use the SElect commands to tailor your VRML
   files (see the example above).  Experiment !

 $$ <A HREF="http://xray.bmc.uu.se/cgi-bin/gerard/image_page.pl?image=usf/pics/mole2vrml.jpg">
 $$ Example of a VRML display (of 1PMP) generated with MOLEMAN2</A>.

 ## VRml SEtup - define some parameters

 With this command you can define the following parameters:

 - the central atom type for the VRml TRace option (" CA " for proteins)
 - the maximum allowed distance between two subsequent central
   atoms for them to be connected on the display (4.5 \A is a
   reasonable cut-off for CA-CA distances in proteins)
 - the background colour (default is black)
 - the default colour for molecules (default is yellow)

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr set
 Central atom type ? ( CA) 
 Central atom type : ( CA) 
 Max central atom distance ? (  4.50) 
 Max central atom distance : (   4.500) 
 Background colour ? (0.000 0.000 0.000) black
 Background colour : (0.000 0.000 0.000) 
 Default colour ? (1.000 1.000 0.000) white
 Default colour : (1.000 1.000 1.000) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml CLose - close the current VRML file

 The current VRML file is not closed until you open a new VRML
   file, or use this command. It may be necessary to close the
   file so that the output buffer is flushed properly and your
   VRML browser can read the file.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr close
 Command > (vr close) 
 Closed VRML file
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml INit - open a new VRML file

 This command opens a new VRML file (default: same file name as
   before if the file name is not provided).  To actually write
   molecules to it, use the VRml TRace etc. commands

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr in
 Open VRML file : (moleman2.wrl) 
 Opened VRML file
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml LIst_colours - list predefined colour names

 To help you find colours, more than 400 colour names have been
   predefined.  This command will list their names and their
   RGB values.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 LSQMAN > vr li
 Nr of colours : (        411) 
 #   1 (black                ) =     12595212 RGB    0.000   0.000   0.000
 #   2 (red                  ) =     12596212 RGB    1.000   0.000   0.000
 #   3 (green                ) =     13619212 RGB    0.000   1.000   0.000
 #   4 (blue                 ) =   1061171212 RGB    0.000   0.000   1.000
 #   5 (yellow               ) =     13620212 RGB    1.000   1.000   0.000
 #   6 (magenta              ) =   1061172212 RGB    1.000   0.000   1.000
 #   7 (cyan                 ) =   1062195212 RGB    0.000   1.000   1.000
 #   8 (light_grey           ) =    852276012 RGB    0.800   0.800   0.800
 #   9 (grey                 ) =    537395712 RGB    0.500   0.500   0.500
 #  10 (dark_grey            ) =    222515412 RGB    0.200   0.200   0.200
 #  11 (white                ) =   1062196212 RGB    1.000   1.000   1.000
 #  12 (gainsboro            ) =    917351274 RGB    0.862   0.862   0.862
 #  13 (honeydew             ) =   1000330169 RGB    0.941   1.000   0.941
 #  14 (mistyrose            ) =    938355700 RGB    1.000   0.894   0.882
 ...
 # 407 (dodgerblue2          ) =    991454330 RGB    0.110   0.525   0.933
 # 408 (lightsteelblue3      ) =    855328391 RGB    0.635   0.709   0.803
 # 409 (green3               ) =     13417484 RGB    0.000   0.803   0.000
 # 410 (orangered4           ) =     12745261 RGB    0.545   0.146   0.000
 # 411 (mediumorchid1        ) =   1061582714 RGB    0.878   0.401   1.000
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml REset_colours_radii - reset colours and radii for all atoms

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr re
 Resetting atom colours and radii ...
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml RAdii - change radii of selected atoms

 Prior to generating a CPK model you will want to increase the
   standard (covalent bond) radii, e.g. by a factor of 2.  Prior
   to generating a ball-and-stick model you will want to set them
   to e.g. 0.5 times their normal value, or set all radii e.g. to 0.3 \A.
  
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr rad
 Multiply radii by ? (1.0) 0
 Increase radii by ? (0.0) 0.4
 Nr of radii changed : (       7038) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml COlour_selection - change colour of selected atoms

 Use this, e.g. to colour a whole chain green before using the VRml
   TRace command.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml CRamp_selection - colour-ramp selected atoms

 how    = REsi_nr | BFactor | OCcupancy | MAss |
          ELement | RAdius | ATom_nr | X | Y | Z

 With this command you can colour-ramp the currently selected atoms
   by various atomic properties. (Note: ATom_nr is the number of
   each atom in the PDB file, ELement is the number of the chemical.)
   Hint: if an external program can put other numbers in the B-factor
   field of your PDB file (e.g., charge, distance from a certain
   point, or whatever), you can then ramp on that property by
   selecting BFactors here.

 At present, ramping goes from blue for low values, to red for
   high values. Note that the ramping is carried out for all
   selected atoms, so if you want a colour-ramped CA trace from
   blue to red, you will have to deselect all your hetero-compounds,
   waters, etc., and then ramp on residue number.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr cr bfact 
 Colour-ramping by B-factor ...
 Nr of atoms selected : (       2553) 
 Lowest  value found : (  3.430E+00) 
 Highest value found : (  6.726E+01) 
 Ramping done
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml TRace - generate central-atom trace of the selected atoms

 Generate a trace, e.g. of the CA atoms. This is always monochrome !

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr tr purple
 VRML Trace ...
 Nr of central atoms written : (        434) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml FAt_trace - generate fat trace of the selected central atoms

 Generate a fat (turd-like) trace, e.g. of the CA or P atoms.  You
   must supply the fatness (e.g., 0.3-1.0 \A), and may specify the colour.
   If you don't specify a colour, the atoms will be drawn in their
   current individual colours.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr fa 0.5 purple
 VRML Fat trace ...
 Nr of central atoms written : (        434) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml CPk - generate fixed-radius CPK model of the selected atoms

 If you don't specify the colour, the current colour of each atom
   will be used. You have to supply the radius for all atoms.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr cpk 1.2
 VRML CPK ...
 Nr of atoms written : (       2553) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml SPhere - generate CPK model of the selected atoms

 If you don't specify the colour, the current colour of each atom
   will be used. The current individual atomic radii will be used.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr sphe
 VRML Sphere ...
 Atoms without bonds : (        252) 
 Terminal atoms      : (        709) 
 Nr of atoms : (       2553) 
 Nr of bonds : (       2381) 
 CPU total/user/sys :       1.9       1.9       0.0
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml BAll_cylinder - generate ball-and-stick model of the selected atoms

 If you don't specify a colour, the atoms will be drawn in their
   current individual colours. The current individual atomic radii
   will be used.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr ball
 Stick radius (A) ? (0.2) 
 VRML Ball-and-stick ...
 Nr of atoms written : (        252) 
 Nr of bonds written : (        270) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml LIquorice - generate (fixed-radius) ball-and-stick model of the selected atoms

 Supply the radius that will be used for both the spheres and the
   cylinders to give that yummy liquorice look.
   If you don't specify a colour, the atoms will be drawn in their
   current individual colours.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr ball
 Stick radius (A) ? (0.2) 
 VRML Ball-and-stick ...
 Nr of atoms written : (        252) 
 Nr of bonds written : (        270) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml STick - generate stick (wire) model of the selected atoms

 A stick model consists of lines rather than cylinders, which makes
   for fast manipulation in your VRML browser.
   If you don't specify a colour, the atoms will be drawn in their
   current individual colours.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr st
 VRML Stick ...
 Nr of atoms written : (        252) 
 Nr of bonds written : (        270) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml CYlinder - generate stick (cylinder) model of the selected atoms

 If you don't specify a colour, the atoms will be drawn in their
   current individual colours.

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr st
 VRML Stick ...
 Nr of atoms written : (        252) 
 Nr of bonds written : (        270) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ## VRml CEll - draw the unit cell

 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----
 MOLEMAN2 > vr cel purple
 VRML Cell : (  84.000   86.200  111.800   90.000   90.000   90.000) 
 ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE ----- EXAMPLE -----

 ** KNOWN BUGS

 None, at present ("peppar, peppar").
